<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>BioCro: /home/dlebauer/dev/biocro/src/Century.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_century_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Century.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;R.h&gt;</code><br/>
<code>#include &lt;Rinternals.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="">Century.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">AuxBioCro.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for Century.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="_century_8c__incl.png" border="0" usemap="#_2home_2dlebauer_2dev_2biocro_2src_2_century_8c" alt=""/></div>
<map name="_2home_2dlebauer_2dev_2biocro_2src_2_century_8c" id="_2home_2dlebauer_2dev_2biocro_2src_2_century_8c">
<area shape="rect" id="node4" href="_century_8h.html" title="Century.h" alt="" coords="189,96,267,123"/><area shape="rect" id="node5" href="_aux_bio_cro_8h.html" title="AuxBioCro.h" alt="" coords="292,96,388,123"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac293be42b4dbf8057efeeb766eb17c03"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcen_t__str.html">cenT_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_century_8c.html#ac293be42b4dbf8057efeeb766eb17c03">Century</a> (double *LeafL, double *StemL, double *RootL, double *RhizL, double smoist, double stemp, int timestep, double SCs[9], double leachWater, double Nfert, double iMinN, double precip, double LeafL_Ln, double StemL_Ln, double RootL_Ln, double RhizL_Ln, double LeafL_N, double StemL_N, double RootL_N, double RhizL_N, int soilType, double Ks_cf[8])</td></tr>
<tr class="separator:ac293be42b4dbf8057efeeb766eb17c03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1f878344b2d2444f096bd0da2cb9f24"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_f_l__str.html">FL_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_century_8c.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a> (double Lig, double Nit)</td></tr>
<tr class="separator:ab1f878344b2d2444f096bd0da2cb9f24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f6a4f8b6e407fdca09efcebc32bf86c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structflow__str.html">flow_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a> (double *SC, double CNratio, double A, double Lc, double Tm, double <a class="el" href="_bio_cro_8h.html#aeb35169469ef33705592a28743d105bf">resp</a>, int kno, double Ks[8])</td></tr>
<tr class="separator:a3f6a4f8b6e407fdca09efcebc32bf86c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1061dc2ec428954d1e4fd2abd8e17957"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_century_8c.html#a1061dc2ec428954d1e4fd2abd8e17957">AbiotEff</a> (double smoist, double stemp)</td></tr>
<tr class="separator:a1061dc2ec428954d1e4fd2abd8e17957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0e2763f9ba53b2559fe35fae340b809"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_century_8c.html#ab0e2763f9ba53b2559fe35fae340b809">cntry</a> (SEXP LEAFL, SEXP STEML, SEXP ROOTL, SEXP RHIZL, SEXP SMOIST, SEXP STEMP, SEXP TIMESTEP, SEXP SCS, SEXP LEACHWATER, SEXP NFERT, SEXP IMINN, SEXP PRECIP, SEXP LEAFLLN, SEXP STEMLLN, SEXP ROOTLLN, SEXP RHIZLLN, SEXP LEAFLN, SEXP STEMLN, SEXP ROOTLN, SEXP RHIZLN, SEXP SOILTYPE, SEXP KS)</td></tr>
<tr class="separator:ab0e2763f9ba53b2559fe35fae340b809"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a1061dc2ec428954d1e4fd2abd8e17957"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double AbiotEff </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>smoist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stemp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                                            {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordtype">double</span> ans;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keywordtype">double</span> TempEff = 0.0, MoisEff;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">if</span>(stemp &lt; 35){</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    TempEff = 1.0087 / (1 + (46.2 * exp(-0.1899 * stemp)));</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    TempEff = -0.0826 * stemp + 3.84;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  MoisEff = 1.0267 / (1 + 14.7 * exp(-6.5 * smoist));</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  ans = TempEff * MoisEff;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordflow">return</span>(ans);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac293be42b4dbf8057efeeb766eb17c03"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcen_t__str.html">cenT_str</a> Century </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>LeafL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>StemL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>RootL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>RhizL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>smoist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SCs</em>[9], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leachWater</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Nfert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>iMinN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LeafL_Ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StemL_Ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RootL_Ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RhizL_Ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LeafL_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StemL_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RootL_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RhizL_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soilType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ks_cf</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                        {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">/* Converting Mg ha^-1 to g m^-2 */</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">/* 1 Mg = 1e6 grams*/</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">/* 1 ha = 1e4 m^2 */</span>  </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 100;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  *LeafL *= cf; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  *StemL *= cf;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  *RootL *= cf;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  *RhizL *= cf;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcen_t__str.html">cenT_str</a> tmp;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> soilTemp;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_f_l__str.html">FL_str</a> FmLc_Leaf, FmLc_Stem, FmLc_Root, FmLc_Rhiz;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C1_5_Leaf, C2_5_Leaf, C1_5_Stem, C2_5_Stem;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C1_7_Leaf_Ln, C1_7_Stem_Ln;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C3_6_Root, C4_6_Root, C3_6_Rhiz, C4_6_Rhiz;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C3_7_Root_Ln, C3_7_Rhiz_Ln;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C5_7, C6, C7, C8_6;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">double</span> C6_7, C6_8, C6_9, C7_6, C7_8;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">double</span> C_ap, C_al, C_sp; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordtype">double</span> SC1_Leaf, SC2_Leaf, SC1_Stem, SC2_Stem;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">double</span> SC3_Root, SC4_Root, SC3_Rhiz, SC4_Rhiz;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">/*  </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">    I need the separate fractions of Leaf Litter and Stem Litter </span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">  Because they have different lignin to N ratios </span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">  Presumably, the rhizome and root are similar </span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">  There is an issue here that I should be careful about I&#39;m importing </span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">  biomass, but need only carbon in some of these calculations </span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">  I also need to determine the initial values of carbon for each </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">  component </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  soilTemp = <a class="code" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a>(soilType);  </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">double</span> T = soilTemp.clay + soilTemp.silt; <span class="comment">/*  silt plus clay content of the soil */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">double</span> Ts = soilTemp.sand; <span class="comment">/*  Sand content of the soil */</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">double</span> Tc = soilTemp.clay; <span class="comment">/*  Clay content of the soil */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">double</span> CN_structural = 150;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">double</span> CN_surface;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordtype">double</span> CN_active ;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">double</span> CN_slow ;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">double</span> CN_passive ;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">double</span> SN1, SN2, SN3, SN4, SN5, SN6, SN7, SN8, SN9;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">double</span> SC1, SC2, SC3, SC4, SC5, SC6, SC7, SC8, SC9;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">double</span> Abiot;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">double</span> Na = 0.0, Nf = 0.0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">double</span> PlantN;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordtype">double</span> SC1_Leaf_Ln, SC1_Stem_Ln;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">double</span> SC3_Root_Ln, SC3_Rhiz_Ln;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">/* Converting from Mg ha^-1 to g m^-2 */</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  SC1 = SCs[0] * cf;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  SC2 = SCs[1] * cf;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  SC3 = SCs[2] * cf;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  SC4 = SCs[3] * cf;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  SC5 = SCs[4] * cf;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  SC6 = SCs[5] * cf;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  SC7 = SCs[6] * cf;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  SC8 = SCs[7] * cf;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  SC9 = SCs[8] * cf;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">MinN</a> = 0.0, <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> = 0.0;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC1_5 = 0.6;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC1_7 = 0.3;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC3_7 = 0.3;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC2_5 = 0.6;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC3_6 = 0.55;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC4_6 = 0.55;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC5_7 = 0.6;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC6 = 0.85 - 0.68 * T;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC7 = 0.55;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC8 = 0.55;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">double</span> Ks[8];</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">/*  Tm is the effect of soil texture on active SOM turnover */</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">double</span> Tm = 1 - 0.75 * T;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">/*    The flow constants are taken from the paper </span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">      and Parton et al. 1993 Global Biogeochemistry pg 785 </span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">      but </span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">      Parton et al. 1987 SSSJ 51:1173 </span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">      is also relevant</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">      double Ksy[ ] = { 3.9, 4.9, 7.3, 6.0, 14.8, 18.5, 0.2, 0.0045 };     The units are year^-1  </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">      To get the rates per week we can divide by 52</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">      To get the rates poer day we can divide by 365</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">/* It seems that the rates are the ones reported in Parton et al. 1993 Global Biogeochemical Cycles */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">/* These are annual rates and to convert to other time steps the model should be run accordingly */</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">/* Rprintf(&quot;Ks[3] : %f Ks[4] : %f \n&quot;,Ks[3],Ks[4]); */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">/* Rprintf(&quot;Ks[5] : %f Ks[6] : %f \n&quot;,Ks[5],Ks[6]); */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;     <span class="keywordflow">if</span>(timestep == 7){</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;       Ks[0] = Ks_cf[0] / 52 ;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;       Ks[1] = Ks_cf[1] / 52 ;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;       Ks[2] = Ks_cf[2] / 52 ;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;       Ks[3] = Ks_cf[3] / 52 ;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;       Ks[4] = Ks_cf[4] / 52 ;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;       Ks[5] = Ks_cf[5] / 52 ;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;       Ks[6] = Ks_cf[6] / 52 ;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;       Ks[7] = Ks_cf[7] / 52 ;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;     }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;     <span class="keywordflow">if</span>(timestep == 1){   </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;       Ks[0] = Ks_cf[0] / 365 ; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;       Ks[1] = Ks_cf[1] / 365 ; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;       Ks[2] = Ks_cf[2] / 365 ; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;       Ks[3] = Ks_cf[3] / 365 ; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;       Ks[4] = Ks_cf[4] / 365 ; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;       Ks[5] = Ks_cf[5] / 365 ; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;       Ks[6] = Ks_cf[6] / 365 ; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;       Ks[7] = Ks_cf[7] / 365 ;  </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;     } </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">/* Nitrogen processes </span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">    N deposition */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  Na = 0.21 + 0.0028 * precip * 0.10 ;  <span class="comment">/*precipitation is entered in mm</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">                                          but it is needed in cm for this</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">                                           equation. Idem below */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">/*  N fixation */</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  Nf = -0.18 + 0.014 * precip * 0.10 ; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">/* The resulting N is in g N m^-2 yr^-1 </span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">   Conversions</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">   g =&gt; Mg : multiply by 1e-6</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">   m^2 =&gt; ha : multiply by 1e4</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">   year to week : divide by 52 */</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">if</span>(timestep == 7){</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;     Na /=  52;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;     Nf /=  52;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span>(timestep == 1){</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;     Na /=  365;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;     Nf /=  365;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">/*   Rprintf(&quot;Na : %f \n&quot;,Na); */</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">/*   Rprintf(&quot;Nf : %f \n&quot;,Nf); */</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">/*   Nitrogen in the form of fertilizer */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">/*   The input units should be in g N m^2 */</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">/*   Rprintf(&quot;Nfert : %f iMinN : %f \n&quot;,Nfert,iMinN); */</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  MinN = Na + Nf + Nfert + iMinN;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">/*   Rprintf(&quot;MinN 0: %f \n&quot;,MinN); */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  PlantN = *LeafL * LeafL_N + *StemL * StemL_N;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  CN_surface = 20 - PlantN * 5;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  CN_active = 15 - MinN * 6;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  CN_slow = 20 - MinN * 4;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  CN_passive = 10 - MinN * 1.5;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">if</span>(PlantN &gt; 2) CN_surface = 10;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">/*   Here 2 is g m^-2 */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">if</span>(MinN &gt; 2){</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    CN_active = 3;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    CN_passive = 7;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    CN_slow = 12;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  SN1 = SC1 / CN_structural; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  SN2 = SC2 / CN_active;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  SN3 = SC3 / CN_structural;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  SN4 = SC4 / CN_active;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  SN5 = SC5 / CN_active;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  SN6 = SC6 / CN_active;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  SN7 = SC7 / CN_slow;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  SN8 = SC8 / CN_passive;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  SN9 = SC9 / CN_passive;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">/*  Need to calculate the effect of temperature and moisture. */</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  Abiot = <a class="code" href="_century_8c.html#a1061dc2ec428954d1e4fd2abd8e17957">AbiotEff</a>(smoist, stemp);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">/*    Calculate Fm and Lc separately for each component */</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  FmLc_Leaf = <a class="code" href="_century_8c.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a>(LeafL_Ln,LeafL_N);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  FmLc_Stem = <a class="code" href="_century_8c.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a>(StemL_Ln,StemL_N);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  FmLc_Root = <a class="code" href="_century_8c.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a>(RootL_Ln,RootL_N);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  FmLc_Rhiz = <a class="code" href="_century_8c.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a>(RhizL_Ln,RhizL_N);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">/*  Surface Metabolic Carbon */</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  SC2_Leaf = FmLc_Leaf.Fm * *LeafL;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  SC2_Stem = FmLc_Stem.Fm * *StemL;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">/*  Root Metabolic Carbon */</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  SC4_Root = FmLc_Root.Fm * *RootL;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  SC4_Rhiz = FmLc_Rhiz.Fm * *RhizL;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">/*  Surface Structural Carbon */</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  SC1_Leaf = (1 - FmLc_Leaf.Fm) * *LeafL;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  SC1_Stem = (1 - FmLc_Stem.Fm) * *StemL;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">/* Lignin content needs to be considered separately */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  SC1_Leaf_Ln = SC1_Leaf * LeafL_Ln;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  SC1_Stem_Ln = SC1_Stem * StemL_Ln;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  SC1_Leaf = SC1_Leaf - SC1_Leaf_Ln;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  SC1_Stem = SC1_Stem - SC1_Stem_Ln;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">/*  Root Structural Carbon */</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  SC3_Root = (1 - FmLc_Root.Fm) * *RootL;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  SC3_Rhiz = (1 - FmLc_Rhiz.Fm) * *RhizL;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">/* Lignin content needs to be considered separately */</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  SC3_Root_Ln = SC3_Root * RootL_Ln;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  SC3_Rhiz_Ln = SC3_Rhiz * RhizL_Ln;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  SC3_Root = SC3_Root - SC3_Root_Ln;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  SC3_Rhiz = SC3_Rhiz - SC3_Rhiz_Ln;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">/*    T is silt plus clay content </span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">    Ls is fraction of structural C that is lignin </span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">    Structural Surface Litter C to Surface Microbe C </span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">    1 =&gt; 5 </span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">    2 =&gt; 5 </span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">    dC1/dt = Ki * Lc * A * Ci </span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">    Leaf */</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  SC1_Leaf +=  0.3 * SC1;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  SC2_Leaf +=  0.3 * SC2;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  C1_5_Leaf = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC1_Leaf,CN_surface,Abiot,FmLc_Leaf.Lc,Tm,respC1_5,1,Ks);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  C2_5_Leaf = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC2_Leaf,CN_surface,Abiot,FmLc_Leaf.Lc,Tm,respC1_5,5,Ks);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">/*  Stem */</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  SC1_Stem = SC1_Stem + 0.7 * SC1;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  SC2_Stem = SC2_Stem + 0.7 * SC2;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  C1_5_Stem = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC1_Stem,CN_surface,Abiot,FmLc_Stem.Lc,Tm,respC2_5,1,Ks);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  C2_5_Stem = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC2_Stem,CN_surface,Abiot,FmLc_Stem.Lc,Tm,respC2_5,5,Ks);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  SC1_Leaf = C1_5_Leaf.SC;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  SC2_Leaf = C2_5_Leaf.SC;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  SC1_Stem = C1_5_Stem.SC;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  SC2_Stem = C2_5_Stem.SC;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; <span class="comment">/*   Adding the ligning content */</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  C1_7_Leaf_Ln = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC1_Leaf_Ln,CN_surface,Abiot,FmLc_Leaf.Lc,Tm,respC1_7,1,Ks);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  C1_7_Stem_Ln = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC1_Stem_Ln,CN_surface,Abiot,FmLc_Stem.Lc,Tm,respC1_7,1,Ks);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">/* Flow from SC1.lignin to SC7 */</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  SC7 += C1_7_Leaf_Ln.fC + C1_7_Stem_Ln.fC ;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">/*  Collect respiration */</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> = C1_5_Leaf.Resp + C2_5_Leaf.Resp +</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;         C1_5_Stem.Resp + C2_5_Stem.Resp +</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;         C1_7_Leaf_Ln.Resp + C1_7_Stem_Ln.Resp;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="comment">/*  Collect mineralized Nitrogen */</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  MinN += C1_5_Leaf.MinN + C2_5_Leaf.MinN +</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          C1_5_Stem.MinN + C2_5_Stem.MinN +</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;          C1_7_Leaf_Ln.MinN + C1_7_Stem_Ln.MinN;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">/*   Rprintf(&quot;MinN 1: %f \n&quot;,MinN); */</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">/*  Updating the Soil Carbon Pools 1 and 2  */</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  SC1 = C1_5_Leaf.SC + C1_5_Stem.SC + C1_7_Leaf_Ln.SC + C1_7_Stem_Ln.SC ;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  SC2 = C2_5_Leaf.SC + C2_5_Stem.SC ;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">/*  Updating the Nitrogen Carbon Pools 1 and 2 */</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  SN1 = SC1 / CN_structural + SN1;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  SN2 = SC2 / CN_surface + SN2;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">/*    Structural Root Litter C to Soil Microbe C */</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">/*    4 =&gt; 6 */</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">/*    3 =&gt; 6 */</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">/*    Root */</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  SC3_Root = SC3_Root + 0.3 * SC3;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  SC4_Root = SC4_Root + 0.3 * SC4;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  C3_6_Root = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC3_Root,CN_active,Abiot,FmLc_Root.Lc,Tm,respC3_6,2,Ks);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  C4_6_Root = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC4_Root,CN_active,Abiot,FmLc_Root.Lc,Tm,respC3_6,6,Ks);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">/*    Rhizome */</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  SC3_Rhiz = SC3_Rhiz + 0.7 * SC3;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  SC4_Rhiz = SC4_Rhiz + 0.7 * SC4;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  C3_6_Rhiz = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC3_Rhiz,CN_active,Abiot,FmLc_Rhiz.Lc,Tm,respC4_6,2,Ks);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  C4_6_Rhiz = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC4_Rhiz,CN_active,Abiot,FmLc_Rhiz.Lc,Tm,respC4_6,6,Ks);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  SC3_Root = C3_6_Root.SC;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  SC4_Root = C4_6_Root.SC;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  SC3_Rhiz = C3_6_Rhiz.SC;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  SC4_Rhiz = C4_6_Rhiz.SC;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  C3_7_Root_Ln = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC3_Root_Ln,CN_slow,Abiot,FmLc_Root.Lc,Tm,respC3_7,2,Ks);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  C3_7_Rhiz_Ln = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC3_Rhiz_Ln,CN_slow,Abiot,FmLc_Rhiz.Lc,Tm,respC3_7,2,Ks);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  SC7 += C3_7_Root_Ln.fC + C3_7_Rhiz_Ln.fC ; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; <span class="comment">/*   Collect respiration */</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> += C3_6_Root.Resp + C4_6_Root.Resp +</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;           C3_6_Rhiz.Resp + C4_6_Rhiz.Resp;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">/*    Collect mineralized Nitrogen */</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  MinN += C3_6_Root.MinN + C4_6_Root.MinN +</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;           C3_6_Rhiz.MinN + C4_6_Rhiz.MinN + </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;           C3_7_Root_Ln.MinN + C3_7_Rhiz_Ln.MinN;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">/*   Rprintf(&quot;MinN 2: %f \n&quot;,MinN); */</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">/*   Updating the Soil Carbon Pools 3 and 4 */</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  SC3 = C3_6_Root.SC + C3_6_Rhiz.SC + C3_7_Root_Ln.SC + C3_7_Rhiz_Ln.SC;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  SC4 = C4_6_Root.SC + C4_6_Rhiz.SC ;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">/*   Updating the Nitrogen pools 3 and 4 */</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  SN3 += SC3 / CN_structural ;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  SN4 += SC4 / CN_active ;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">/*    Updating the Soil Carbon Pool 5 */</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  SC5 += C1_5_Leaf.fC + C1_5_Stem.fC + C2_5_Leaf.fC + C2_5_Stem.fC ;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">/*    Updating the Soil Nitrogen pool 5 */</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  SN5 += SC5 / CN_surface ;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">/*    Updating the Soil Carbon Pool 6 */</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  SC6 += C3_6_Root.fC + C3_6_Rhiz.fC + C4_6_Root.fC + C4_6_Rhiz.fC ;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">/*    Updating the Soil Nitrogen Pool 6 */</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  SN6 += SC6 / CN_active ;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">/*    Surface Microbe C to Slow C */</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">/*    5 =&gt; 7 */</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  C5_7 = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC5,CN_slow,Abiot,0,0,respC5_7,4,Ks);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> +=  C5_7.Resp;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  MinN +=  C5_7.MinN;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">/*    Updating Surface Microbe C (pool 5) and slow (pool 7) */</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  SC5 = C5_7.SC ;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  SC7 += C5_7.fC ;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">/*    Updating Surface Microbe N pool */</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  SN5 = SC5 / CN_surface;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">/*   Soil Microbe C to intermediate stage C */</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  C6 = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC6,CN_slow,Abiot,0,Tm,respC6,3,Ks);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">/*   if(ISNAN(C6.fC) | ISNAN(C6.SC)){ */</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">/*     Rprintf(&quot;C6.fC %f and C6.SC %f and SC6 %f \n&quot;,C6.fC,C6.SC,SC6); */</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">/*   } */</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> +=  C6.Resp;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  MinN +=  C6.MinN;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">/*    Updating carbon and nitrogen soil pools 6 */</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  SC6 = C6.SC;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  SN6 = SC6 / CN_active;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  C_ap = 0.003 + 0.032 * Tc;   </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  C_al = leachWater / 18.0 * (0.01 + 0.04 * Ts);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">/*   Rprintf(&quot;C_al %f and C_ap %f Tc %f \n&quot;,C_al, C_ap, Tc); */</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">/*   Rprintf(&quot;leachWater %f and Ts %f \n&quot;,leachWater, Ts); */</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  C6_8 = C6.fC * C_ap;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  C6_9 = C6.fC * C_al;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  C6_7 = C6.fC * (1 - C_ap - C_al); <span class="comment">/* There is no need to subtract 0.55 since </span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">                                       this was already taken into account in </span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">                                       the flow equation */</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; <span class="comment">/*   Updating the Soil Carbon Pool 7, 8 and 9 */</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  SC7 += C6_7 ;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  SC8 += C6_8 ;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  SC9 += C6_9 ;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">/*   Rprintf(&quot;C6_9 %f \n&quot;,C6_9); */</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">/*  Updating the Soil Nitrogen Pool 7, 8 and 9 */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  SN7 += SC7 / CN_slow ;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  SN8 += SC8 / CN_passive ;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  SN9 += SC9 / CN_slow ;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">/*    Slow Carbon to intermediate stage */</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  C7 = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC7,CN_slow,Abiot,0,0,respC7,7,Ks);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> += C7.Resp;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  MinN += C7.MinN;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  C_sp = 0.003 - 0.009 *Tc;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  C7_8 = C7.fC * C_sp;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  C7_6 = C7.fC * (1 - C_sp);  <span class="comment">/* There is no need to subtract 0.55 since </span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">                                 this was already taken into account in </span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">                                 the flow equation */</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">/*    Updating the Soil Carbon Pools 6 and 8 */</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  SC6 += C7_6 ;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  SC8 += C7_8 ;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">/*    Updating the Soil Nitrogen Pools 6 and 8 */</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  SN6 = SC6 / CN_active;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  SN8 = SN8 / CN_passive;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">/*    Passive Carbon to Soil Microbe C */</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  C8_6 = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC8,CN_passive,Abiot,0,0,respC8,8,Ks);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> += C8_6.Resp;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  MinN += C8_6.MinN;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">/*   Updating the Soil Microbe C 6 and 8 */</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  SC8 = C8_6.SC ;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  SC6 += C8_6.fC ;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  SN6 = SC6 / CN_active;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  SN8 = SC8 / CN_passive;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  tmp.SNs[0] = SN1 / cf;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  tmp.SNs[1] = SN2 / cf ;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  tmp.SNs[2] = SN3 / cf ;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  tmp.SNs[3] = SN4 / cf ;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  tmp.SNs[4] = SN5 / cf ;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  tmp.SNs[5] = SN6 / cf ;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  tmp.SNs[6] = SN7 / cf ;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  tmp.SNs[7] = SN8 / cf ;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  tmp.SNs[8] = SN9 / cf ;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  tmp.SCs[0] = SC1 / cf;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  tmp.SCs[1] = SC2 / cf;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  tmp.SCs[2] = SC3 / cf;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  tmp.SCs[3] = SC4 / cf;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  tmp.SCs[4] = SC5 / cf;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  tmp.SCs[5] = SC6 / cf;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  tmp.SCs[6] = SC7 / cf;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  tmp.SCs[7] = SC8 / cf;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  tmp.SCs[8] = SC9 / cf;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  tmp.MinN = <a class="code" href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">MinN</a>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  tmp.Resp = <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">/* Converting Leaf Litter to its original units */</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  *LeafL /= cf;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  *StemL /= cf;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  *RootL /= cf;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  *RhizL /= cf;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">return</span>(tmp);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;}</div>
<div class="ttc" id="_century_8c_html_a3f6a4f8b6e407fdca09efcebc32bf86c"><div class="ttname"><a href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a></div><div class="ttdeci">struct flow_str flow(double *SC, double CNratio, double A, double Lc, double Tm, double resp, int kno, double Ks[8])</div><div class="ttdef"><b>Definition:</b> Century.c:523</div></div>
<div class="ttc" id="_century_8c_html_ab1f878344b2d2444f096bd0da2cb9f24"><div class="ttname"><a href="_century_8c.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a></div><div class="ttdeci">struct FL_str FmLcFun(double Lig, double Nit)</div><div class="ttdef"><b>Definition:</b> Century.c:496</div></div>
<div class="ttc" id="structflow__str_html_a92c1005f482e0f18892a6a94e72e4035"><div class="ttname"><a href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">flow_str::Resp</a></div><div class="ttdeci">double Resp</div><div class="ttdef"><b>Definition:</b> Century.h:26</div></div>
<div class="ttc" id="structsoil_text__str_html"><div class="ttname"><a href="structsoil_text__str.html">soilText_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:95</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a72f93049960e067cda6e7291ff1ff21a"><div class="ttname"><a href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a></div><div class="ttdeci">struct soilText_str soilTchoose(int soiltype)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1166</div></div>
<div class="ttc" id="_century_8c_html_a1061dc2ec428954d1e4fd2abd8e17957"><div class="ttname"><a href="_century_8c.html#a1061dc2ec428954d1e4fd2abd8e17957">AbiotEff</a></div><div class="ttdeci">double AbiotEff(double smoist, double stemp)</div><div class="ttdef"><b>Definition:</b> Century.c:570</div></div>
<div class="ttc" id="structcen_t__str_html"><div class="ttname"><a href="structcen_t__str.html">cenT_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:6</div></div>
<div class="ttc" id="structflow__str_html"><div class="ttname"><a href="structflow__str.html">flow_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:22</div></div>
<div class="ttc" id="structflow__str_html_a2e85af08e1b5ef823f43b8fea56f85d7"><div class="ttname"><a href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">flow_str::MinN</a></div><div class="ttdeci">double MinN</div><div class="ttdef"><b>Definition:</b> Century.h:27</div></div>
<div class="ttc" id="struct_f_l__str_html"><div class="ttname"><a href="struct_f_l__str.html">FL_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:15</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab0e2763f9ba53b2559fe35fae340b809"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP cntry </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LEAFL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>STEML</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ROOTL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RHIZL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SMOIST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>STEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TIMESTEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SCS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LEACHWATER</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NFERT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>IMINN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>PRECIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LEAFLLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>STEMLLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ROOTLLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RHIZLLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LEAFLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>STEMLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ROOTLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RHIZLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILTYPE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                   {          <span class="comment">/* 22 */</span> </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcen_t__str.html">cenT_str</a> tmp;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordtype">double</span> LeafL = REAL(LEAFL)[0];</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keywordtype">double</span> StemL = REAL(STEML)[0];</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keywordtype">double</span> RootL = REAL(ROOTL)[0];</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordtype">double</span> RhizL = REAL(RHIZL)[0];</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  SEXP lists, names;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  SEXP <a class="code" href="structcen_t__str.html#a7e30f5d3db953fdb4af77450b365c901">SCs</a>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  SEXP <a class="code" href="structcen_t__str.html#a10e0d8f20306e4c162e171ea649c8337">SNs</a>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  SEXP <a class="code" href="structcen_t__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">MinN</a>, <a class="code" href="structcen_t__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  PROTECT(lists = allocVector(VECSXP,4));</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  PROTECT(names = allocVector(STRSXP,4));</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  PROTECT(SCs = allocVector(REALSXP,9));</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  PROTECT(SNs = allocVector(REALSXP,9));</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  PROTECT(MinN = allocVector(REALSXP,1));</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  PROTECT(Resp = allocVector(REALSXP,1));</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  tmp = <a class="code" href="_century_8c.html#ac293be42b4dbf8057efeeb766eb17c03">Century</a>(&amp;LeafL, </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                &amp;StemL, </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                &amp;RootL, </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                &amp;RhizL,</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                REAL(SMOIST)[0], </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                REAL(STEMP)[0], </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                INTEGER(TIMESTEP)[0], </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                REAL(SCS),</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                REAL(LEACHWATER)[0], </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                REAL(NFERT)[0], </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                REAL(IMINN)[0], </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                REAL(PRECIP)[0],</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                REAL(LEAFLLN)[0], </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                REAL(STEMLLN)[0], </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                REAL(ROOTLLN)[0], </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                REAL(RHIZLLN)[0],</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                REAL(LEAFLN)[0], </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                REAL(STEMLN)[0], </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                REAL(ROOTLN)[0], </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                REAL(RHIZLN)[0], </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                INTEGER(SOILTYPE)[0], </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                REAL(KS));</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  REAL(MinN)[0] = tmp.MinN;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  REAL(Resp)[0] = tmp.Resp;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordflow">for</span>(j=0;j&lt;9;j++){</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    REAL(SCs)[j] = tmp.SCs[j];</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    REAL(SNs)[j] = tmp.SNs[j];</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  SET_VECTOR_ELT(lists,0,SCs);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  SET_VECTOR_ELT(lists,1,SNs);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  SET_VECTOR_ELT(lists,2,MinN);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  SET_VECTOR_ELT(lists,3,Resp);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  SET_STRING_ELT(names,0,mkChar(<span class="stringliteral">&quot;SCs&quot;</span>));</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  SET_STRING_ELT(names,1,mkChar(<span class="stringliteral">&quot;SNs&quot;</span>));</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  SET_STRING_ELT(names,2,mkChar(<span class="stringliteral">&quot;MinN&quot;</span>));</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  SET_STRING_ELT(names,3,mkChar(<span class="stringliteral">&quot;Resp&quot;</span>));</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  setAttrib(lists,R_NamesSymbol,names);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  UNPROTECT(6);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keywordflow">return</span>(lists);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;}</div>
<div class="ttc" id="_century_8c_html_ac293be42b4dbf8057efeeb766eb17c03"><div class="ttname"><a href="_century_8c.html#ac293be42b4dbf8057efeeb766eb17c03">Century</a></div><div class="ttdeci">struct cenT_str Century(double *LeafL, double *StemL, double *RootL, double *RhizL, double smoist, double stemp, int timestep, double SCs[9], double leachWater, double Nfert, double iMinN, double precip, double LeafL_Ln, double StemL_Ln, double RootL_Ln, double RhizL_Ln, double LeafL_N, double StemL_N, double RootL_N, double RhizL_N, int soilType, double Ks_cf[8])</div><div class="ttdef"><b>Definition:</b> Century.c:21</div></div>
<div class="ttc" id="structcen_t__str_html_a92c1005f482e0f18892a6a94e72e4035"><div class="ttname"><a href="structcen_t__str.html#a92c1005f482e0f18892a6a94e72e4035">cenT_str::Resp</a></div><div class="ttdeci">double Resp</div><div class="ttdef"><b>Definition:</b> Century.h:11</div></div>
<div class="ttc" id="structcen_t__str_html"><div class="ttname"><a href="structcen_t__str.html">cenT_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:6</div></div>
<div class="ttc" id="structcen_t__str_html_a10e0d8f20306e4c162e171ea649c8337"><div class="ttname"><a href="structcen_t__str.html#a10e0d8f20306e4c162e171ea649c8337">cenT_str::SNs</a></div><div class="ttdeci">double SNs[9]</div><div class="ttdef"><b>Definition:</b> Century.h:9</div></div>
<div class="ttc" id="structcen_t__str_html_a2e85af08e1b5ef823f43b8fea56f85d7"><div class="ttname"><a href="structcen_t__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">cenT_str::MinN</a></div><div class="ttdeci">double MinN</div><div class="ttdef"><b>Definition:</b> Century.h:10</div></div>
<div class="ttc" id="structcen_t__str_html_a7e30f5d3db953fdb4af77450b365c901"><div class="ttname"><a href="structcen_t__str.html#a7e30f5d3db953fdb4af77450b365c901">cenT_str::SCs</a></div><div class="ttdeci">double SCs[9]</div><div class="ttdef"><b>Definition:</b> Century.h:8</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3f6a4f8b6e407fdca09efcebc32bf86c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structflow__str.html">flow_str</a> <a class="el" href="structflow.html">flow</a> </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CNratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Lc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ks</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                                                                                                    {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> tmp;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordtype">double</span> Kf = 0.0, <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> = 0.0;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a>, <a class="code" href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">MinN</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">if</span>(kno &lt; 3){</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    Kf = Ks[kno-1] * Lc * A ;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> = Kf * *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">if</span>(kno == 3){</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    Kf = Ks[kno-1] * A * Tm ;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> = Kf * *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordflow">if</span>(kno &gt; 3){</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    Kf = Ks[kno-1] * A;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> = Kf * *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">if</span>(Kf &gt; 1){</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    Rprintf(<span class="stringliteral">&quot;Kf greater than 1: %d %f %f %f %f \n&quot;</span>, kno, Ks[kno-1], Kf, A, Tm);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  Resp = <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> * <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">/*  Mineralized N */</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  MinN = Resp / CNratio;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a> = *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a> - <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  fC = fC - <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a>;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">/*   fN = fC / CNratio; */</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">/*  It is important to keep track of C emissions because */</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">/*  I might need to validate it against Eddy flux data */</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  tmp.SC = *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  tmp.fC = <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  tmp.Resp = <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  tmp.MinN = <a class="code" href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">MinN</a>;  </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="keywordflow">return</span>(tmp);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;}</div>
<div class="ttc" id="structflow__str_html_a043c2ff66146ae4fa8a898c8f7a44851"><div class="ttname"><a href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">flow_str::fC</a></div><div class="ttdeci">double fC</div><div class="ttdef"><b>Definition:</b> Century.h:25</div></div>
<div class="ttc" id="structflow__str_html_a92c1005f482e0f18892a6a94e72e4035"><div class="ttname"><a href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">flow_str::Resp</a></div><div class="ttdeci">double Resp</div><div class="ttdef"><b>Definition:</b> Century.h:26</div></div>
<div class="ttc" id="structflow__str_html_a343d51cd0d68eb7f2086dcdfa86bc58d"><div class="ttname"><a href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">flow_str::SC</a></div><div class="ttdeci">double SC</div><div class="ttdef"><b>Definition:</b> Century.h:24</div></div>
<div class="ttc" id="structflow__str_html"><div class="ttname"><a href="structflow__str.html">flow_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:22</div></div>
<div class="ttc" id="structflow__str_html_a2e85af08e1b5ef823f43b8fea56f85d7"><div class="ttname"><a href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">flow_str::MinN</a></div><div class="ttdeci">double MinN</div><div class="ttdef"><b>Definition:</b> Century.h:27</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_aeb35169469ef33705592a28743d105bf"><div class="ttname"><a href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a></div><div class="ttdeci">double resp(double comp, double mrc, double temp)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1024</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab1f878344b2d2444f096bd0da2cb9f24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_f_l__str.html">FL_str</a> FmLcFun </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Lig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Nit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                             {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordtype">double</span> Fm, Ls, Lc;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_f_l__str.html">FL_str</a> tmp;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  Fm = 0.85 - 0.018 *(Lig/Nit);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  Ls = Lig / (1 - <a class="code" href="struct_f_l__str.html#af757219617ae5633c84861a6d551e50e">Fm</a>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  Lc = exp(-3 * Ls);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  tmp.Lc = <a class="code" href="struct_f_l__str.html#a50ae8acc43740fd17ffe08b69140dea7">Lc</a>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  tmp.Fm = <a class="code" href="struct_f_l__str.html#af757219617ae5633c84861a6d551e50e">Fm</a>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordflow">return</span>(tmp);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;}</div>
<div class="ttc" id="struct_f_l__str_html_af757219617ae5633c84861a6d551e50e"><div class="ttname"><a href="struct_f_l__str.html#af757219617ae5633c84861a6d551e50e">FL_str::Fm</a></div><div class="ttdeci">double Fm</div><div class="ttdef"><b>Definition:</b> Century.h:17</div></div>
<div class="ttc" id="struct_f_l__str_html_a50ae8acc43740fd17ffe08b69140dea7"><div class="ttname"><a href="struct_f_l__str.html#a50ae8acc43740fd17ffe08b69140dea7">FL_str::Lc</a></div><div class="ttdeci">double Lc</div><div class="ttdef"><b>Definition:</b> Century.h:18</div></div>
<div class="ttc" id="struct_f_l__str_html"><div class="ttname"><a href="struct_f_l__str.html">FL_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:15</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_century_8c.html">Century.c</a></li>
    <li class="footer">Generated on Fri Apr 3 2015 15:41:06 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
