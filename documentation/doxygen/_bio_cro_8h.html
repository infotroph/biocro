<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>BioCro: /home/dlebauer/dev/biocro/src/BioCro.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_bio_cro_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">BioCro.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="_bio_cro_8h__dep__incl.png" border="0" usemap="#_2home_2dlebauer_2dev_2biocro_2src_2_bio_cro_8hdep" alt=""/></div>
<map name="_2home_2dlebauer_2dev_2biocro_2src_2_bio_cro_8hdep" id="_2home_2dlebauer_2dev_2biocro_2src_2_bio_cro_8hdep">
<area shape="rect" id="node2" href="_aux_bio_cro_8c.html" title="/home/dlebauer/dev\l/biocro/src/AuxBioCro.c" alt="" coords="5,97,165,138"/><area shape="rect" id="node3" href="_aux_crop_gro_8c.html" title="/home/dlebauer/dev\l/biocro/src/AuxCropGro.c" alt="" coords="191,97,361,138"/><area shape="rect" id="node4" href="_auxwillow_gro_8c.html" title="/home/dlebauer/dev\l/biocro/src/AuxwillowGro.c" alt="" coords="385,97,564,138"/><area shape="rect" id="node5" href="_bio_cro_8c.html" title="/home/dlebauer/dev\l/biocro/src/BioCro.c" alt="" coords="588,97,727,138"/><area shape="rect" id="node6" href="cane_gro_8c.html" title="/home/dlebauer/dev\l/biocro/src/caneGro.c" alt="" coords="751,97,897,138"/><area shape="rect" id="node7" href="_crop_gro_8c.html" title="/home/dlebauer/dev\l/biocro/src/CropGro.c" alt="" coords="921,97,1068,138"/><area shape="rect" id="node8" href="dailywillow_8c.html" title="/home/dlebauer/dev\l/biocro/src/dailywillow.c" alt="" coords="1093,97,1253,138"/><area shape="rect" id="node9" href="maize_gro_8c.html" title="/home/dlebauer/dev\l/biocro/src/maizeGro.c" alt="" coords="1279,97,1432,138"/><area shape="rect" id="node10" href="willow_cent_8c.html" title="/home/dlebauer/dev\l/biocro/src/willowCent.c" alt="" coords="1457,97,1620,138"/><area shape="rect" id="node11" href="willow_gro_8c.html" title="/home/dlebauer/dev\l/biocro/src/willowGro.c" alt="" coords="1644,97,1797,138"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9e38198cf133d59230f6d1f6beac12bc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a9e38198cf133d59230f6d1f6beac12bc">RSS_BG</a> (double oStem[], double oLeaf[], double oRhizome[], double oRoot[], double oGrain[], double oLAI[], double sStem[], double sLeaf[], double sRhizome[], double sRoot[], double sGrain[], double sLAI[], int N1Dat)</td></tr>
<tr class="separator:a9e38198cf133d59230f6d1f6beac12bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa289681c71425537eb6fccb7ae92962a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#aa289681c71425537eb6fccb7ae92962a">BioGro</a> (double lat, int doy[], int hr[], double solar[], double temp[], double rh[], double windspeed[], double precip[], double kd, double chil, double heightf, int nlayers, double iRhizome, double irtl, double sencoefs[], int timestep, int vecsize, double Sp, double SpD, double dbpcoefs[25], double thermalp[], double vmax1, double alpha1, double kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double soilcoefs[], double ileafn, double kLN, double vmaxb1, double alphab1, double mresp[], int soilType, int wsFun, int ws, double centcoefs[], double centks[], int centTimestep, int soilLayers, double soilDepths[], double cws[], int hydrDist, double secs[], double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, struct <a class="el" href="structnitro_parms.html">nitroParms</a> nitroP)</td></tr>
<tr class="separator:aa289681c71425537eb6fccb7ae92962a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad67c5b654f4bceb23717a84244291ea0"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_can___str.html">Can_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a> (double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Alpha, double Kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double StomataWS, int ws, double kd, double chil, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, struct <a class="el" href="structnitro_parms.html">nitroParms</a> nitroP)</td></tr>
<tr class="separator:ad67c5b654f4bceb23717a84244291ea0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2fd78212ed1cfbe6bd2d77f6ec851ec"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_can___str.html">Can_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#af2fd78212ed1cfbe6bd2d77f6ec851ec">c3CanAC</a> (double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Jmax, double Rd, double Catm, double o2, double b0, double b1, double theta, double kd, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double StomWS, int ws)</td></tr>
<tr class="separator:af2fd78212ed1cfbe6bd2d77f6ec851ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a18f68430b9e6ed1be3d294b179f8a6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_can___str.html">Can_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a5a18f68430b9e6ed1be3d294b179f8a6">newc3CanAC</a> (double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Jmax, double Rd, double Catm, double o2, double b0, double b1, double theta, double kd, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double StomWS, int ws)</td></tr>
<tr class="separator:a5a18f68430b9e6ed1be3d294b179f8a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dc70ed4086616dabcbc7565d36d247b"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdbp__str.html">dbp_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a4dc70ed4086616dabcbc7565d36d247b">sel_dbp_coef</a> (double coefs[25], double TherPrds[6], double TherTime)</td></tr>
<tr class="separator:a4dc70ed4086616dabcbc7565d36d247b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb35169469ef33705592a28743d105bf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#aeb35169469ef33705592a28743d105bf">resp</a> (double comp, double mrc, double temp)</td></tr>
<tr class="separator:aeb35169469ef33705592a28743d105bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dfc137af141b612fc3cde9b49b0fc5f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structws__str.html">ws_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a> (double precipit, double evapo, double cws, double soildepth, double fieldc, double wiltp, double phi1, double phi2, int soiltype, int wsFun)</td></tr>
<tr class="separator:a8dfc137af141b612fc3cde9b49b0fc5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ac23d61d399453a3837e85128f04b6f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a1ac23d61d399453a3837e85128f04b6f">SoilEvapo</a> (double LAI, double k, double AirTemp, double DirectRad, double awc, double fieldc, double wiltp, double winds, double RelH, double rsec)</td></tr>
<tr class="separator:a1ac23d61d399453a3837e85128f04b6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5537e2a57efaaf41b401666bb9e22062"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsoil_m_l__str.html">soilML_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a> (double precipit, double transp, double *cws, double soildepth, double *depths, double fieldc, double wiltp, double phi1, double phi2, struct <a class="el" href="structsoil_text__str.html">soilText_str</a> soTexS, int wsFun, int layers, double rootDB, double LAI, double k, double AirTemp, double IRad, double winds, double RelH, int hydrDist, double rfl, double rsec, double rsdf)</td></tr>
<tr class="separator:a5537e2a57efaaf41b401666bb9e22062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b62fa0d37af87f9af219e7b0d56f34d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a2b62fa0d37af87f9af219e7b0d56f34d">TempToSWVC</a> (double Temp)</td></tr>
<tr class="separator:a2b62fa0d37af87f9af219e7b0d56f34d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd35797ea11e52f0c527d40a9c1c0b7d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#abd35797ea11e52f0c527d40a9c1c0b7d">TempToSFS</a> (double Temp)</td></tr>
<tr class="separator:abd35797ea11e52f0c527d40a9c1c0b7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abea4623ebab0e4ea7d9be5af1fd80344"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#abea4623ebab0e4ea7d9be5af1fd80344">TempToLHV</a> (double Temp)</td></tr>
<tr class="separator:abea4623ebab0e4ea7d9be5af1fd80344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4a29370ba3b33794837905d82f3b86"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#aef4a29370ba3b33794837905d82f3b86">TempToDdryA</a> (double Temp)</td></tr>
<tr class="separator:aef4a29370ba3b33794837905d82f3b86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a247148ac54cf7d8c851326de6093b71e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a> (double RH, int nlayers)</td></tr>
<tr class="separator:a247148ac54cf7d8c851326de6093b71e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43b0d68a959084dc4f4dc099c8901107"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a> (double WindSpeed, double LAI, int nlayers)</td></tr>
<tr class="separator:a43b0d68a959084dc4f4dc099c8901107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb415c4c261f9fc0140240ad46007c87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#acb415c4c261f9fc0140240ad46007c87">sunML</a> (double Idir, double Idiff, double LAI, int nlayers, double cosTheta, double kd, double chil, double heightf)</td></tr>
<tr class="separator:acb415c4c261f9fc0140240ad46007c87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46827eb56108821fe82228553f535293"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a46827eb56108821fe82228553f535293">lightME</a> (double lat, int DOY, int td)</td></tr>
<tr class="separator:a46827eb56108821fe82228553f535293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2c40f1d5cbe9760e48568b236467a16"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcen_t__str.html">cenT_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#ab2c40f1d5cbe9760e48568b236467a16">Century</a> (double *LeafL, double *StemL, double *RootL, double *RhizL, double smoist, double stemp, int timestep, double SCs[9], double leachWater, double Nfert, double MinN, double precip, double LeafL_Ln, double StemL_Ln, double RootL_Ln, double RhizL_Ln, double LeafL_N, double StemL_N, double RootL_N, double RhizL_N, int soilType, double Ks_cf[8])</td></tr>
<tr class="separator:ab2c40f1d5cbe9760e48568b236467a16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1f878344b2d2444f096bd0da2cb9f24"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_f_l__str.html">FL_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a> (double Lig, double Nit)</td></tr>
<tr class="separator:ab1f878344b2d2444f096bd0da2cb9f24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f6a4f8b6e407fdca09efcebc32bf86c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structflow__str.html">flow_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a> (double *SC, double CNratio, double A, double Lc, double Tm, double <a class="el" href="_bio_cro_8h.html#aeb35169469ef33705592a28743d105bf">resp</a>, int kno, double Ks[8])</td></tr>
<tr class="separator:a3f6a4f8b6e407fdca09efcebc32bf86c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1061dc2ec428954d1e4fd2abd8e17957"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a1061dc2ec428954d1e4fd2abd8e17957">AbiotEff</a> (double smoist, double stemp)</td></tr>
<tr class="separator:a1061dc2ec428954d1e4fd2abd8e17957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a054d5ae3a62e6217a0d4e5093b79bb25"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a054d5ae3a62e6217a0d4e5093b79bb25">sel_phen</a> (int phen)</td></tr>
<tr class="separator:a054d5ae3a62e6217a0d4e5093b79bb25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5b6e16664a459420103984ac5409b858"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a> [8760]</td></tr>
<tr class="separator:a5b6e16664a459420103984ac5409b858"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd2c9bad12951c887e8469151c778947"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#abd2c9bad12951c887e8469151c778947">Leafy</a> [8760]</td></tr>
<tr class="separator:abd2c9bad12951c887e8469151c778947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a929d2badff7fb301509012ee6e6a12e9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a929d2badff7fb301509012ee6e6a12e9">Stemy</a> [8760]</td></tr>
<tr class="separator:a929d2badff7fb301509012ee6e6a12e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6a54d6e671d04cd9b254a8cd1c3315c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#ad6a54d6e671d04cd9b254a8cd1c3315c">Rooty</a> [8760]</td></tr>
<tr class="separator:ad6a54d6e671d04cd9b254a8cd1c3315c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3741856cde2b5152c833b543abe77fc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#aa3741856cde2b5152c833b543abe77fc">Rhizomey</a> [8760]</td></tr>
<tr class="separator:aa3741856cde2b5152c833b543abe77fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46f339721a905fe9e6f60af35ec11974"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a46f339721a905fe9e6f60af35ec11974">Grainy</a> [8760]</td></tr>
<tr class="separator:a46f339721a905fe9e6f60af35ec11974"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac656f07a64aeba7d6ac5a3a536e993c8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a> [8760]</td></tr>
<tr class="separator:ac656f07a64aeba7d6ac5a3a536e993c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a1061dc2ec428954d1e4fd2abd8e17957"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double AbiotEff </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>smoist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stemp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                                            {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordtype">double</span> ans;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keywordtype">double</span> TempEff = 0.0, MoisEff;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">if</span>(stemp &lt; 35){</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    TempEff = 1.0087 / (1 + (46.2 * exp(-0.1899 * stemp)));</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    TempEff = -0.0826 * stemp + 3.84;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  MoisEff = 1.0267 / (1 + 14.7 * exp(-6.5 * smoist));</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  ans = TempEff * MoisEff;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordflow">return</span>(ans);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa289681c71425537eb6fccb7ae92962a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BioGro </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>doy</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solar</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rh</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>windspeed</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precip</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>iRhizome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>irtl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sencoefs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>vecsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SpD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dbpcoefs</em>[25], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thermalp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vmax1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kparm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soilcoefs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ileafn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vmaxb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alphab1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mresp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soilType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wsFun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>centcoefs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>centks</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>centTimestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soilLayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soilDepths</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cws</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hydrDist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>secs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>upperT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lowerT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnitro_parms.html">nitroParms</a>&#160;</td>
          <td class="paramname"><em>nitroP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;{</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a>[8760] ;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#abd2c9bad12951c887e8469151c778947">Leafy</a>[8760] ;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#a929d2badff7fb301509012ee6e6a12e9">Stemy</a>[8760] ;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ad6a54d6e671d04cd9b254a8cd1c3315c">Rooty</a>[8760] ;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#aa3741856cde2b5152c833b543abe77fc">Rhizomey</a>[8760] ;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#a46f339721a905fe9e6f60af35ec11974">Grainy</a>[8760] ;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>[8760] ;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        <span class="keywordtype">double</span> newLeafcol[8760];</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        <span class="keywordtype">double</span> newStemcol[8760];</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        <span class="keywordtype">double</span> newRootcol[8760];</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        <span class="keywordtype">double</span> newRhizomecol[8760];</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        <span class="keywordtype">int</span> i, i3;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        <span class="keywordtype">double</span> Leaf, Stem, Root, Rhizome, LAI, Grain = 0.0;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        <span class="keywordtype">double</span> TTc = 0.0;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        <span class="keywordtype">double</span> kLeaf = 0.0, kStem = 0.0, kRoot = 0.0, kRhizome = 0.0, kGrain = 0.0;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="keywordtype">double</span> newLeaf, newStem = 0.0, newRoot, newRhizome = 0.0, newGrain = 0.0;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        <span class="keywordtype">double</span> litter[4];</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        litter[0] = centcoefs[19];</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        litter[1] = centcoefs[20];</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        litter[2] = centcoefs[21];</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        litter[3] = centcoefs[22];</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        <span class="comment">/* Variables needed for collecting litter */</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="keywordtype">double</span> LeafLitter = litter[0], StemLitter = litter[1];</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        <span class="keywordtype">double</span> RootLitter = litter[2], RhizomeLitter = litter[3];</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        <span class="keywordtype">double</span> LeafLitter_d = 0.0, StemLitter_d = 0.0;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        <span class="keywordtype">double</span> RootLitter_d = 0.0, RhizomeLitter_d = 0.0;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        <span class="keywordtype">double</span> ALitter = 0.0, BLitter = 0.0;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        <span class="keywordtype">double</span> *sti , *sti2, *sti3, *sti4; </div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        <span class="keywordtype">double</span> Remob;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        <span class="keywordtype">int</span> k = 0, q = 0, m = 0, n = 0;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        <span class="keywordtype">int</span> ri = 0;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        <span class="keywordtype">double</span> StomWS = 1, LeafWS = 1;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        <span class="keywordtype">double</span> CanopyA, CanopyT;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        <span class="keywordtype">double</span> vmax, alpha;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="keywordtype">double</span> LeafN_0 = ileafn;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <span class="keywordtype">double</span> LeafN = ileafn; <span class="comment">/* Need to set it because it is used by CanA before it is computed */</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="keywordtype">double</span> iSp = Sp;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        vmax = vmax1;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        alpha = alpha1;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        <span class="comment">/* Century */</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <span class="keywordtype">double</span> MinNitro = centcoefs[18];</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        <span class="keywordtype">double</span> SCCs[9];</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        <span class="keywordtype">double</span> Resp;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> mrc1 = mresp[0];</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> mrc2 = mresp[1];</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> Canopy;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        <span class="keyword">struct </span><a class="code" href="structws__str.html">ws_str</a> WaterS;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        <span class="keyword">struct </span><a class="code" href="structdbp__str.html">dbp_str</a> dbpS;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        <span class="keyword">struct </span><a class="code" href="structcen_t__str.html">cenT_str</a> centS;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        <span class="keyword">struct </span><a class="code" href="structsoil_m_l__str.html">soilML_str</a> soilMLS;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> soTexS; <span class="comment">/* , *soTexSp = &amp;soTexS; */</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        soTexS = <a class="code" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a>(soilType);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        Rhizome = iRhizome;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        Leaf = Rhizome * irtl;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        Stem = Rhizome * 0.001;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        Root = Rhizome * 0.001;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        LAI = Leaf * Sp;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> FieldC = soilcoefs[0];</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> WiltP = soilcoefs[1];</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> phi1 = soilcoefs[2];</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> phi2 = soilcoefs[3];</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> soilDepth = soilcoefs[4];</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        <span class="keywordtype">double</span> waterCont = soilcoefs[5];</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        <span class="keywordtype">double</span> soilEvap, TotEvap;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> SeneLeaf = sencoefs[0];</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> SeneStem = sencoefs[1];</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> SeneRoot = sencoefs[2];</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> SeneRhizome = sencoefs[3];</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        SCCs[0] = centcoefs[0];</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        SCCs[1] = centcoefs[1];</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        SCCs[2] = centcoefs[2];</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        SCCs[3] = centcoefs[3];</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        SCCs[4] = centcoefs[4];</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        SCCs[5] = centcoefs[5];</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        SCCs[6] = centcoefs[6];</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        SCCs[7] = centcoefs[7];</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        SCCs[8] = centcoefs[8];</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="comment">/* Creation of pointers outside the loop */</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        sti = &amp;newLeafcol[0]; <span class="comment">/* This creates sti to be a pointer to the position 0</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="comment">                                 in the newLeafcol vector */</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        sti2 = &amp;newStemcol[0];</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        sti3 = &amp;newRootcol[0];</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        sti4 = &amp;newRhizomecol[0];</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        <span class="keywordflow">for</span>(i=0;i&lt;vecsize;i++)</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        {</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                <span class="comment">/* First calculate the elapsed Thermal Time*/</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                TTc += (temp[i] / (24/timestep));</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                <span class="comment">/* Do the magic! Calculate growth*/</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                Canopy = <a class="code" href="_aux_bio_cro_8c.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a>(LAI,doy[i],hr[i],</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;                               solar[i],temp[i],rh[i],windspeed[i],</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                               lat,nlayers,vmax,alpha,kparm,theta,beta,</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                               Rd,Catm,b0,b1,StomWS,ws,kd, chil,</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;                               heightf, LeafN, kpLN, lnb0, lnb1, lnfun,upperT,lowerT,nitroP);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                CanopyA = Canopy.Assim * timestep;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                CanopyT = Canopy.Trans * timestep;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                <span class="keywordflow">if</span>(ISNAN(CanopyA)){</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                        Rprintf(<span class="stringliteral">&quot;LAI %.2f \n&quot;</span>,LAI); </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                        Rprintf(<span class="stringliteral">&quot;Leaf %.2f \n&quot;</span>,Leaf);</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                        Rprintf(<span class="stringliteral">&quot;irtl %.2f \n&quot;</span>,irtl);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                        Rprintf(<span class="stringliteral">&quot;Rhizome %.2f \n&quot;</span>,Rhizome);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                        Rprintf(<span class="stringliteral">&quot;Sp %.2f \n&quot;</span>,Sp);   </div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                        Rprintf(<span class="stringliteral">&quot;doy[i] %.i %.i \n&quot;</span>,i,doy[i]); </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                        Rprintf(<span class="stringliteral">&quot;hr[i] %.i %.i \n&quot;</span>,i,hr[i]); </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                        Rprintf(<span class="stringliteral">&quot;solar[i] %.i %.2f \n&quot;</span>,i,solar[i]); </div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                        Rprintf(<span class="stringliteral">&quot;temp[i] %.i %.2f \n&quot;</span>,i,temp[i]); </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                        Rprintf(<span class="stringliteral">&quot;rh[i] %.i %.2f \n&quot;</span>,i,rh[i]); </div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                        Rprintf(<span class="stringliteral">&quot;windspeed[i] %.i %.2f \n&quot;</span>,i,windspeed[i]);</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                        Rprintf(<span class="stringliteral">&quot;lat %.i %.2f \n&quot;</span>,i,lat);</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                        Rprintf(<span class="stringliteral">&quot;nlayers %.i %.i \n&quot;</span>,i,nlayers);   </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                }</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                <span class="keywordflow">if</span>(soilLayers &gt; 1){</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                        soilMLS = <a class="code" href="_aux_bio_cro_8c.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a>(precip[i], CanopyT, &amp;cws[0], soilDepth, soilDepths, FieldC, WiltP,</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                                         phi1, phi2, soTexS, wsFun, soilLayers, Root,</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                                         LAI, 0.68, temp[i], solar[i], windspeed[i], rh[i], hydrDist,</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                                         secs[0], secs[1], secs[2]);</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                        StomWS = soilMLS.rcoefPhoto;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                        LeafWS = soilMLS.rcoefSpleaf;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                        soilEvap = soilMLS.SoilEvapo;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                        <span class="keywordflow">for</span>(i3=0;i3&lt;soilLayers;i3++){</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                                cws[i3] = soilMLS.cws[i3];</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                        }</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                        soilEvap = <a class="code" href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a>(LAI, 0.68, temp[i], solar[i], waterCont, FieldC, WiltP, windspeed[i], rh[i], secs[1]);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                        TotEvap = soilEvap + CanopyT;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                        WaterS = <a class="code" href="_aux_bio_cro_8c.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a>(precip[i],TotEvap,waterCont,soilDepth,FieldC,WiltP,phi1,phi2,soilType, wsFun);   </div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                        waterCont = WaterS.awc;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                        StomWS = WaterS.rcoefPhoto ;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                        LeafWS = WaterS.rcoefSpleaf;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                }</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                <span class="comment">/* Picking the dry biomass partitioning coefficients */</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                dbpS = <a class="code" href="_aux_bio_cro_8c.html#a4dc70ed4086616dabcbc7565d36d247b">sel_dbp_coef</a>(dbpcoefs, thermalp, TTc);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                kLeaf = dbpS.kLeaf;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                kStem = dbpS.kStem;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                kRoot = dbpS.kRoot;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                kRhizome = dbpS.kRhiz;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                kGrain = dbpS.kGrain;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                <span class="keywordflow">if</span>(ISNAN(kRhizome) || ISNAN(kLeaf) || ISNAN(kRoot) || ISNAN(kStem) || ISNAN(kGrain)){</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                        Rprintf(<span class="stringliteral">&quot;kLeaf %.2f, kStem %.2f, kRoot %.2f, kRhizome %.2f, kGrain %.2f \n&quot;</span>,kLeaf,kStem,kRoot,kRhizome,kGrain);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                        Rprintf(<span class="stringliteral">&quot;iter %i \n&quot;</span>,i);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                }</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                <span class="keywordflow">if</span>(i % 24*centTimestep == 0){</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                        LeafLitter_d = LeafLitter * ((0.1/30)*centTimestep);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                        StemLitter_d = StemLitter * ((0.1/30)*centTimestep);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                        RootLitter_d = RootLitter * ((0.1/30)*centTimestep);</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                        RhizomeLitter_d = RhizomeLitter * ((0.1/30)*centTimestep);</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;       </div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                        LeafLitter -= LeafLitter_d;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                        StemLitter -= StemLitter_d;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                        RootLitter -= RootLitter_d;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                        RhizomeLitter -= RhizomeLitter_d;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;       </div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                        centS = <a class="code" href="_bio_cro_8h.html#ab2c40f1d5cbe9760e48568b236467a16">Century</a>(&amp;LeafLitter_d,&amp;StemLitter_d,&amp;RootLitter_d,&amp;RhizomeLitter_d,</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                                        waterCont,temp[i],centTimestep,SCCs,WaterS.runoff,</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;                                        centcoefs[17], <span class="comment">/* N fertilizer*/</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;                                        MinNitro, <span class="comment">/* initial Mineral nitrogen */</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;                                        precip[i], <span class="comment">/* precipitation */</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;                                        centcoefs[9], <span class="comment">/* Leaf litter lignin */</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                                        centcoefs[10], <span class="comment">/* Stem litter lignin */</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                                        centcoefs[11], <span class="comment">/* Root litter lignin */</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                                        centcoefs[12], <span class="comment">/* Rhizome litter lignin */</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;                                        centcoefs[13], <span class="comment">/* Leaf litter N */</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                                        centcoefs[14], <span class="comment">/* Stem litter N */</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                                        centcoefs[15],  <span class="comment">/* Root litter N */</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                                        centcoefs[16],   <span class="comment">/* Rhizome litter N */</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                                        soilType, centks);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                }</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                <span class="comment">/* Here I can insert the code for Nitrogen limitations on photosynthesis</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment">                   parameters. This is taken From Harley et al. (1992) Modelling cotton under</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment">                   elevated CO2. PCE. This is modeled as a simple linear relationship between</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="comment">                   leaf nitrogen and vmax and alpha. Leaf Nitrogen should be modulated by N</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="comment">                   availability and possibly by the Thermal time accumulated.*/</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                MinNitro = centS.MinN;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                Resp = centS.Resp;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;     </div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                SCCs[0] = centS.SCs[0];</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                SCCs[1] = centS.SCs[1];</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                SCCs[2] = centS.SCs[2];</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                SCCs[3] = centS.SCs[3];</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                SCCs[4] = centS.SCs[4];</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                SCCs[5] = centS.SCs[5];</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                SCCs[6] = centS.SCs[6];</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                SCCs[7] = centS.SCs[7];</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                SCCs[8] = centS.SCs[8];</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                LeafN = LeafN_0 * exp(-kLN * TTc); </div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                vmax = (LeafN_0 - LeafN) * vmaxb1 + vmax1;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                alpha = (LeafN_0 - LeafN) * alphab1 + alpha1;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                <span class="keywordflow">if</span>(kLeaf &gt; 0)</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                {</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                        newLeaf = CanopyA * kLeaf * LeafWS ; </div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                        <span class="comment">/*  The major effect of water stress is on leaf expansion rate. See Boyer (1970)</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="comment">                            Plant. Phys. 46, 233-235. For this the water stress coefficient is different</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment">                            for leaf and vmax. */</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                        <span class="comment">/* Tissue respiration. See Amthor (1984) PCE 7, 561-*/</span> </div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                        <span class="comment">/* The 0.02 and 0.03 are constants here but vary depending on species</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">                           as pointed out in that reference. */</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                        newLeaf = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newLeaf, mrc1, temp[i]);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                        *(sti+i) = newLeaf; <span class="comment">/* This populates the vector newLeafcol. It makes sense</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="comment">                                               to use i because when kLeaf is negative no new leaf is</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="comment">                                               being accumulated and thus would not be subjected to senescence */</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                        newLeaf = Leaf * kLeaf ;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                        Rhizome += kRhizome * -newLeaf * 0.9; <span class="comment">/* 0.9 is the efficiency of retranslocation */</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                        Stem += kStem * -newLeaf   * 0.9;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                        Root += kRoot * -newLeaf * 0.9;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                        Grain += kGrain * -newLeaf * 0.9;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                }</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; SeneLeaf){</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                        Leaf += newLeaf;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                        Leaf += newLeaf - *(sti+k); <span class="comment">/* This means that the new value of leaf is</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="comment">                                                       the previous value plus the newLeaf</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="comment">                                                       (Senescence might start when there is</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">                                                       still leaf being produced) minus the leaf</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">                                                       produced at the corresponding k.*/</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                        Remob = *(sti+k) * 0.6 ;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                        LeafLitter += *(sti+k) * 0.4; <span class="comment">/* Collecting the leaf litter */</span> </div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                        Rhizome += kRhizome * Remob;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                        Stem += kStem * Remob; </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                        Root += kRoot * Remob;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                        Grain += kGrain * Remob;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                        k++;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                }</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                <span class="comment">/* The specific leaf area declines with the growing season at least in</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment">                   Miscanthus.  See Danalatos, Nalianis and Kyritsis &quot;Growth and Biomass</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="comment">                   Productivity of Miscanthus sinensis &quot;Giganteus&quot; under optimum cultural</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="comment">                   management in north-eastern greece*/</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                <span class="keywordflow">if</span>(i%24 == 0){</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                        Sp = iSp - (doy[i] - doy[0]) * SpD;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                }</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                <span class="comment">/* Rprintf(&quot;Sp %.2f \n&quot;, Sp); */</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                LAI = Leaf * Sp ;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                <span class="comment">/* New Stem*/</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                <span class="keywordflow">if</span>(kStem &gt; 0)</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                {</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                        newStem = CanopyA * kStem ;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                        newStem = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newStem, mrc1, temp[i]);</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                        *(sti2+i) = newStem;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                }</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; SeneStem){</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                        Stem += newStem;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                        Stem += newStem - *(sti2+q);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                        StemLitter += *(sti2+q);</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                        q++;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                }</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                <span class="keywordflow">if</span>(kRoot &gt; 0)</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                {</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                        newRoot = CanopyA * kRoot ;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                        newRoot = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newRoot, mrc2, temp[i]);</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                        *(sti3+i) = newRoot;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                        newRoot = Root * kRoot ;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                        Rhizome += kRhizome * -newRoot * 0.9;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                        Stem += kStem * -newRoot       * 0.9;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                        Leaf += kLeaf * -newRoot * 0.9;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                        Grain += kGrain * -newRoot * 0.9;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; SeneRoot){</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                        Root += newRoot;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                        Root += newRoot - *(sti3+m);</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                        RootLitter += *(sti3+m);</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                        m++;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                <span class="keywordflow">if</span>(kRhizome &gt; 0)</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                {</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                        newRhizome = CanopyA * kRhizome ;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                        newRhizome = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newRhizome, mrc2, temp[i]);</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                        *(sti4+ri) = newRhizome;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                        <span class="comment">/* Here i will not work because the rhizome goes from being a source</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="comment">                           to a sink. I need its own index. Let&#39;s call it rhizome&#39;s i or ri.*/</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                        ri++;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                        <span class="keywordflow">if</span>(Rhizome &lt; 0){</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                                Rhizome = 1e-4;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                                warning(<span class="stringliteral">&quot;Rhizome became negative&quot;</span>);</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                        }</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                        newRhizome = Rhizome * kRhizome;</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                        Root += kRoot * -newRhizome ;</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                        Stem += kStem * -newRhizome ;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                        Leaf += kLeaf * -newRhizome ;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                        Grain += kGrain * -newRhizome;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                }</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; SeneRhizome){</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                        Rhizome += newRhizome;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                }<span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                        Rhizome += newRhizome - *(sti4+n);</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                        RhizomeLitter += *(sti4+n);</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                        n++;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                }</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                <span class="keywordflow">if</span>((kGrain &lt; 1e-10) || (TTc &lt; thermalp[4])){</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                        newGrain = 0.0;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                        Grain += newGrain;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                        newGrain = CanopyA * kGrain;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                        <span class="comment">/* No respiration for grain at the moment */</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                        <span class="comment">/* No senescence either */</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                        Grain += newGrain;  </div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                }</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                ALitter += LeafLitter + StemLitter;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                BLitter += RootLitter + RhizomeLitter;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                CanopyAssim[i] =  CanopyA;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                Leafy[i] = Leaf;</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                Stemy[i] = Stem;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                Rooty[i] =  Root;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                Rhizomey[i] = Rhizome;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                Grainy[i] = Grain;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                LAIc[i] = LAI;</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;        }</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;}</div>
<div class="ttc" id="_bio_cro_8h_html_ab2c40f1d5cbe9760e48568b236467a16"><div class="ttname"><a href="_bio_cro_8h.html#ab2c40f1d5cbe9760e48568b236467a16">Century</a></div><div class="ttdeci">struct cenT_str Century(double *LeafL, double *StemL, double *RootL, double *RhizL, double smoist, double stemp, int timestep, double SCs[9], double leachWater, double Nfert, double MinN, double precip, double LeafL_Ln, double StemL_Ln, double RootL_Ln, double RhizL_Ln, double LeafL_N, double StemL_N, double RootL_N, double RhizL_N, int soilType, double Ks_cf[8])</div><div class="ttdef"><b>Definition:</b> Century.c:21</div></div>
<div class="ttc" id="_bio_cro_8h_html_a5b6e16664a459420103984ac5409b858"><div class="ttname"><a href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a></div><div class="ttdeci">double CanopyAssim[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:10</div></div>
<div class="ttc" id="structdbp__str_html"><div class="ttname"><a href="structdbp__str.html">dbp_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:85</div></div>
<div class="ttc" id="structws__str_html"><div class="ttname"><a href="structws__str.html">ws_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:48</div></div>
<div class="ttc" id="_bio_cro_8h_html_aa3741856cde2b5152c833b543abe77fc"><div class="ttname"><a href="_bio_cro_8h.html#aa3741856cde2b5152c833b543abe77fc">Rhizomey</a></div><div class="ttdeci">double Rhizomey[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:14</div></div>
<div class="ttc" id="_bio_cro_8h_html_ad6a54d6e671d04cd9b254a8cd1c3315c"><div class="ttname"><a href="_bio_cro_8h.html#ad6a54d6e671d04cd9b254a8cd1c3315c">Rooty</a></div><div class="ttdeci">double Rooty[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:13</div></div>
<div class="ttc" id="structsoil_text__str_html"><div class="ttname"><a href="structsoil_text__str.html">soilText_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:95</div></div>
<div class="ttc" id="_bio_cro_8h_html_ac656f07a64aeba7d6ac5a3a536e993c8"><div class="ttname"><a href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a></div><div class="ttdeci">double LAIc[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:16</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a8dfc137af141b612fc3cde9b49b0fc5f"><div class="ttname"><a href="_aux_bio_cro_8c.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a></div><div class="ttdeci">struct ws_str watstr(double precipit, double evapo, double cws, double soildepth, double fieldc, double wiltp, double phi1, double phi2, int soiltype, int wsFun)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:673</div></div>
<div class="ttc" id="_bio_cro_8h_html_a46f339721a905fe9e6f60af35ec11974"><div class="ttname"><a href="_bio_cro_8h.html#a46f339721a905fe9e6f60af35ec11974">Grainy</a></div><div class="ttdeci">double Grainy[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:15</div></div>
<div class="ttc" id="structsoil_m_l__str_html"><div class="ttname"><a href="structsoil_m_l__str.html">soilML_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:59</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a72f93049960e067cda6e7291ff1ff21a"><div class="ttname"><a href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a></div><div class="ttdeci">struct soilText_str soilTchoose(int soiltype)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1166</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_ad67c5b654f4bceb23717a84244291ea0"><div class="ttname"><a href="_aux_bio_cro_8c.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a></div><div class="ttdeci">struct Can_Str CanAC(double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Alpha, double Kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double StomataWS, int ws, double kd, double chil, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, struct nitroParms nitroP)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:539</div></div>
<div class="ttc" id="structcen_t__str_html"><div class="ttname"><a href="structcen_t__str.html">cenT_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:6</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a4dc70ed4086616dabcbc7565d36d247b"><div class="ttname"><a href="_aux_bio_cro_8c.html#a4dc70ed4086616dabcbc7565d36d247b">sel_dbp_coef</a></div><div class="ttdeci">struct dbp_str sel_dbp_coef(double coefs[25], double TherPrds[6], double TherTime)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1039</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a5537e2a57efaaf41b401666bb9e22062"><div class="ttname"><a href="_aux_bio_cro_8c.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a></div><div class="ttdeci">struct soilML_str soilML(double precipit, double transp, double *cws, double soildepth, double *depths, double fieldc, double wiltp, double phi1, double phi2, struct soilText_str soTexS, int wsFun, int layers, double rootDB, double LAI, double k, double AirTemp, double IRad, double winds, double RelH, int hydrDist, double rfl, double rsec, double rsdf)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:807</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_ac96acf762dd39d5ff20d71788b0ca566"><div class="ttname"><a href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a></div><div class="ttdeci">double SoilEvapo(double LAI, double k, double AirTemp, double IRad, double awc, double fieldc, double wiltp, double winds, double RelH, double rsec)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:412</div></div>
<div class="ttc" id="struct_can___str_html"><div class="ttname"><a href="struct_can___str.html">Can_Str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:41</div></div>
<div class="ttc" id="_bio_cro_8h_html_a929d2badff7fb301509012ee6e6a12e9"><div class="ttname"><a href="_bio_cro_8h.html#a929d2badff7fb301509012ee6e6a12e9">Stemy</a></div><div class="ttdeci">double Stemy[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:12</div></div>
<div class="ttc" id="_bio_cro_8h_html_abd2c9bad12951c887e8469151c778947"><div class="ttname"><a href="_bio_cro_8h.html#abd2c9bad12951c887e8469151c778947">Leafy</a></div><div class="ttdeci">double Leafy[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:11</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_aeb35169469ef33705592a28743d105bf"><div class="ttname"><a href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a></div><div class="ttdeci">double resp(double comp, double mrc, double temp)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1024</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af2fd78212ed1cfbe6bd2d77f6ec851ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_can___str.html">Can_Str</a> c3CanAC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>o2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad67c5b654f4bceb23717a84244291ea0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_can___str.html">Can_Str</a> CanAC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kparm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomataWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>upperT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lowerT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnitro_parms.html">nitroParms</a>&#160;</td>
          <td class="paramname"><em>nitroP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;{</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="keyword">struct </span><a class="code" href="struct_e_t___str.html">ET_Str</a> tmp5_ET, tmp6_ET;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> ans;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmpc4;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmpc42;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordtype">double</span> Idir, Idiff, cosTh;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordtype">double</span> IDir, IDiff, Itot, rh, WS;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordtype">double</span> pLeafsun, pLeafshade;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordtype">double</span> Leafsun, Leafshade;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordtype">double</span> CanHeight;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordtype">double</span> vmax1, leafN_lay;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordtype">double</span> TempIdir,TempIdiff,AssIdir,AssIdiff,GAssIdir,GAssIdiff;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keywordtype">double</span> CanopyA, CanopyT,GCanopyA;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 3600 * 1e-6 * 30 * 1e-6 * 10000;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="comment">/* For Assimilation */</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="comment">/* 1e-6 converts micro mols to mols */</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">/* 30 is the grams in one mol of CO2 */</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="comment">/* For Transpiration */</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="comment">/* 1e-3 converts mili mols to mols */</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="comment">/* 18 is the grams in one mol of H20 */</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a>(lat,DOY,hr);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        Idir = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[0] * solarR;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        Idiff = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[1] * solarR;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        cosTh = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[2];</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <a class="code" href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a>(Idir,Idiff,LAI,nlayers,cosTh, kd, chil, heightf);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="comment">/* results from multilayer model */</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        LAIc = LAI / nlayers;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="comment">/* Next I need the RH and wind profile */</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <a class="code" href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a>(RH,nlayers);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <a class="code" href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a>(WindSpeed,LAI,nlayers);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <a class="code" href="_aux_bio_cro_8c.html#aa65c89edaec63830e4dd568a89d12fa2">LNprof</a>(leafN, LAI, nlayers, kpLN);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="comment">/* It populates tmp5 */</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="comment">/* Next use the EvapoTrans function */</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        CanopyA=0.0;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        GCanopyA=0.0;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        CanopyT=0.0;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                leafN_lay = <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a>[--<a class="code" href="_aux_bio_cro_8h.html#a39f70a6dfb72439e2f4e0f03f27c0813">tp5</a>];</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                <span class="keywordflow">if</span>(lnfun == 0){</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                        vmax1 = Vmax;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                        vmax1=nitroP.<a class="code" href="structnitro_parms.html#ad7e57d8efdd075a1b184551d20eb44b3">Vmaxb1</a>*leafN_lay+nitroP.<a class="code" href="structnitro_parms.html#a518b100123bc67830c26f15177a8172f">Vmaxb0</a>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                              <span class="keywordflow">if</span>(vmax1&lt;0) vmax1=0.0;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                                      Alpha=nitroP.<a class="code" href="structnitro_parms.html#aaf784159d7555e9af103853d7d096b77">alphab1</a>*leafN_lay+nitroP.<a class="code" href="structnitro_parms.html#acdd68befaeeefae8f9c78aded190c9af">alphab0</a>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                                       Rd=nitroP.<a class="code" href="structnitro_parms.html#abd565ba33eeb6178c0a8d41e2024403b">Rdb1</a>*leafN_lay+nitroP.<a class="code" href="structnitro_parms.html#a965a809fcb997a1625a5ff1f2a60565b">Rdb0</a>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;               <span class="comment">/* For now alpha is not affected by leaf nitrogen */</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                IDir = <a class="code" href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a>[--<a class="code" href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a>];</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                Itot = <a class="code" href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a>[--<a class="code" href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a>];</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                rh = <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>[--<a class="code" href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a>];</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                WS = <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>[--<a class="code" href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a>];</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                pLeafsun = <a class="code" href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a>[--<a class="code" href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a>];</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                CanHeight = <a class="code" href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a>[--<a class="code" href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a>];</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                Leafsun = LAIc * pLeafsun;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                tmp5_ET = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDir,Itot,Temp,rh,WS,LAIc,CanHeight,StomataWS,ws,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,upperT,lowerT,Catm);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                TempIdir = Temp + tmp5_ET.Deltat;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                tmpc4 = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(IDir,TempIdir,rh,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,StomataWS, Catm, ws,upperT,lowerT);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                AssIdir = tmpc4.Assim;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                GAssIdir =tmpc4.GrossAssim;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                IDiff = <a class="code" href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a>[--<a class="code" href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a>];</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                pLeafshade = <a class="code" href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a>[--<a class="code" href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a>];</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                Leafshade = LAIc * pLeafshade;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                tmp6_ET = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDiff,Itot,Temp,rh,WS,LAIc,CanHeight,StomataWS,ws,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,upperT,lowerT,Catm);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                TempIdiff = Temp + tmp6_ET.Deltat;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                tmpc42 = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(IDiff,TempIdiff,rh,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,StomataWS, Catm, ws,upperT,lowerT);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                AssIdiff = tmpc42.Assim;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                GAssIdiff = tmpc42.GrossAssim;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                CanopyA += Leafsun * AssIdir + Leafshade * AssIdiff;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                GCanopyA += Leafsun * GAssIdir + Leafshade * GAssIdiff;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">// I am evaluating CanopyT using Penman Method because it gives realistic results</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">// IN future canopyT needs to be fixed</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">//                CanopyT += Leafsun * tmp5_ET.TransR + Leafshade * tmp6_ET.TransR;</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                CanopyT += Leafsun * tmp5_ET.EPenman + Leafshade * tmp6_ET.EPenman;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        }</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="comment">/*## These are micro mols of CO2 per m2 per sec for Assimilation</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">          ## and mili mols of H2O per m2 per sec for Transpiration</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">          ## Need to convert to </span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">          ## 3600 converts seconds to hours</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">          ## 10^-6 converts micro mols to mols</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">          ## 30 converts mols of CO2 to grams</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">          ## (1/10^6) converts grams to Mg</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">          ## 10000 scales up to ha */</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">/* A similar conversion is made for water but</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">   replacing 30 by 18 and mili mols are converted to</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">   mols (instead of micro) */</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        ans.Assim = cf * CanopyA ;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        ans.Trans = cf2 * CanopyT; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        ans.GrossAssim=cf*GCanopyA;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">return</span>(ans);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;}</div>
<div class="ttc" id="_aux_bio_cro_8c_html_acb415c4c261f9fc0140240ad46007c87"><div class="ttname"><a href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a></div><div class="ttdeci">void sunML(double Idir, double Idiff, double LAI, int nlayers, double cosTheta, double kd, double chil, double heightf)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:74</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a5a00a948cd8575f53c71ee1f4b799da5"><div class="ttname"><a href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a></div><div class="ttdeci">double layFshade[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:26</div></div>
<div class="ttc" id="structnitro_parms_html_a518b100123bc67830c26f15177a8172f"><div class="ttname"><a href="structnitro_parms.html#a518b100123bc67830c26f15177a8172f">nitroParms::Vmaxb0</a></div><div class="ttdeci">double Vmaxb0</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:132</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a959c4cc4acdec59096dac039bfdb627b"><div class="ttname"><a href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a></div><div class="ttdeci">int sp3</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="c4photo_8c_html_ae71c7850944d255a9b995a06fdb305aa"><div class="ttname"><a href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a></div><div class="ttdeci">struct c4_str c4photoC(double Qp, double Tl, double RH, double vmax, double alpha, double kparm, double theta, double beta, double Rd, double bb0, double bb1, double StomaWS, double Ca, int ws, double upperT, double lowerT)</div><div class="ttdef"><b>Definition:</b> c4photo.c:195</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a048d95ccd2cc9d2f00c78c97343c9a6a"><div class="ttname"><a href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a></div><div class="ttdeci">int sp5</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_bio_cro_8h_html_ac656f07a64aeba7d6ac5a3a536e993c8"><div class="ttname"><a href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a></div><div class="ttdeci">double LAIc[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:16</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a05f213f4cb25cf49735180ff3b883107"><div class="ttname"><a href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a></div><div class="ttdeci">struct ET_Str EvapoTrans(double Rad, double Itot, double Airtemperature, double RH, double WindSpeed, double LeafAreaIndex, double CanopyHeight, double StomataWS, int ws, double vmax2, double alpha2, double kparm, double theta, double beta, double Rd2, double b02, double b12, double upperT, double lowerT, double Catm)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:208</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_acfad88ff5207b2ab57fc1dca17271065"><div class="ttname"><a href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a></div><div class="ttdeci">double tmp4[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:29</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_aab252cacb5d92c011d673d2db55cba0d"><div class="ttname"><a href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a></div><div class="ttdeci">double tmp1[3]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:21</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_ac86af9361847656ad3514e64ad9e9842"><div class="ttname"><a href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a></div><div class="ttdeci">int sp6</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a5ebe5f68c3871953059c08a083acdb9c"><div class="ttname"><a href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a></div><div class="ttdeci">double layHeight[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:27</div></div>
<div class="ttc" id="structnitro_parms_html_a965a809fcb997a1625a5ff1f2a60565b"><div class="ttname"><a href="structnitro_parms.html#a965a809fcb997a1625a5ff1f2a60565b">nitroParms::Rdb0</a></div><div class="ttdeci">double Rdb0</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:136</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_aaa2add75bf14b805a4da749043e7be33"><div class="ttname"><a href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a></div><div class="ttdeci">double tmp5[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:30</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a972c42de1800efab3685fc8a47e05da5"><div class="ttname"><a href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a></div><div class="ttdeci">int sp2</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a39f70a6dfb72439e2f4e0f03f27c0813"><div class="ttname"><a href="_aux_bio_cro_8h.html#a39f70a6dfb72439e2f4e0f03f27c0813">tp5</a></div><div class="ttdeci">int tp5</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:19</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a0b8103786ef18d899e25c932a2eb5b88"><div class="ttname"><a href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a></div><div class="ttdeci">double layIdiff[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:23</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_aa65c89edaec63830e4dd568a89d12fa2"><div class="ttname"><a href="_aux_bio_cro_8c.html#aa65c89edaec63830e4dd568a89d12fa2">LNprof</a></div><div class="ttdeci">void LNprof(double LeafN, double LAI, int nlayers, double kpLN)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:163</div></div>
<div class="ttc" id="structnitro_parms_html_abd565ba33eeb6178c0a8d41e2024403b"><div class="ttname"><a href="structnitro_parms.html#abd565ba33eeb6178c0a8d41e2024403b">nitroParms::Rdb1</a></div><div class="ttdeci">double Rdb1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:135</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a25e1abfffbd0ba6bcb9e7d2b6c847c04"><div class="ttname"><a href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a></div><div class="ttdeci">int sp4</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="structc4__str_html"><div class="ttname"><a href="structc4__str.html">c4_str</a></div><div class="ttdef"><b>Definition:</b> c4photo.h:10</div></div>
<div class="ttc" id="structnitro_parms_html_ad7e57d8efdd075a1b184551d20eb44b3"><div class="ttname"><a href="structnitro_parms.html#ad7e57d8efdd075a1b184551d20eb44b3">nitroParms::Vmaxb1</a></div><div class="ttdeci">double Vmaxb1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:131</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_af8b40a97721000892ae5e0ac624af4c6"><div class="ttname"><a href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a></div><div class="ttdeci">int tp3</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:19</div></div>
<div class="ttc" id="structnitro_parms_html_acdd68befaeeefae8f9c78aded190c9af"><div class="ttname"><a href="structnitro_parms.html#acdd68befaeeefae8f9c78aded190c9af">nitroParms::alphab0</a></div><div class="ttdeci">double alphab0</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:134</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a15219c620f8cdf6d8cf731e485e2c668"><div class="ttname"><a href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a></div><div class="ttdeci">double tmp3[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:28</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a247148ac54cf7d8c851326de6093b71e"><div class="ttname"><a href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a></div><div class="ttdeci">void RHprof(double RH, int nlayers)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:144</div></div>
<div class="ttc" id="struct_can___str_html"><div class="ttname"><a href="struct_can___str.html">Can_Str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:41</div></div>
<div class="ttc" id="structnitro_parms_html_aaf784159d7555e9af103853d7d096b77"><div class="ttname"><a href="structnitro_parms.html#aaf784159d7555e9af103853d7d096b77">nitroParms::alphab1</a></div><div class="ttdeci">double alphab1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:133</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a43b0d68a959084dc4f4dc099c8901107"><div class="ttname"><a href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a></div><div class="ttdeci">void WINDprof(double WindSpeed, double LAI, int nlayers)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:128</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a1e5f45a584d3c5541472f92c5875e4ea"><div class="ttname"><a href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a></div><div class="ttdeci">double layItotal[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:24</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a36e4d9011835445995335074adedad9a"><div class="ttname"><a href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a></div><div class="ttdeci">int tp4</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:19</div></div>
<div class="ttc" id="struct_e_t___str_html"><div class="ttname"><a href="struct_e_t___str.html">ET_Str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:32</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a029005f88756e3761a72c104fae0d57b"><div class="ttname"><a href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a></div><div class="ttdeci">double layFsun[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:25</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a287f9452c1f62b4c5c9ec0616503fb8e"><div class="ttname"><a href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a></div><div class="ttdeci">int sp1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a46827eb56108821fe82228553f535293"><div class="ttname"><a href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a></div><div class="ttdeci">void lightME(double lat, int DOY, int td)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:26</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_ab0638a2083d3e8d4c1ac43a116da1ad8"><div class="ttname"><a href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a></div><div class="ttdeci">double layIdir[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:22</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab2c40f1d5cbe9760e48568b236467a16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcen_t__str.html">cenT_str</a> Century </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>LeafL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>StemL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>RootL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>RhizL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>smoist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SCs</em>[9], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leachWater</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Nfert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MinN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LeafL_Ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StemL_Ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RootL_Ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RhizL_Ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LeafL_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StemL_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RootL_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RhizL_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soilType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ks_cf</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                        {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">/* Converting Mg ha^-1 to g m^-2 */</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">/* 1 Mg = 1e6 grams*/</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">/* 1 ha = 1e4 m^2 */</span>  </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 100;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  *LeafL *= cf; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  *StemL *= cf;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  *RootL *= cf;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  *RhizL *= cf;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcen_t__str.html">cenT_str</a> tmp;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> soilTemp;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_f_l__str.html">FL_str</a> FmLc_Leaf, FmLc_Stem, FmLc_Root, FmLc_Rhiz;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C1_5_Leaf, C2_5_Leaf, C1_5_Stem, C2_5_Stem;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C1_7_Leaf_Ln, C1_7_Stem_Ln;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C3_6_Root, C4_6_Root, C3_6_Rhiz, C4_6_Rhiz;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C3_7_Root_Ln, C3_7_Rhiz_Ln;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C5_7, C6, C7, C8_6;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">double</span> C6_7, C6_8, C6_9, C7_6, C7_8;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">double</span> C_ap, C_al, C_sp; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordtype">double</span> SC1_Leaf, SC2_Leaf, SC1_Stem, SC2_Stem;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">double</span> SC3_Root, SC4_Root, SC3_Rhiz, SC4_Rhiz;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">/*  </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">    I need the separate fractions of Leaf Litter and Stem Litter </span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">  Because they have different lignin to N ratios </span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">  Presumably, the rhizome and root are similar </span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">  There is an issue here that I should be careful about I&#39;m importing </span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">  biomass, but need only carbon in some of these calculations </span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">  I also need to determine the initial values of carbon for each </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">  component </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  soilTemp = <a class="code" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a>(soilType);  </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">double</span> T = soilTemp.clay + soilTemp.silt; <span class="comment">/*  silt plus clay content of the soil */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">double</span> Ts = soilTemp.sand; <span class="comment">/*  Sand content of the soil */</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">double</span> Tc = soilTemp.clay; <span class="comment">/*  Clay content of the soil */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">double</span> CN_structural = 150;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">double</span> CN_surface;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordtype">double</span> CN_active ;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">double</span> CN_slow ;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">double</span> CN_passive ;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">double</span> SN1, SN2, SN3, SN4, SN5, SN6, SN7, SN8, SN9;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">double</span> SC1, SC2, SC3, SC4, SC5, SC6, SC7, SC8, SC9;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">double</span> Abiot;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">double</span> Na = 0.0, Nf = 0.0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">double</span> PlantN;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordtype">double</span> SC1_Leaf_Ln, SC1_Stem_Ln;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">double</span> SC3_Root_Ln, SC3_Rhiz_Ln;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">/* Converting from Mg ha^-1 to g m^-2 */</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  SC1 = SCs[0] * cf;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  SC2 = SCs[1] * cf;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  SC3 = SCs[2] * cf;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  SC4 = SCs[3] * cf;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  SC5 = SCs[4] * cf;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  SC6 = SCs[5] * cf;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  SC7 = SCs[6] * cf;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  SC8 = SCs[7] * cf;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  SC9 = SCs[8] * cf;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">MinN</a> = 0.0, <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> = 0.0;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC1_5 = 0.6;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC1_7 = 0.3;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC3_7 = 0.3;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC2_5 = 0.6;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC3_6 = 0.55;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC4_6 = 0.55;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC5_7 = 0.6;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC6 = 0.85 - 0.68 * T;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC7 = 0.55;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> respC8 = 0.55;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordtype">double</span> Ks[8];</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">/*  Tm is the effect of soil texture on active SOM turnover */</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">double</span> Tm = 1 - 0.75 * T;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">/*    The flow constants are taken from the paper </span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">      and Parton et al. 1993 Global Biogeochemistry pg 785 </span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">      but </span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">      Parton et al. 1987 SSSJ 51:1173 </span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">      is also relevant</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">      double Ksy[ ] = { 3.9, 4.9, 7.3, 6.0, 14.8, 18.5, 0.2, 0.0045 };     The units are year^-1  </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">      To get the rates per week we can divide by 52</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">      To get the rates poer day we can divide by 365</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">/* It seems that the rates are the ones reported in Parton et al. 1993 Global Biogeochemical Cycles */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">/* These are annual rates and to convert to other time steps the model should be run accordingly */</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">/* Rprintf(&quot;Ks[3] : %f Ks[4] : %f \n&quot;,Ks[3],Ks[4]); */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">/* Rprintf(&quot;Ks[5] : %f Ks[6] : %f \n&quot;,Ks[5],Ks[6]); */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;     <span class="keywordflow">if</span>(timestep == 7){</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;       Ks[0] = Ks_cf[0] / 52 ;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;       Ks[1] = Ks_cf[1] / 52 ;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;       Ks[2] = Ks_cf[2] / 52 ;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;       Ks[3] = Ks_cf[3] / 52 ;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;       Ks[4] = Ks_cf[4] / 52 ;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;       Ks[5] = Ks_cf[5] / 52 ;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;       Ks[6] = Ks_cf[6] / 52 ;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;       Ks[7] = Ks_cf[7] / 52 ;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;     }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;     <span class="keywordflow">if</span>(timestep == 1){   </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;       Ks[0] = Ks_cf[0] / 365 ; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;       Ks[1] = Ks_cf[1] / 365 ; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;       Ks[2] = Ks_cf[2] / 365 ; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;       Ks[3] = Ks_cf[3] / 365 ; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;       Ks[4] = Ks_cf[4] / 365 ; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;       Ks[5] = Ks_cf[5] / 365 ; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;       Ks[6] = Ks_cf[6] / 365 ; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;       Ks[7] = Ks_cf[7] / 365 ;  </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;     } </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">/* Nitrogen processes </span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">    N deposition */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  Na = 0.21 + 0.0028 * precip * 0.10 ;  <span class="comment">/*precipitation is entered in mm</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">                                          but it is needed in cm for this</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">                                           equation. Idem below */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">/*  N fixation */</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  Nf = -0.18 + 0.014 * precip * 0.10 ; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">/* The resulting N is in g N m^-2 yr^-1 </span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">   Conversions</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">   g =&gt; Mg : multiply by 1e-6</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">   m^2 =&gt; ha : multiply by 1e4</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">   year to week : divide by 52 */</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">if</span>(timestep == 7){</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;     Na /=  52;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;     Nf /=  52;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span>(timestep == 1){</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;     Na /=  365;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;     Nf /=  365;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">/*   Rprintf(&quot;Na : %f \n&quot;,Na); */</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">/*   Rprintf(&quot;Nf : %f \n&quot;,Nf); */</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">/*   Nitrogen in the form of fertilizer */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">/*   The input units should be in g N m^2 */</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">/*   Rprintf(&quot;Nfert : %f iMinN : %f \n&quot;,Nfert,iMinN); */</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  MinN = Na + Nf + Nfert + iMinN;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">/*   Rprintf(&quot;MinN 0: %f \n&quot;,MinN); */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  PlantN = *LeafL * LeafL_N + *StemL * StemL_N;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  CN_surface = 20 - PlantN * 5;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  CN_active = 15 - MinN * 6;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  CN_slow = 20 - MinN * 4;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  CN_passive = 10 - MinN * 1.5;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">if</span>(PlantN &gt; 2) CN_surface = 10;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">/*   Here 2 is g m^-2 */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">if</span>(MinN &gt; 2){</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    CN_active = 3;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    CN_passive = 7;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    CN_slow = 12;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  SN1 = SC1 / CN_structural; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  SN2 = SC2 / CN_active;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  SN3 = SC3 / CN_structural;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  SN4 = SC4 / CN_active;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  SN5 = SC5 / CN_active;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  SN6 = SC6 / CN_active;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  SN7 = SC7 / CN_slow;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  SN8 = SC8 / CN_passive;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  SN9 = SC9 / CN_passive;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">/*  Need to calculate the effect of temperature and moisture. */</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  Abiot = <a class="code" href="_century_8c.html#a1061dc2ec428954d1e4fd2abd8e17957">AbiotEff</a>(smoist, stemp);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">/*    Calculate Fm and Lc separately for each component */</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  FmLc_Leaf = <a class="code" href="_century_8c.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a>(LeafL_Ln,LeafL_N);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  FmLc_Stem = <a class="code" href="_century_8c.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a>(StemL_Ln,StemL_N);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  FmLc_Root = <a class="code" href="_century_8c.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a>(RootL_Ln,RootL_N);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  FmLc_Rhiz = <a class="code" href="_century_8c.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a>(RhizL_Ln,RhizL_N);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">/*  Surface Metabolic Carbon */</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  SC2_Leaf = FmLc_Leaf.Fm * *LeafL;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  SC2_Stem = FmLc_Stem.Fm * *StemL;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">/*  Root Metabolic Carbon */</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  SC4_Root = FmLc_Root.Fm * *RootL;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  SC4_Rhiz = FmLc_Rhiz.Fm * *RhizL;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">/*  Surface Structural Carbon */</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  SC1_Leaf = (1 - FmLc_Leaf.Fm) * *LeafL;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  SC1_Stem = (1 - FmLc_Stem.Fm) * *StemL;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">/* Lignin content needs to be considered separately */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  SC1_Leaf_Ln = SC1_Leaf * LeafL_Ln;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  SC1_Stem_Ln = SC1_Stem * StemL_Ln;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  SC1_Leaf = SC1_Leaf - SC1_Leaf_Ln;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  SC1_Stem = SC1_Stem - SC1_Stem_Ln;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">/*  Root Structural Carbon */</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  SC3_Root = (1 - FmLc_Root.Fm) * *RootL;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  SC3_Rhiz = (1 - FmLc_Rhiz.Fm) * *RhizL;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">/* Lignin content needs to be considered separately */</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  SC3_Root_Ln = SC3_Root * RootL_Ln;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  SC3_Rhiz_Ln = SC3_Rhiz * RhizL_Ln;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  SC3_Root = SC3_Root - SC3_Root_Ln;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  SC3_Rhiz = SC3_Rhiz - SC3_Rhiz_Ln;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">/*    T is silt plus clay content </span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">    Ls is fraction of structural C that is lignin </span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">    Structural Surface Litter C to Surface Microbe C </span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">    1 =&gt; 5 </span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">    2 =&gt; 5 </span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">    dC1/dt = Ki * Lc * A * Ci </span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">    Leaf */</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  SC1_Leaf +=  0.3 * SC1;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  SC2_Leaf +=  0.3 * SC2;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  C1_5_Leaf = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC1_Leaf,CN_surface,Abiot,FmLc_Leaf.Lc,Tm,respC1_5,1,Ks);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  C2_5_Leaf = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC2_Leaf,CN_surface,Abiot,FmLc_Leaf.Lc,Tm,respC1_5,5,Ks);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">/*  Stem */</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  SC1_Stem = SC1_Stem + 0.7 * SC1;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  SC2_Stem = SC2_Stem + 0.7 * SC2;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  C1_5_Stem = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC1_Stem,CN_surface,Abiot,FmLc_Stem.Lc,Tm,respC2_5,1,Ks);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  C2_5_Stem = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC2_Stem,CN_surface,Abiot,FmLc_Stem.Lc,Tm,respC2_5,5,Ks);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  SC1_Leaf = C1_5_Leaf.SC;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  SC2_Leaf = C2_5_Leaf.SC;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  SC1_Stem = C1_5_Stem.SC;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  SC2_Stem = C2_5_Stem.SC;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; <span class="comment">/*   Adding the ligning content */</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  C1_7_Leaf_Ln = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC1_Leaf_Ln,CN_surface,Abiot,FmLc_Leaf.Lc,Tm,respC1_7,1,Ks);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  C1_7_Stem_Ln = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC1_Stem_Ln,CN_surface,Abiot,FmLc_Stem.Lc,Tm,respC1_7,1,Ks);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">/* Flow from SC1.lignin to SC7 */</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  SC7 += C1_7_Leaf_Ln.fC + C1_7_Stem_Ln.fC ;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">/*  Collect respiration */</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> = C1_5_Leaf.Resp + C2_5_Leaf.Resp +</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;         C1_5_Stem.Resp + C2_5_Stem.Resp +</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;         C1_7_Leaf_Ln.Resp + C1_7_Stem_Ln.Resp;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="comment">/*  Collect mineralized Nitrogen */</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  MinN += C1_5_Leaf.MinN + C2_5_Leaf.MinN +</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          C1_5_Stem.MinN + C2_5_Stem.MinN +</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;          C1_7_Leaf_Ln.MinN + C1_7_Stem_Ln.MinN;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">/*   Rprintf(&quot;MinN 1: %f \n&quot;,MinN); */</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">/*  Updating the Soil Carbon Pools 1 and 2  */</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  SC1 = C1_5_Leaf.SC + C1_5_Stem.SC + C1_7_Leaf_Ln.SC + C1_7_Stem_Ln.SC ;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  SC2 = C2_5_Leaf.SC + C2_5_Stem.SC ;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">/*  Updating the Nitrogen Carbon Pools 1 and 2 */</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  SN1 = SC1 / CN_structural + SN1;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  SN2 = SC2 / CN_surface + SN2;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">/*    Structural Root Litter C to Soil Microbe C */</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">/*    4 =&gt; 6 */</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">/*    3 =&gt; 6 */</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">/*    Root */</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  SC3_Root = SC3_Root + 0.3 * SC3;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  SC4_Root = SC4_Root + 0.3 * SC4;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  C3_6_Root = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC3_Root,CN_active,Abiot,FmLc_Root.Lc,Tm,respC3_6,2,Ks);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  C4_6_Root = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC4_Root,CN_active,Abiot,FmLc_Root.Lc,Tm,respC3_6,6,Ks);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">/*    Rhizome */</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  SC3_Rhiz = SC3_Rhiz + 0.7 * SC3;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  SC4_Rhiz = SC4_Rhiz + 0.7 * SC4;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  C3_6_Rhiz = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC3_Rhiz,CN_active,Abiot,FmLc_Rhiz.Lc,Tm,respC4_6,2,Ks);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  C4_6_Rhiz = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC4_Rhiz,CN_active,Abiot,FmLc_Rhiz.Lc,Tm,respC4_6,6,Ks);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  SC3_Root = C3_6_Root.SC;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  SC4_Root = C4_6_Root.SC;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  SC3_Rhiz = C3_6_Rhiz.SC;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  SC4_Rhiz = C4_6_Rhiz.SC;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  C3_7_Root_Ln = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC3_Root_Ln,CN_slow,Abiot,FmLc_Root.Lc,Tm,respC3_7,2,Ks);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  C3_7_Rhiz_Ln = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC3_Rhiz_Ln,CN_slow,Abiot,FmLc_Rhiz.Lc,Tm,respC3_7,2,Ks);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  SC7 += C3_7_Root_Ln.fC + C3_7_Rhiz_Ln.fC ; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; <span class="comment">/*   Collect respiration */</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> += C3_6_Root.Resp + C4_6_Root.Resp +</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;           C3_6_Rhiz.Resp + C4_6_Rhiz.Resp;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">/*    Collect mineralized Nitrogen */</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  MinN += C3_6_Root.MinN + C4_6_Root.MinN +</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;           C3_6_Rhiz.MinN + C4_6_Rhiz.MinN + </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;           C3_7_Root_Ln.MinN + C3_7_Rhiz_Ln.MinN;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">/*   Rprintf(&quot;MinN 2: %f \n&quot;,MinN); */</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">/*   Updating the Soil Carbon Pools 3 and 4 */</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  SC3 = C3_6_Root.SC + C3_6_Rhiz.SC + C3_7_Root_Ln.SC + C3_7_Rhiz_Ln.SC;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  SC4 = C4_6_Root.SC + C4_6_Rhiz.SC ;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">/*   Updating the Nitrogen pools 3 and 4 */</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  SN3 += SC3 / CN_structural ;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  SN4 += SC4 / CN_active ;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">/*    Updating the Soil Carbon Pool 5 */</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  SC5 += C1_5_Leaf.fC + C1_5_Stem.fC + C2_5_Leaf.fC + C2_5_Stem.fC ;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">/*    Updating the Soil Nitrogen pool 5 */</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  SN5 += SC5 / CN_surface ;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">/*    Updating the Soil Carbon Pool 6 */</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  SC6 += C3_6_Root.fC + C3_6_Rhiz.fC + C4_6_Root.fC + C4_6_Rhiz.fC ;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">/*    Updating the Soil Nitrogen Pool 6 */</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  SN6 += SC6 / CN_active ;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">/*    Surface Microbe C to Slow C */</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">/*    5 =&gt; 7 */</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  C5_7 = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC5,CN_slow,Abiot,0,0,respC5_7,4,Ks);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> +=  C5_7.Resp;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  MinN +=  C5_7.MinN;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">/*    Updating Surface Microbe C (pool 5) and slow (pool 7) */</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  SC5 = C5_7.SC ;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  SC7 += C5_7.fC ;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">/*    Updating Surface Microbe N pool */</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  SN5 = SC5 / CN_surface;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">/*   Soil Microbe C to intermediate stage C */</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  C6 = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC6,CN_slow,Abiot,0,Tm,respC6,3,Ks);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">/*   if(ISNAN(C6.fC) | ISNAN(C6.SC)){ */</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">/*     Rprintf(&quot;C6.fC %f and C6.SC %f and SC6 %f \n&quot;,C6.fC,C6.SC,SC6); */</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">/*   } */</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> +=  C6.Resp;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  MinN +=  C6.MinN;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">/*    Updating carbon and nitrogen soil pools 6 */</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  SC6 = C6.SC;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  SN6 = SC6 / CN_active;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  C_ap = 0.003 + 0.032 * Tc;   </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  C_al = leachWater / 18.0 * (0.01 + 0.04 * Ts);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">/*   Rprintf(&quot;C_al %f and C_ap %f Tc %f \n&quot;,C_al, C_ap, Tc); */</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">/*   Rprintf(&quot;leachWater %f and Ts %f \n&quot;,leachWater, Ts); */</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  C6_8 = C6.fC * C_ap;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  C6_9 = C6.fC * C_al;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  C6_7 = C6.fC * (1 - C_ap - C_al); <span class="comment">/* There is no need to subtract 0.55 since </span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">                                       this was already taken into account in </span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">                                       the flow equation */</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; <span class="comment">/*   Updating the Soil Carbon Pool 7, 8 and 9 */</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  SC7 += C6_7 ;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  SC8 += C6_8 ;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  SC9 += C6_9 ;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">/*   Rprintf(&quot;C6_9 %f \n&quot;,C6_9); */</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">/*  Updating the Soil Nitrogen Pool 7, 8 and 9 */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  SN7 += SC7 / CN_slow ;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  SN8 += SC8 / CN_passive ;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  SN9 += SC9 / CN_slow ;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">/*    Slow Carbon to intermediate stage */</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  C7 = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC7,CN_slow,Abiot,0,0,respC7,7,Ks);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> += C7.Resp;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  MinN += C7.MinN;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  C_sp = 0.003 - 0.009 *Tc;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  C7_8 = C7.fC * C_sp;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  C7_6 = C7.fC * (1 - C_sp);  <span class="comment">/* There is no need to subtract 0.55 since </span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">                                 this was already taken into account in </span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">                                 the flow equation */</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">/*    Updating the Soil Carbon Pools 6 and 8 */</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  SC6 += C7_6 ;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  SC8 += C7_8 ;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">/*    Updating the Soil Nitrogen Pools 6 and 8 */</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  SN6 = SC6 / CN_active;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  SN8 = SN8 / CN_passive;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">/*    Passive Carbon to Soil Microbe C */</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  C8_6 = <a class="code" href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC8,CN_passive,Abiot,0,0,respC8,8,Ks);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> += C8_6.Resp;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  MinN += C8_6.MinN;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">/*   Updating the Soil Microbe C 6 and 8 */</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  SC8 = C8_6.SC ;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  SC6 += C8_6.fC ;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  SN6 = SC6 / CN_active;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  SN8 = SC8 / CN_passive;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  tmp.SNs[0] = SN1 / cf;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  tmp.SNs[1] = SN2 / cf ;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  tmp.SNs[2] = SN3 / cf ;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  tmp.SNs[3] = SN4 / cf ;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  tmp.SNs[4] = SN5 / cf ;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  tmp.SNs[5] = SN6 / cf ;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  tmp.SNs[6] = SN7 / cf ;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  tmp.SNs[7] = SN8 / cf ;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  tmp.SNs[8] = SN9 / cf ;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  tmp.SCs[0] = SC1 / cf;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  tmp.SCs[1] = SC2 / cf;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  tmp.SCs[2] = SC3 / cf;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  tmp.SCs[3] = SC4 / cf;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  tmp.SCs[4] = SC5 / cf;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  tmp.SCs[5] = SC6 / cf;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  tmp.SCs[6] = SC7 / cf;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  tmp.SCs[7] = SC8 / cf;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  tmp.SCs[8] = SC9 / cf;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  tmp.MinN = <a class="code" href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">MinN</a>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  tmp.Resp = <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">/* Converting Leaf Litter to its original units */</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  *LeafL /= cf;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  *StemL /= cf;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  *RootL /= cf;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  *RhizL /= cf;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">return</span>(tmp);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;}</div>
<div class="ttc" id="_century_8c_html_a3f6a4f8b6e407fdca09efcebc32bf86c"><div class="ttname"><a href="_century_8c.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a></div><div class="ttdeci">struct flow_str flow(double *SC, double CNratio, double A, double Lc, double Tm, double resp, int kno, double Ks[8])</div><div class="ttdef"><b>Definition:</b> Century.c:523</div></div>
<div class="ttc" id="_century_8c_html_ab1f878344b2d2444f096bd0da2cb9f24"><div class="ttname"><a href="_century_8c.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a></div><div class="ttdeci">struct FL_str FmLcFun(double Lig, double Nit)</div><div class="ttdef"><b>Definition:</b> Century.c:496</div></div>
<div class="ttc" id="structflow__str_html_a92c1005f482e0f18892a6a94e72e4035"><div class="ttname"><a href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">flow_str::Resp</a></div><div class="ttdeci">double Resp</div><div class="ttdef"><b>Definition:</b> Century.h:26</div></div>
<div class="ttc" id="structsoil_text__str_html"><div class="ttname"><a href="structsoil_text__str.html">soilText_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:95</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a72f93049960e067cda6e7291ff1ff21a"><div class="ttname"><a href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a></div><div class="ttdeci">struct soilText_str soilTchoose(int soiltype)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1166</div></div>
<div class="ttc" id="_century_8c_html_a1061dc2ec428954d1e4fd2abd8e17957"><div class="ttname"><a href="_century_8c.html#a1061dc2ec428954d1e4fd2abd8e17957">AbiotEff</a></div><div class="ttdeci">double AbiotEff(double smoist, double stemp)</div><div class="ttdef"><b>Definition:</b> Century.c:570</div></div>
<div class="ttc" id="structcen_t__str_html"><div class="ttname"><a href="structcen_t__str.html">cenT_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:6</div></div>
<div class="ttc" id="structflow__str_html"><div class="ttname"><a href="structflow__str.html">flow_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:22</div></div>
<div class="ttc" id="structflow__str_html_a2e85af08e1b5ef823f43b8fea56f85d7"><div class="ttname"><a href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">flow_str::MinN</a></div><div class="ttdeci">double MinN</div><div class="ttdef"><b>Definition:</b> Century.h:27</div></div>
<div class="ttc" id="struct_f_l__str_html"><div class="ttname"><a href="struct_f_l__str.html">FL_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:15</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3f6a4f8b6e407fdca09efcebc32bf86c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structflow__str.html">flow_str</a> <a class="el" href="structflow.html">flow</a> </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CNratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Lc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ks</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                                                                                                    {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> tmp;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordtype">double</span> Kf = 0.0, <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> = 0.0;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a>, <a class="code" href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">MinN</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">if</span>(kno &lt; 3){</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    Kf = Ks[kno-1] * Lc * A ;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> = Kf * *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">if</span>(kno == 3){</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    Kf = Ks[kno-1] * A * Tm ;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> = Kf * *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordflow">if</span>(kno &gt; 3){</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    Kf = Ks[kno-1] * A;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> = Kf * *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">if</span>(Kf &gt; 1){</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    Rprintf(<span class="stringliteral">&quot;Kf greater than 1: %d %f %f %f %f \n&quot;</span>, kno, Ks[kno-1], Kf, A, Tm);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  Resp = <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> * <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">/*  Mineralized N */</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  MinN = Resp / CNratio;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a> = *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a> - <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  fC = fC - <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a>;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">/*   fN = fC / CNratio; */</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">/*  It is important to keep track of C emissions because */</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">/*  I might need to validate it against Eddy flux data */</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  tmp.SC = *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  tmp.fC = <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  tmp.Resp = <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  tmp.MinN = <a class="code" href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">MinN</a>;  </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="keywordflow">return</span>(tmp);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;}</div>
<div class="ttc" id="structflow__str_html_a043c2ff66146ae4fa8a898c8f7a44851"><div class="ttname"><a href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">flow_str::fC</a></div><div class="ttdeci">double fC</div><div class="ttdef"><b>Definition:</b> Century.h:25</div></div>
<div class="ttc" id="structflow__str_html_a92c1005f482e0f18892a6a94e72e4035"><div class="ttname"><a href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">flow_str::Resp</a></div><div class="ttdeci">double Resp</div><div class="ttdef"><b>Definition:</b> Century.h:26</div></div>
<div class="ttc" id="structflow__str_html_a343d51cd0d68eb7f2086dcdfa86bc58d"><div class="ttname"><a href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">flow_str::SC</a></div><div class="ttdeci">double SC</div><div class="ttdef"><b>Definition:</b> Century.h:24</div></div>
<div class="ttc" id="structflow__str_html"><div class="ttname"><a href="structflow__str.html">flow_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:22</div></div>
<div class="ttc" id="structflow__str_html_a2e85af08e1b5ef823f43b8fea56f85d7"><div class="ttname"><a href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">flow_str::MinN</a></div><div class="ttdeci">double MinN</div><div class="ttdef"><b>Definition:</b> Century.h:27</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_aeb35169469ef33705592a28743d105bf"><div class="ttname"><a href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a></div><div class="ttdeci">double resp(double comp, double mrc, double temp)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1024</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab1f878344b2d2444f096bd0da2cb9f24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_f_l__str.html">FL_str</a> FmLcFun </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Lig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Nit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                             {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordtype">double</span> Fm, Ls, Lc;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_f_l__str.html">FL_str</a> tmp;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  Fm = 0.85 - 0.018 *(Lig/Nit);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  Ls = Lig / (1 - <a class="code" href="struct_f_l__str.html#af757219617ae5633c84861a6d551e50e">Fm</a>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  Lc = exp(-3 * Ls);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  tmp.Lc = <a class="code" href="struct_f_l__str.html#a50ae8acc43740fd17ffe08b69140dea7">Lc</a>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  tmp.Fm = <a class="code" href="struct_f_l__str.html#af757219617ae5633c84861a6d551e50e">Fm</a>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordflow">return</span>(tmp);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;}</div>
<div class="ttc" id="struct_f_l__str_html_af757219617ae5633c84861a6d551e50e"><div class="ttname"><a href="struct_f_l__str.html#af757219617ae5633c84861a6d551e50e">FL_str::Fm</a></div><div class="ttdeci">double Fm</div><div class="ttdef"><b>Definition:</b> Century.h:17</div></div>
<div class="ttc" id="struct_f_l__str_html_a50ae8acc43740fd17ffe08b69140dea7"><div class="ttname"><a href="struct_f_l__str.html#a50ae8acc43740fd17ffe08b69140dea7">FL_str::Lc</a></div><div class="ttdeci">double Lc</div><div class="ttdef"><b>Definition:</b> Century.h:18</div></div>
<div class="ttc" id="struct_f_l__str_html"><div class="ttname"><a href="struct_f_l__str.html">FL_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:15</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a46827eb56108821fe82228553f535293"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lightME </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>td</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[];</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keywordtype">double</span> *ip1;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        ip1 = &amp;tmp1[0];</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keywordtype">double</span> omega, delta0, delta, deltaR;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keywordtype">double</span> tf, SSin, CCos, PPo;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="keywordtype">double</span> CosZenithAngle, CosHour;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="keywordtype">double</span> CosHourDeg;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="keywordtype">double</span> Idir, Idiff, propIdir, propIdiff;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> DTR = <a class="code" href="denitrify_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> tsn = 12.0;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = 0.85;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> SolarConstant = 2650;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> atmP = 1e5;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        omega = lat * DTR;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        delta0 = 360.0 * ((DOY + 10)/365.0);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        delta = -23.5 * cos(delta0*DTR);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        deltaR = delta * DTR;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        tf = (15.0*(td - tsn))*DTR;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        SSin = sin(deltaR) * sin(omega);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        CCos = cos(deltaR) * cos(omega);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        CosZenithAngle = SSin + CCos * cos(tf);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">if</span>(CosZenithAngle &lt; pow(10,-10))</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                CosZenithAngle = pow(10,-10);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        CosHour = -tan(omega) * tan(deltaR);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        CosHourDeg = (1/DTR)*CosHour;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">if</span>(CosHourDeg &lt; -57)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                CosHour = -0.994;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        PPo = 1e5 / atmP;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        Idir = SolarConstant * (pow(alpha,(PPo/CosZenithAngle)));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        Idiff = 0.3 * SolarConstant *(1 - pow(alpha,(PPo/CosZenithAngle))) * CosZenithAngle ;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        propIdir = Idir / (Idir + Idiff);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        propIdiff = Idiff / (Idir + Idiff);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        *ip1 = propIdir;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        *(ip1+1) = propIdiff;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        *(ip1+2) = CosZenithAngle;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div>
<div class="ttc" id="_aux_bio_cro_8h_html_aab252cacb5d92c011d673d2db55cba0d"><div class="ttname"><a href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a></div><div class="ttdeci">double tmp1[3]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:21</div></div>
<div class="ttc" id="denitrify_8c_html_ae71449b1cc6e6250b91f539153a7a0d3"><div class="ttname"><a href="denitrify_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a></div><div class="ttdeci">#define M_PI</div><div class="ttdef"><b>Definition:</b> denitrify.c:139</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5a18f68430b9e6ed1be3d294b179f8a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_can___str.html">Can_Str</a> newc3CanAC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>o2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aeb35169469ef33705592a28743d105bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double resp </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                                                 {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <span class="keywordtype">double</span> ans;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        ans = comp *  (1 - (mrc * pow(2,(temp/10.0))));</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">if</span>(ans &lt;0) ans = 0;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <span class="keywordflow">return</span>(ans);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a247148ac54cf7d8c851326de6093b71e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RHprof </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;{</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordtype">double</span> kh, hsla, j;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        kh = 1 - RH;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="comment">/* kh = 0.2; */</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="comment">/*kh = log(1/RH);*/</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                j = i + 1;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                hsla = RH * exp(kh * (j/nlayers));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">//              /*hsla = RH * exp(-kh * (j/nlayers));  /*new simpler version from Joe Iverson*/</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="keywordflow">if</span>(hsla &gt; 1) hsla = 0.99; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>[<a class="code" href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a>++] = hsla;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">/* It should return values in the 0-1 range */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div>
<div class="ttc" id="_aux_bio_cro_8h_html_acfad88ff5207b2ab57fc1dca17271065"><div class="ttname"><a href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a></div><div class="ttdeci">double tmp4[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:29</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a36e4d9011835445995335074adedad9a"><div class="ttname"><a href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a></div><div class="ttdeci">int tp4</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:19</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9e38198cf133d59230f6d1f6beac12bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double RSS_BG </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oStem</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oLeaf</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oRhizome</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oRoot</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oGrain</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oLAI</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sStem</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sLeaf</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sRhizome</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sRoot</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sGrain</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sLAI</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N1Dat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                        {</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        <span class="keywordtype">double</span> diff1=0.0, RSS1=0.0, SST1=0.0;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        <span class="keywordtype">double</span> diff2=0.0, RSS2=0.0, SST2=0.0;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        <span class="keywordtype">double</span> diff3=0.0, RSS3=0.0, SST3=0.0;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        <span class="keywordtype">double</span> diff4=0.0, RSS4=0.0, SST4=0.0; </div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        <span class="keywordtype">double</span> diff5=0.0, RSS5=0.0, SST5=0.0;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <span class="keywordtype">double</span> diff6=0.0, RSS6=0.0, SST6=0.0;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        <span class="keywordtype">double</span> RSS=0.0;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <span class="keywordflow">for</span>(i = 0 ; i &lt; N1Dat; i++){</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                <span class="comment">/* Stem */</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                <span class="keywordflow">if</span>(oStem[i] &gt;= 0){</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                        SST1 += pow(oStem[i],2);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                        diff1 = oStem[i] - sStem[i];</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                        RSS1 += pow(diff1,2);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                }</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                <span class="comment">/* Leaf */</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                <span class="keywordflow">if</span>(oLeaf[i] &gt;= 0){</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                        SST2 += pow(oLeaf[i],2);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                        diff2 = oLeaf[i] - sLeaf[i];</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                        RSS2 += pow(diff2,2);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                }</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                <span class="comment">/* Rhizome */</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                <span class="keywordflow">if</span>(oRhizome[i] &gt;= 0){</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                        SST3 += pow(oRhizome[i],2);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                        diff3 = oRhizome[i] - sRhizome[i];</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                        RSS3 += pow(diff3,2);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                <span class="comment">/* Root */</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                <span class="keywordflow">if</span>(oRoot[i] &gt;= 0){</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                        SST4 += pow(oRoot[i],2);</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                        diff4 = oRoot[i] - sRoot[i];</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                        RSS4 += pow(diff4,2);</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                <span class="comment">/* LAI */</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                <span class="keywordflow">if</span>(oLAI[i] &gt;= 0){</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                        SST5 += pow(oLAI[i],2);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                        diff5 = oLAI[i] - sLAI[i];</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                        RSS5 += pow(diff5,2);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                <span class="keywordflow">if</span>(oGrain[i] &gt;= 0){</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                        SST6 += pow(oGrain[i],2);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                        diff6 = oGrain[i] - sGrain[i];</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                        RSS6 += pow(diff6,2);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                }</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        RSS = RSS1 + RSS2 + RSS3 + RSS4 + RSS5 + RSS6;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="keywordflow">return</span>(RSS);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4dc70ed4086616dabcbc7565d36d247b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdbp__str.html">dbp_str</a> sel_dbp_coef </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>coefs</em>[25], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TherPrds</em>[6], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TherTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                                                                                  {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="keyword">struct </span><a class="code" href="structdbp__str.html">dbp_str</a> tmp;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        tmp.<a class="code" href="structdbp__str.html#ac99cccaa39474eb44da7927824bf1590">kLeaf</a> = 0.0;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        tmp.kStem = 0.0;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        tmp.kRoot = 0.0;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        tmp.kRhiz = 0.0;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        tmp.kGrain = 0.0; <span class="comment">/* kGrain is always zero except for the last thermal period */</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="keywordflow">if</span>(TherTime &lt; TherPrds[0])</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                tmp.kStem = coefs[0];</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                tmp.kLeaf = coefs[1];</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                tmp.kRoot = coefs[2];</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                tmp.kRhiz = coefs[3];</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                <span class="keywordflow">if</span>( TherTime &lt; TherPrds[1] )</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                        tmp.kStem = coefs[4];</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                        tmp.kLeaf = coefs[5];</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                        tmp.kRoot = coefs[6];</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                        tmp.kRhiz = coefs[7];</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                        <span class="keywordflow">if</span>( TherTime &lt; TherPrds[2])</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                        {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                                tmp.kStem = coefs[8];</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                                tmp.kLeaf = coefs[9];</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                tmp.kRoot = coefs[10];</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                                tmp.kRhiz = coefs[11];</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                        } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                                <span class="keywordflow">if</span>(TherTime &lt; TherPrds[3])</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                                {</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                                        tmp.kStem = coefs[12];</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                                        tmp.kLeaf = coefs[13];</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                                        tmp.kRoot = coefs[14];</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                                        tmp.kRhiz = coefs[15];</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                                } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                                        <span class="keywordflow">if</span>(TherTime &lt; TherPrds[4])</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                                        {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                                                tmp.kStem = coefs[16];</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                                                tmp.kLeaf = coefs[17];</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                                                tmp.kRoot = coefs[18];</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                                                tmp.kRhiz = coefs[19];</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                                        } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                                                </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                                        tmp.kStem = coefs[20];</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                                                        tmp.kLeaf = coefs[21];</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                                                        tmp.kRoot = coefs[22];</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                                                        tmp.kRhiz = coefs[23];</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                                                        tmp.kGrain = coefs[24];</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                                                </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                                                }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="keywordflow">return</span>(tmp);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;}</div>
<div class="ttc" id="structdbp__str_html"><div class="ttname"><a href="structdbp__str.html">dbp_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:85</div></div>
<div class="ttc" id="structdbp__str_html_ac99cccaa39474eb44da7927824bf1590"><div class="ttname"><a href="structdbp__str.html#ac99cccaa39474eb44da7927824bf1590">dbp_str::kLeaf</a></div><div class="ttdeci">double kLeaf</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:87</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a054d5ae3a62e6217a0d4e5093b79bb25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sel_phen </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>phen</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                         {</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        <span class="keywordtype">double</span> index = 0;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;        <span class="keywordflow">if</span>(phen == 6){</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                index = runif(20,25);</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;        }<span class="keywordflow">else</span> </div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;         <span class="keywordflow">if</span>(phen == 5){</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                 index = runif(16,20);</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;         }<span class="keywordflow">else</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;          <span class="keywordflow">if</span>(phen == 4){</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                  index = runif(12,16);</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;          }<span class="keywordflow">else</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;           <span class="keywordflow">if</span>(phen == 3){</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                   index = runif(8,12);</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;           }<span class="keywordflow">else</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;            <span class="keywordflow">if</span>(phen == 2){</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                    index = runif(4,8);</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;            }<span class="keywordflow">else</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;             <span class="keywordflow">if</span>(phen == 1){</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                     index = runif(0,4);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;             }</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        <span class="keywordflow">return</span>(index);</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1ac23d61d399453a3837e85128f04b6f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SoilEvapo </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>AirTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>DirectRad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>awc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fieldc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiltp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>winds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                                                                                  {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keywordtype">double</span> SoilArea;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordtype">double</span> SoilTemp;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordtype">double</span> Up; <span class="comment">/*Maximum Dimensionless Uptake Rate */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordtype">double</span> TotalRadiation;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordtype">double</span> BoundaryLayerThickness, DiffCoef;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordtype">double</span> SoilBoundaryLayer, Ja, rlc;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keywordtype">double</span> PhiN, PsycParam, DeltaPVa;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordtype">double</span> Evaporation = 0.0;  </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordtype">double</span> DdryA, LHV, SlopeFS, SWVC;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordtype">double</span> rawc; <span class="comment">/* Relative available water content */</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordtype">int</span> method = 1;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment">/* some constants */</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> SoilClodSize = 0.04;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> SoilReflectance = 0.2;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> SoilTransmission = 0.01;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> SpecificHeat = 1010;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> StefanBoltzman = 5.67e-8; <span class="comment">/* Stefan Boltzman Constant */</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="comment">/* For Transpiration */</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">/* 1e-3 converts mili mols to mols */</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="comment">/* 18 is the grams in one mol of H20 */</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">/* Let us assume a simple way of calculating the proportion of the</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">           soil with direct radiation */</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        SoilArea = exp(-k * LAI);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="comment">/* For now the temperature of the soil will be the same as the air.</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">           At a later time this can be made more accurate. I looked at the</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">           equations for this and the issue is that it is strongly dependent on</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">           depth. Since the soil model now has a single layer, this cannot be</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">           implemented correctly at the moment.  */</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        SoilTemp = AirTemp;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment">/* Let us use an idea of Campbell and Norman. Environmental</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">           Biophysics. */</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="comment">/* If relative available water content is */</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        rawc = (awc - wiltp)/(fieldc - wiltp);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="comment">/* Page 142 */</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="comment">/* Maximum Dimensionless Uptake Rate */</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        Up = 1 - pow((1 + 1.3 * rawc),-5);  </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="comment">/* This is a useful idea because dry soils evaporate little water when dry*/</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="comment">/* Total Radiation */</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="comment">/*&#39; Convert light assuming 1 µmol PAR photons = 0.235 J/s Watts*/</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="comment">/* At the moment soil evaporation is grossly overestimated. In WIMOVAC</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">           the light reaching the last layer of leaves is used. Here instead</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">           of calculating this again, I will for now assume a 10% as a rough</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">           estimate. Note that I could maybe get this since layIdir and</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">           layIDiff in sunML are external variables.  Rprintf(&quot;IRad</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">           %.5f&quot;,layIdir[0],&quot;\n&quot;); Update: 03-13-2009. I tried printing this</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">           value but it is still too high and will likely overestimate soil</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">           evaporation. However, this is still a work in progress.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        IRad *= rsec; <span class="comment">/* Radiation soil evaporation coefficient */</span> </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        TotalRadiation = IRad * 0.235;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        DdryA = <a class="code" href="_aux_bio_cro_8c.html#aef4a29370ba3b33794837905d82f3b86">TempToDdryA</a>(AirTemp) ;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        LHV = <a class="code" href="_aux_bio_cro_8c.html#abea4623ebab0e4ea7d9be5af1fd80344">TempToLHV</a>(AirTemp) * 1e6 ; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">/* Here LHV is given in MJ kg-1 and this needs to be converted</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">   to Joules kg-1  */</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        SlopeFS = <a class="code" href="_aux_bio_cro_8c.html#abd35797ea11e52f0c527d40a9c1c0b7d">TempToSFS</a>(AirTemp) * 1e-3;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        SWVC = <a class="code" href="_aux_bio_cro_8c.html#a2b62fa0d37af87f9af219e7b0d56f34d">TempToSWVC</a>(AirTemp) * 1e-3;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        PsycParam = (DdryA * SpecificHeat) / LHV;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        DeltaPVa = SWVC * (1 - RelH / 100);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        BoundaryLayerThickness = 4e-3 * sqrt(SoilClodSize / winds); </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        DiffCoef = 2.126e-5 * 1.48e-7 * SoilTemp;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        SoilBoundaryLayer = DiffCoef / BoundaryLayerThickness;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        Ja = 2 * TotalRadiation * ((1 - SoilReflectance - SoilTransmission) / (1 - SoilTransmission));</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        rlc = 4 * StefanBoltzman * pow((273 + SoilTemp),3) * 0.005;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">/* the last term should be the difference between air temperature and</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">   soil. This is not actually calculated at the moment. Since this is</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">   mostly relevant to the first soil layer where the temperatures are</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">   similar. I will leave it like this for now. */</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        PhiN = Ja - rlc; <span class="comment">/* Calculate the net radiation balance*/</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">if</span>(PhiN &lt; 0) PhiN = 1e-7;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="comment">/* Priestly-Taylor */</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordflow">if</span>(method == 0){</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                Evaporation = 1.26 * (SlopeFS * PhiN) / (LHV * (SlopeFS + PsycParam));</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                <span class="comment">/* Penman-Monteith */</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                Evaporation = (SlopeFS * PhiN + LHV * PsycParam * SoilBoundaryLayer * DeltaPVa) / (LHV * (SlopeFS + PsycParam));</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">/*  Report back the soil evaporation rate in Units mmoles/m2/s */</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">/*     Evaporation = Evaporation * 1000:   &#39; Convert Kg H20/m2/s to g H20/m2/s */</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">/*     Evaporation = Evaporation / 18:     &#39; Convert g H20/m2/s to moles H20/m2/s */</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">/*     Evaporation = Evaporation * 1000:   &#39; Convert moles H20/m2/s to mmoles H20/m2/s */</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">/*     If Evaporation &lt;= 0 Then Evaporation = 0.00001: </span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">       &#39; Prevent any odd looking values which might get through at very low light levels */</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        Evaporation *= 1e6/18;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="comment">/* Adding the area dependence and the effect of drying */</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="comment">/* Converting from m2 to ha (times 1e4) */</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="comment">/* Converting to hour */</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        Evaporation *= SoilArea * Up * cf2; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">if</span>(Evaporation &lt; 0) Evaporation = 1e-6;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">return</span>(Evaporation);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;}</div>
<div class="ttc" id="_aux_bio_cro_8c_html_aef4a29370ba3b33794837905d82f3b86"><div class="ttname"><a href="_aux_bio_cro_8c.html#aef4a29370ba3b33794837905d82f3b86">TempToDdryA</a></div><div class="ttdeci">double TempToDdryA(double Temp)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:179</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_abd35797ea11e52f0c527d40a9c1c0b7d"><div class="ttname"><a href="_aux_bio_cro_8c.html#abd35797ea11e52f0c527d40a9c1c0b7d">TempToSFS</a></div><div class="ttdeci">double TempToSFS(double Temp)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:193</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a2b62fa0d37af87f9af219e7b0d56f34d"><div class="ttname"><a href="_aux_bio_cro_8c.html#a2b62fa0d37af87f9af219e7b0d56f34d">TempToSWVC</a></div><div class="ttdeci">double TempToSWVC(double Temp)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:200</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_abea4623ebab0e4ea7d9be5af1fd80344"><div class="ttname"><a href="_aux_bio_cro_8c.html#abea4623ebab0e4ea7d9be5af1fd80344">TempToLHV</a></div><div class="ttdeci">double TempToLHV(double Temp)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:186</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5537e2a57efaaf41b401666bb9e22062"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsoil_m_l__str.html">soilML_str</a> soilML </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precipit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soildepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>depths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fieldc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiltp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsoil_text__str.html">soilText_str</a>&#160;</td>
          <td class="paramname"><em>soTexS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wsFun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rootDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>AirTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>IRad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>winds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hydrDist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsdf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                                                                                                                                                                                                                                                                                                                                                                  {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keyword">struct </span><a class="code" href="structrd__str.html">rd_str</a> <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="keyword">struct </span><a class="code" href="structseq_r_d__str.html">seqRD_str</a> <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keyword">struct </span><a class="code" href="structsoil_m_l__str.html">soilML_str</a> tmp;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="comment">/* Constant */</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="comment">/* const double G = 6.67428e-11;  m3 / (kg * s-2)  ##  http://en.wikipedia.org/wiki/Gravitational_constant */</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> g = 9.8; <span class="comment">/* m / s-2  ##  http://en.wikipedia.org/wiki/Standard_gravity */</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="comment">/* Variables */</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="keywordtype">double</span> waterIn, oldWaterIn = 0.0;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">/* Here is a convention aw is available water in volume and awc</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">   is available water content as a fraction of the soil section being investigated.</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">   paw is plant available water aw - wiltp */</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="keywordtype">double</span> aw, paw, awc, awc2, Newpawha;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">drainage</a> = 0.0;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keywordtype">double</span> wsPhoto = 0.0, wsSpleaf = 0.0, phi10;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keywordtype">double</span> wsPhotoCol = 0.0, wsSpleafCol = 0.0;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keywordtype">double</span> slp = 0.0, intcpt = 0.0, theta = 0.0; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">Nleach</a> = 0.0;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keywordtype">double</span> layerDepth;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="keywordtype">double</span> diffw;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordtype">double</span> rootATdepth, rootDepth;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="keywordtype">double</span> EvapoTra = 0.0, oldEvapoTra = 0.0, Sevap = 0.0, Ctransp = 0.0;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordtype">double</span> psim1 = 0.0, psim2 = 0.0, K_psim = 0.0, J_w = 0.0, dPsim = 0.0;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keywordtype">double</span> theta_s; <span class="comment">/* This is the saturated soil water content. Larger than FieldC.*/</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="keywordtype">int</span> j = layers - 1; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">/* Specify the soil type */</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> &lt; 0){</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                <a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> = soTexS.<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keywordflow">if</span>(wiltp &lt; 0){</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                wiltp = soTexS.<a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        theta_s = soTexS.<a class="code" href="structsoil_text__str.html#ac769b10536dd94d3652ad1cbf8d58482">satur</a>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="comment">/* rooting depth */</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="comment">/* Crude empirical relationship between root biomass and rooting depth*/</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        rootDepth = rootDB * rsdf;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordflow">if</span>(rootDepth &gt; soildepth) rootDepth = soildepth;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a> = <a class="code" href="_aux_bio_cro_8c.html#a668682ce55f6888ab3ec44a7d7a48d07">seqRootDepth</a>(rootDepth,layers);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a> = <a class="code" href="_aux_bio_cro_8c.html#a76d97071934ef506589d0ca8114d3647">rootDist</a>(layers,rootDepth,&amp;depths[0],rfl);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="comment">/* unit conversion for precip */</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        waterIn = precipit * 1e-3; <span class="comment">/* convert precip in mm to m*/</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordflow">for</span>(j=0,i=layers-1;j&lt;layers;j++,i--){</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="comment">/* for(i=0;i&lt;layers;i++){ */</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                <span class="comment">/* It decreases because I increase the water content due to precipitation in the last layer first*/</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                <span class="comment">/* This supports unequal depths. */</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                <span class="keywordflow">if</span>(i == 0){</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                        layerDepth = depths[1];</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                        layerDepth = depths[i] - depths[i-1];</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                <span class="keywordflow">if</span>(hydrDist &gt; 0){</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                        <span class="comment">/* For this section see Campbell and Norman &quot;Environmental BioPhysics&quot; Chapter 9*/</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                        <span class="comment">/* First compute the matric potential */</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                        psim1 = soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a> * pow((<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i]/theta_s),-soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>) ; <span class="comment">/* This is matric potential of current layer */</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                        <span class="keywordflow">if</span>(i &gt; 0){</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                                psim2 = soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a> * pow((<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i-1]/theta_s),-soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>) ; <span class="comment">/* This is matric potential of next layer */</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                                dPsim = psim1 - psim2;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                <span class="comment">/* The substraction is from the layer i - (i-1). If this last term is positive then it will move upwards. If it is negative it will move downwards. Presumably this term is almost always positive. */</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                                dPsim = 0;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                        }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                        K_psim = soTexS.<a class="code" href="structsoil_text__str.html#aa9437b51e97937d66bd2c90f9a411652">Ks</a> * pow((soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a>/psim1),2+3/soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>); <span class="comment">/* This is hydraulic conductivity */</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                        J_w = K_psim * (dPsim/layerDepth) - g * K_psim ; <span class="comment">/*  Campbell, pg 129 do not ignore the graviational effect*/</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                        <span class="comment">/* Notice that K_psim is positive because my</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">                            reference system is reversed */</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                        <span class="comment">/* This last result should be in kg/(m2 * s)*/</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                         J_w *= 3600 * 0.9882 * 1e-3 ; <span class="comment">/* This is flow in m3 / (m^2 * hr). */</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                        <span class="comment">/* Rprintf(&quot;J_w %.10f \n&quot;,J_w);  */</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                        <span class="keywordflow">if</span>(i == (layers-1) &amp;&amp; J_w &lt; 0){</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                                        <span class="comment">/* cws[i] = cws[i] + J_w /</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">                                         * layerDepth; Although this</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">                                         * should be done it drains</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">                                         * the last layer too much.*/</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                                        drainage += J_w;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                                <span class="keywordflow">if</span>(i &gt; 0){</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] -  J_w / layerDepth;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i - 1] =  <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i-1] +  J_w / layerDepth;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] -  J_w / layerDepth;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                                }</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                        }</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                 <span class="keywordflow">if</span>(<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] &gt; theta_s) <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = theta_s; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                <span class="comment">/* if(cws[i+1] &gt; fieldc) cws[i+1] = fieldc; */</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                 <span class="keywordflow">if</span>(<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] &lt; wiltp) <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = wiltp; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                <span class="comment">/* if(cws[i+1] &lt; wiltp) cws[i+1] = wiltp;  */</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                aw = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] * layerDepth;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">/* Available water (for this layer) is the current water status times the layer depth */</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                <span class="keywordflow">if</span>(waterIn &gt; 0){</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                        <span class="comment">/* There is some rain. Need to add it.*/</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                        aw += waterIn / layers + oldWaterIn; <span class="comment">/* They are both in meters so it works */</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                        <span class="comment">/* Adding the same amount to water to each layer */</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                        <span class="comment">/* In case there is overflow */</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                        diffw = <a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> * layerDepth - aw;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                        <span class="keywordflow">if</span>(diffw &lt; 0){</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                                <span class="comment">/* This means that precipitation exceeded the capacity of the first layer */</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                                <span class="comment">/* Save this amount of water for the next layer */</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                                oldWaterIn = -diffw;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                aw = <a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> * layerDepth;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                oldWaterIn = 0.0;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                        }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                <span class="comment">/* Root Biomass */</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                rootATdepth = rootDB * <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[i];</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                tmp.rootDist[i] = rootATdepth;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">/* Plant available water is only between current water status and permanent wilting point */</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                <span class="comment">/* Plant available water */</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                paw = aw - wiltp * layerDepth;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                <span class="keywordflow">if</span>(paw &lt; 0) paw = 0; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                <span class="keywordflow">if</span>(i == 0){</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                        <span class="comment">/* Only the first layer is affected by soil evaporation */</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                        awc2 = aw / layerDepth;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                        <span class="comment">/* SoilEvapo function needs soil water content  */</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                        Sevap = <a class="code" href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a>(LAI,k,AirTemp,IRad,awc2,<a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a>,wiltp,winds,RelH,rsec);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                        <span class="comment">/* I assume that crop transpiration is distributed simlarly to</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">                           root density.  In other words the crop takes up water proportionally</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">                           to the amount of root in each respective layer.*/</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                        Ctransp = transp*<a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[0];</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                        EvapoTra = Ctransp + Sevap;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                        Newpawha = (paw * 1e4) - EvapoTra / 0.9982; <span class="comment">/* See the watstr function for this last number 0.9882 */</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                        <span class="comment">/* The first term in the rhs (paw * 1e4) is the m3 of water available in this layer.</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">                           EvapoTra is the Mg H2O ha-1 of transpired and evaporated water. 1/0.9882 converts from Mg to m3 */</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                        Ctransp = transp*<a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[i];</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                        EvapoTra = Ctransp;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                        Newpawha = (paw * 1e4) - (EvapoTra + oldEvapoTra);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                <span class="keywordflow">if</span>(Newpawha &lt; 0){</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">/* If the Demand is not satisfied by this layer. This will be stored and added to subsequent layers*/</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                        oldEvapoTra = -Newpawha;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                         aw = wiltp * layerDepth; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                }</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                paw = Newpawha / 1e4 ;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                awc = paw / layerDepth + wiltp;   </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">/* This might look like a weird place to populate the structure, but is more convenient*/</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                tmp.cws[i] = awc;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                tmp.hourlyWflux[i] =J_w;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                <span class="keywordflow">if</span>(wsFun == 0){</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                        slp = 1/(<a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> - wiltp);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                        intcpt = 1 - <a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> * slp;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                        wsPhoto = slp * awc + intcpt ;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                <span class="keywordflow">if</span>(wsFun == 1){</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                        phi10 = (<a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> + wiltp)/2;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                        wsPhoto = 1/(1 + exp((phi10 - awc)/ phi1));</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                <span class="keywordflow">if</span>(wsFun == 2){</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                        slp = (1 - wiltp)/(<a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> - wiltp);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                        intcpt = 1 - <a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> * slp;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                        theta = slp * awc + intcpt ;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                        wsPhoto = (1 - exp(-2.5 * (theta - wiltp)/(1 - wiltp))) / (1 - exp(-2.5));</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                <span class="keywordflow">if</span>(wsFun == 3){</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                        wsPhoto = 1;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                <span class="keywordflow">if</span>(wsPhoto &lt;= 0 )</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                        wsPhoto = 1e-20; <span class="comment">/* This can be mathematically lower than zero in some cases but I should prevent that. */</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                wsPhotoCol += wsPhoto;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                wsSpleaf = pow(awc,phi2) * 1/pow(<a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a>,phi2); </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                <span class="keywordflow">if</span>(wsFun == 3){ </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                        wsSpleaf = 1;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                wsSpleafCol += wsSpleaf;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        }</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="keywordflow">if</span>(waterIn &gt; 0){ </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                drainage = waterIn;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                <span class="comment">/* Need to convert to units used in the Parton et al 1988 paper. */</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                <span class="comment">/* The data comes in mm/hr and it needs to be in cm/month */</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                Nleach = drainage * 0.1 * (1/24*30) / (18 * (0.2 + 0.7 * soTexS.<a class="code" href="structsoil_text__str.html#a4fcef85764276271df64bd49ff7667fb">sand</a>));</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">/* Apparently wsPhoto and wsSpleaf can be greater than 1 */</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="keywordflow">if</span>(wsPhoto &gt; 1) wsPhoto = 1;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keywordflow">if</span>(wsSpleaf &gt; 1) wsSpleaf = 1;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">/* returning the structure */</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        tmp.rcoefPhoto = (wsPhotoCol/layers);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        tmp.drainage = <a class="code" href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">drainage</a>;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        tmp.Nleach = <a class="code" href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">Nleach</a>;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        tmp.rcoefSpleaf = (wsSpleafCol/layers);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        tmp.SoilEvapo = Sevap;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <span class="keywordflow">return</span>(tmp);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;}</div>
<div class="ttc" id="structsoil_text__str_html_aa9437b51e97937d66bd2c90f9a411652"><div class="ttname"><a href="structsoil_text__str.html#aa9437b51e97937d66bd2c90f9a411652">soilText_str::Ks</a></div><div class="ttdeci">double Ks</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:102</div></div>
<div class="ttc" id="structsoil_m_l__str_html_a6b156f63a9c5f2185dcb004e85518998"><div class="ttname"><a href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">soilML_str::drainage</a></div><div class="ttdeci">double drainage</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:64</div></div>
<div class="ttc" id="structsoil_m_l__str_html_a9da7a4e25e646b0be31ac3bbec73f60d"><div class="ttname"><a href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">soilML_str::cws</a></div><div class="ttdeci">double cws[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:63</div></div>
<div class="ttc" id="structsoil_text__str_html_a6ee087ca614bcf981839ca4e28953fb2"><div class="ttname"><a href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">soilText_str::wiltp</a></div><div class="ttdeci">double wiltp</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:105</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_acfad88ff5207b2ab57fc1dca17271065"><div class="ttname"><a href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a></div><div class="ttdeci">double tmp4[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:29</div></div>
<div class="ttc" id="structseq_r_d__str_html"><div class="ttname"><a href="structseq_r_d__str.html">seqRD_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:112</div></div>
<div class="ttc" id="structsoil_m_l__str_html_a822b315fe3e59dff737cb334f7f58c15"><div class="ttname"><a href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">soilML_str::fieldc</a></div><div class="ttdeci">double fieldc[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:74</div></div>
<div class="ttc" id="structsoil_m_l__str_html"><div class="ttname"><a href="structsoil_m_l__str.html">soilML_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:59</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a76d97071934ef506589d0ca8114d3647"><div class="ttname"><a href="_aux_bio_cro_8c.html#a76d97071934ef506589d0ca8114d3647">rootDist</a></div><div class="ttdeci">struct rd_str rootDist(int layer, double rootDepth, double *depthsp, double rfl)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1123</div></div>
<div class="ttc" id="structrd__str_html"><div class="ttname"><a href="structrd__str.html">rd_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:120</div></div>
<div class="ttc" id="structsoil_text__str_html_aa1f62c6a0dfe9f9d7abfd52a756209bf"><div class="ttname"><a href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">soilText_str::fieldc</a></div><div class="ttdeci">double fieldc</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:104</div></div>
<div class="ttc" id="structsoil_text__str_html_a4fcef85764276271df64bd49ff7667fb"><div class="ttname"><a href="structsoil_text__str.html#a4fcef85764276271df64bd49ff7667fb">soilText_str::sand</a></div><div class="ttdeci">double sand</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:99</div></div>
<div class="ttc" id="structsoil_m_l__str_html_a26953bee326ec08f079e24838fc8feb6"><div class="ttname"><a href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">soilML_str::Nleach</a></div><div class="ttdeci">double Nleach</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:65</div></div>
<div class="ttc" id="structsoil_text__str_html_accd3edb0af25e0499d5ffbfacc2af59c"><div class="ttname"><a href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">soilText_str::air_entry</a></div><div class="ttdeci">double air_entry</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:100</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_ac96acf762dd39d5ff20d71788b0ca566"><div class="ttname"><a href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a></div><div class="ttdeci">double SoilEvapo(double LAI, double k, double AirTemp, double IRad, double awc, double fieldc, double wiltp, double winds, double RelH, double rsec)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:412</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a15219c620f8cdf6d8cf731e485e2c668"><div class="ttname"><a href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a></div><div class="ttdeci">double tmp3[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:28</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a668682ce55f6888ab3ec44a7d7a48d07"><div class="ttname"><a href="_aux_bio_cro_8c.html#a668682ce55f6888ab3ec44a7d7a48d07">seqRootDepth</a></div><div class="ttdeci">struct seqRD_str seqRootDepth(double to, int lengthOut)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1103</div></div>
<div class="ttc" id="structsoil_text__str_html_ac769b10536dd94d3652ad1cbf8d58482"><div class="ttname"><a href="structsoil_text__str.html#ac769b10536dd94d3652ad1cbf8d58482">soilText_str::satur</a></div><div class="ttdeci">double satur</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:103</div></div>
<div class="ttc" id="structsoil_text__str_html_a1510a66dacf9cf3586de5fc89ae2a073"><div class="ttname"><a href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">soilText_str::b</a></div><div class="ttdeci">double b</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:101</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acb415c4c261f9fc0140240ad46007c87"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sunML </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Idir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Idiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cosTheta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;{</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a>, <a class="code" href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a>, <a class="code" href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a>, <a class="code" href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a>, <a class="code" href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a>, <a class="code" href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a>[], <a class="code" href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a>[], <a class="code" href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a>[], <a class="code" href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a>[], <a class="code" href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a>[], <a class="code" href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a>[];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordtype">double</span> i;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordtype">double</span> k0, k1, k;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">double</span> LAIi, CumLAI;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordtype">double</span> Isolar, Idiffuse, Ibeam, Iscat, Itotal,alphascatter;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordtype">double</span> Ls, Ld;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordtype">double</span> Fsun, Fshade;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        alphascatter=0.8;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        k0 = sqrt(pow(chil ,2) + pow(tan(acos(cosTheta)),2));</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        k1 = chil + 1.744*pow((chil+1.183),-0.733);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        k = k0/k1;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">if</span>(k&lt;0)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                k = -k;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        LAIi = LAI / nlayers;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                CumLAI = LAIi * (i+0.5);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                Ibeam=Idir*cosTheta;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                Iscat = Ibeam * exp(-k *sqrt(alphascatter)* CumLAI)-Ibeam * exp(-k * CumLAI);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                Isolar = Ibeam*k;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                Idiffuse = Idiff * exp(-kd * CumLAI) + Iscat;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                Ls = (1-exp(-k*LAIi))*exp(-k*CumLAI)/k;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                Ld=LAIi-Ls;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                Fsun=Ls/(Ls+Ld);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                Fshade=Ld/(Ls+Ld);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <span class="comment">/*fraction intercepted*/</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                Itotal =(Fsun*Isolar + Idiffuse) * (1-exp(-k*LAIi))/k;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <span class="comment">/* collecting the results */</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                layIdir[sp1++] = Isolar + Idiffuse;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                layIdiff[sp2++] = Idiffuse;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                layItotal[sp3++] = Itotal;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                layFsun[sp4++] = Fsun;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                layFshade[sp5++] = Fshade;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                layHeight[sp6++] = CumLAI/heightf;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div>
<div class="ttc" id="_aux_bio_cro_8h_html_a5a00a948cd8575f53c71ee1f4b799da5"><div class="ttname"><a href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a></div><div class="ttdeci">double layFshade[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:26</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a959c4cc4acdec59096dac039bfdb627b"><div class="ttname"><a href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a></div><div class="ttdeci">int sp3</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a048d95ccd2cc9d2f00c78c97343c9a6a"><div class="ttname"><a href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a></div><div class="ttdeci">int sp5</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_ac86af9361847656ad3514e64ad9e9842"><div class="ttname"><a href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a></div><div class="ttdeci">int sp6</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a5ebe5f68c3871953059c08a083acdb9c"><div class="ttname"><a href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a></div><div class="ttdeci">double layHeight[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:27</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a972c42de1800efab3685fc8a47e05da5"><div class="ttname"><a href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a></div><div class="ttdeci">int sp2</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a0b8103786ef18d899e25c932a2eb5b88"><div class="ttname"><a href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a></div><div class="ttdeci">double layIdiff[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:23</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a25e1abfffbd0ba6bcb9e7d2b6c847c04"><div class="ttname"><a href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a></div><div class="ttdeci">int sp4</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a1e5f45a584d3c5541472f92c5875e4ea"><div class="ttname"><a href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a></div><div class="ttdeci">double layItotal[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:24</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a029005f88756e3761a72c104fae0d57b"><div class="ttname"><a href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a></div><div class="ttdeci">double layFsun[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:25</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a287f9452c1f62b4c5c9ec0616503fb8e"><div class="ttname"><a href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a></div><div class="ttdeci">int sp1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_ab0638a2083d3e8d4c1ac43a116da1ad8"><div class="ttname"><a href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a></div><div class="ttdeci">double layIdir[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:22</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aef4a29370ba3b33794837905d82f3b86"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TempToDdryA </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;{</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordtype">double</span> DdryA;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        DdryA = 1.295163636 + -0.004258182 * Temp;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">return</span>(DdryA);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abea4623ebab0e4ea7d9be5af1fd80344"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TempToLHV </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;{</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordtype">double</span> LHV;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        LHV = 2.501 + -0.002372727 * Temp;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">return</span>(LHV);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abd35797ea11e52f0c527d40a9c1c0b7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TempToSFS </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordtype">double</span> SlopeFS;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        SlopeFS = 0.338376068 +  0.011435897 * Temp +  0.001111111 * pow(Temp,2);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">return</span>(SlopeFS);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2b62fa0d37af87f9af219e7b0d56f34d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TempToSWVC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;{</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordtype">double</span> SWVC;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        SWVC =  4.90820192 +   0.06387253 * Temp +    0.02745742 * pow(Temp,2);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">return</span>(SWVC);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8dfc137af141b612fc3cde9b49b0fc5f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structws__str.html">ws_str</a> watstr </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precipit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soildepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fieldc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiltp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soiltype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wsFun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;{</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keyword">struct </span><a class="code" href="structws__str.html">ws_str</a> tmp;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> soTexS;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="comment">/* Variables */</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordtype">double</span> precipM;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="comment">/* available water and per hectare */</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordtype">double</span> aw, naw; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="keywordtype">double</span> pawha, Newpawha, npaw; <span class="comment">/* new 04-27-2009 */</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordtype">double</span> runoff = 0.0, runoff2 = 0.0;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="comment">/* variable needed for calculation of water stress*/</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keywordtype">double</span> wsPhoto = 0.0, wsSpleaf, phi10;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordtype">double</span> slp = 0.0, intcpt = 0.0, theta = 0.0; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordtype">double</span> Nleach = 0.0;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="comment">/* Nleach is the NO3 leached and Ts is the sand content of the soil*/</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="comment">/* Specify the soil type */</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        soTexS = <a class="code" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a>(soiltype);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">/*   Ts = soTexS.sand; */</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> &lt; 0){</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> = soTexS.fieldc;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a> &lt; 0){</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a> = soTexS.wiltp;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="comment">/* unit conversion for precip */</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        precipM = precipit * 1e-3; <span class="comment">/* convert precip in mm to m*/</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="comment">/*    cws is current water status */</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="comment">/*    available water */</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        aw = precipM + cws;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="comment">/* if(aw &gt; soTexS.satur){  */</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="comment">/*      runoff = aw - soTexS.satur; /\* Here runoff is interpreted as water content exceeding saturation level *\/ */</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="comment">/*      /\* Need to convert to units used in the Parton et al 1988 paper. *\/ */</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="comment">/*      /\* The data comes in mm/hr and it needs to be in cm/month *\/ */</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="comment">/*      runoff2 = runoff * 0.10 * (1/24*30); */</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="comment">/*      Nleach = runoff /18 * (0.2 + 0.7 * soTexS.sand); */</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="comment">/*      aw = soTexS.satur; */</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="comment">/* } */</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">/* These equations are not correct as runoff would only occur when it exceeds</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">   saturation, but from the point of view of a crop only field capacity matters */</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">/* I&#39;m not sure about what to do about this */</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordflow">if</span>(aw &gt; <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>){ </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                runoff = aw - <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>; <span class="comment">/* Here runoff is interpreted as water content exceeding saturation level */</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                <span class="comment">/* Need to convert to units used in the Parton et al 1988 paper. */</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                <span class="comment">/* The data comes in mm/hr and it needs to be in cm/month */</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                runoff2 = runoff * 0.10 * (1/24*30);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                Nleach = runoff /18 * (0.2 + 0.7 * soTexS.sand);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                aw = <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="comment">/* Tipping bucket need to collect it if want to estimate runoff */</span> </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="comment">/* plant available water per hectare (pawha) */</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        pawha = (aw - <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>) * 1e4 * soildepth;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="comment">/* The density of water is 998.2 kg/m3 at 20 degrees Celsius */</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="comment">/* or 0.9882 Mg/m3 */</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="comment">/* pawha is plant available water (m3) per hectare */</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="comment">/* evapo is demanded water (Mg) per hectare */</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        Newpawha = pawha - evapo / 0.9882; <span class="comment">/* New version 04-27-2009 */</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <span class="comment">/*  Here both are in m3 of water per ha-1 so this */</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="comment">/*  subtraction should be correct */</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="comment">/* go back to original units of water in the profile */</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        npaw = Newpawha * 1e-4 * (1/soildepth); <span class="comment">/* New 04-27-2009 */</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordflow">if</span>(npaw &lt; 0) npaw = 0.0;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        naw = npaw + <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="comment">/* Calculating the soil water potential based on equations from Norman and Campbell */</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="comment">/* tmp.psim = soTexS.air_entry * pow((naw/soTexS.fieldc*1.1),-soTexS.b) ; */</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="comment">/* New version of the soil water potential is based on</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">         * &quot;Dynamic Simulation of Water Deficit Effects upon Maize</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">         * Yield&quot; R. F. Grant Agricultural Systems. 33(1990) 13-39. */</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        tmp.psim = -exp(log(0.033) + ((log(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>) - log(naw))/(log(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>) - log(wiltp)) * (log(1.5) - log(0.033)))) * 1e3; <span class="comment">/* This last term converts from MPa to kPa */</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="comment">/* three different type of equations for modeling the effect of water stress on vmax and leaf area expansion. </span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">           The equation for leaf area expansion is more severe than the one for vmax. */</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keywordflow">if</span>(wsFun == 0){ <span class="comment">/* linear */</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                slp = 1/(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> - <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                intcpt = 1 - <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> * slp;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                wsPhoto = slp * naw + intcpt ;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordflow">if</span>(wsFun == 1){</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                phi10 = (<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> + <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>)/2;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                wsPhoto = 1/(1 + exp((phi10 - naw)/ phi1));</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">if</span>(wsFun == 2){</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                slp = (1 - <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>)/(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> - wiltp);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                intcpt = 1 - <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> * slp;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                theta = slp * naw + intcpt ;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                wsPhoto = (1 - exp(-2.5 * (theta - wiltp)/(1 - wiltp))) / (1 - exp(-2.5));</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                <span class="keywordflow">if</span>(wsFun == 3){</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                        wsPhoto = 1;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">if</span>(wsPhoto &lt;= 0 )</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                wsPhoto = 1e-20; <span class="comment">/* This can be mathematically lower than zero in some cases but I should prevent that. */</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        wsSpleaf = pow(naw,phi2) * 1/pow(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>,phi2); </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">if</span>(wsFun == 3){ </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                wsSpleaf = 1;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">/* Apparently wsPhoto and wsSpleaf can be greater than 1 */</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="keywordflow">if</span>(wsPhoto &gt; 1) wsPhoto = 1;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keywordflow">if</span>(wsSpleaf &gt; 1) wsSpleaf = 1;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="comment">/* returning the structure*/</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        tmp.rcoefPhoto = wsPhoto;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        tmp.rcoefSpleaf = wsSpleaf;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        tmp.awc = naw;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        tmp.runoff = runoff;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        tmp.Nleach = Nleach;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="keywordflow">return</span>(tmp);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;}</div>
<div class="ttc" id="structws__str_html"><div class="ttname"><a href="structws__str.html">ws_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:48</div></div>
<div class="ttc" id="structsoil_text__str_html_a6ee087ca614bcf981839ca4e28953fb2"><div class="ttname"><a href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">soilText_str::wiltp</a></div><div class="ttdeci">double wiltp</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:105</div></div>
<div class="ttc" id="structsoil_text__str_html"><div class="ttname"><a href="structsoil_text__str.html">soilText_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:95</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a72f93049960e067cda6e7291ff1ff21a"><div class="ttname"><a href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a></div><div class="ttdeci">struct soilText_str soilTchoose(int soiltype)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1166</div></div>
<div class="ttc" id="structsoil_text__str_html_aa1f62c6a0dfe9f9d7abfd52a756209bf"><div class="ttname"><a href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">soilText_str::fieldc</a></div><div class="ttdeci">double fieldc</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:104</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a43b0d68a959084dc4f4dc099c8901107"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WINDprof </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;{</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordtype">double</span> k=0.7;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordtype">double</span> LI, CumLAI;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordtype">double</span> Wind;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        LI  = LAI / nlayers;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                CumLAI = LI * (i + 1);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                Wind = WindSpeed * exp(-k * (CumLAI-LI));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>[<a class="code" href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a>++] = Wind;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div>
<div class="ttc" id="_aux_bio_cro_8h_html_af8b40a97721000892ae5e0ac624af4c6"><div class="ttname"><a href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a></div><div class="ttdeci">int tp3</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:19</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a15219c620f8cdf6d8cf731e485e2c668"><div class="ttname"><a href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a></div><div class="ttdeci">double tmp3[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:28</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a5b6e16664a459420103984ac5409b858"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CanopyAssim[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a46f339721a905fe9e6f60af35ec11974"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Grainy[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac656f07a64aeba7d6ac5a3a536e993c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double LAIc[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="abd2c9bad12951c887e8469151c778947"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Leafy[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa3741856cde2b5152c833b543abe77fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Rhizomey[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad6a54d6e671d04cd9b254a8cd1c3315c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Rooty[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a929d2badff7fb301509012ee6e6a12e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Stemy[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_bio_cro_8h.html">BioCro.h</a></li>
    <li class="footer">Generated on Fri Apr 3 2015 15:41:06 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
