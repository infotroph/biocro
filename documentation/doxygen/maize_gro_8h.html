<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>BioCro: /home/dlebauer/dev/biocro/src/maizeGro.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('maize_gro_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">maizeGro.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="maize_gro_8h__dep__incl.png" border="0" usemap="#_2home_2dlebauer_2dev_2biocro_2src_2maize_gro_8hdep" alt=""/></div>
<map name="_2home_2dlebauer_2dev_2biocro_2src_2maize_gro_8hdep" id="_2home_2dlebauer_2dev_2biocro_2src_2maize_gro_8hdep">
<area shape="rect" id="node2" href="maize_gro_8c.html" title="/home/dlebauer/dev\l/biocro/src/maizeGro.c" alt="" coords="4,97,157,138"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad67c5b654f4bceb23717a84244291ea0"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_can___str.html">Can_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maize_gro_8h.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a> (double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Alpha, double Kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double StomataWS, int ws, double kd, double chil, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, struct <a class="el" href="structnitro_parms.html">nitroParms</a> nitroP)</td></tr>
<tr class="separator:ad67c5b654f4bceb23717a84244291ea0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8df740a747a3d6378541a4f69bbff29f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlai__str.html">lai_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maize_gro_8h.html#a8df740a747a3d6378541a4f69bbff29f">laiLizasoFun</a> (double thermalt, double phenostage, double phyllochron1, double phyllochron2, double Ax, double LT, double k0, double a1, double a2, double L0, double LLx, double Lx, double LNl)</td></tr>
<tr class="separator:a8df740a747a3d6378541a4f69bbff29f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd2fb9a28d2907211d146b3fba37e048"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlai__str.html">lai_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maize_gro_8h.html#afd2fb9a28d2907211d146b3fba37e048">laiBirchdiscontinuousFun</a> (double phenostage, double Lt, double Amax, double c1, double c2, double c3, double c4)</td></tr>
<tr class="separator:afd2fb9a28d2907211d146b3fba37e048"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51216bb4e018f7bc8aa10952ffdc102c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlai__str.html">lai_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maize_gro_8h.html#a51216bb4e018f7bc8aa10952ffdc102c">laiBirchcontinuousFun</a> (double phenostage, double a, double b, double Amax, double x0, double f, double g, double TT, double LT)</td></tr>
<tr class="separator:a51216bb4e018f7bc8aa10952ffdc102c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad67c5b654f4bceb23717a84244291ea0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_can___str.html">Can_Str</a> CanAC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kparm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomataWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>upperT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lowerT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnitro_parms.html">nitroParms</a>&#160;</td>
          <td class="paramname"><em>nitroP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;{</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="keyword">struct </span><a class="code" href="struct_e_t___str.html">ET_Str</a> tmp5_ET, tmp6_ET;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> ans;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmpc4;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmpc42;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordtype">double</span> Idir, Idiff, cosTh;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordtype">double</span> IDir, IDiff, Itot, rh, WS;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordtype">double</span> pLeafsun, pLeafshade;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordtype">double</span> Leafsun, Leafshade;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordtype">double</span> CanHeight;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordtype">double</span> vmax1, leafN_lay;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordtype">double</span> TempIdir,TempIdiff,AssIdir,AssIdiff,GAssIdir,GAssIdiff;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keywordtype">double</span> CanopyA, CanopyT,GCanopyA;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 3600 * 1e-6 * 30 * 1e-6 * 10000;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="comment">/* For Assimilation */</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="comment">/* 1e-6 converts micro mols to mols */</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">/* 30 is the grams in one mol of CO2 */</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="comment">/* For Transpiration */</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="comment">/* 1e-3 converts mili mols to mols */</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="comment">/* 18 is the grams in one mol of H20 */</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a>(lat,DOY,hr);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        Idir = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[0] * solarR;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        Idiff = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[1] * solarR;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        cosTh = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[2];</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <a class="code" href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a>(Idir,Idiff,LAI,nlayers,cosTh, kd, chil, heightf);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="comment">/* results from multilayer model */</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        LAIc = LAI / nlayers;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="comment">/* Next I need the RH and wind profile */</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <a class="code" href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a>(RH,nlayers);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <a class="code" href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a>(WindSpeed,LAI,nlayers);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <a class="code" href="_aux_bio_cro_8c.html#aa65c89edaec63830e4dd568a89d12fa2">LNprof</a>(leafN, LAI, nlayers, kpLN);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="comment">/* It populates tmp5 */</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="comment">/* Next use the EvapoTrans function */</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        CanopyA=0.0;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        GCanopyA=0.0;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        CanopyT=0.0;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                leafN_lay = <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a>[--<a class="code" href="_aux_bio_cro_8h.html#a39f70a6dfb72439e2f4e0f03f27c0813">tp5</a>];</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                <span class="keywordflow">if</span>(lnfun == 0){</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                        vmax1 = Vmax;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                        vmax1=nitroP.<a class="code" href="structnitro_parms.html#ad7e57d8efdd075a1b184551d20eb44b3">Vmaxb1</a>*leafN_lay+nitroP.<a class="code" href="structnitro_parms.html#a518b100123bc67830c26f15177a8172f">Vmaxb0</a>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                              <span class="keywordflow">if</span>(vmax1&lt;0) vmax1=0.0;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                                      Alpha=nitroP.<a class="code" href="structnitro_parms.html#aaf784159d7555e9af103853d7d096b77">alphab1</a>*leafN_lay+nitroP.<a class="code" href="structnitro_parms.html#acdd68befaeeefae8f9c78aded190c9af">alphab0</a>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                                       Rd=nitroP.<a class="code" href="structnitro_parms.html#abd565ba33eeb6178c0a8d41e2024403b">Rdb1</a>*leafN_lay+nitroP.<a class="code" href="structnitro_parms.html#a965a809fcb997a1625a5ff1f2a60565b">Rdb0</a>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;               <span class="comment">/* For now alpha is not affected by leaf nitrogen */</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                IDir = <a class="code" href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a>[--<a class="code" href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a>];</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                Itot = <a class="code" href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a>[--<a class="code" href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a>];</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                rh = <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>[--<a class="code" href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a>];</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                WS = <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>[--<a class="code" href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a>];</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                pLeafsun = <a class="code" href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a>[--<a class="code" href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a>];</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                CanHeight = <a class="code" href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a>[--<a class="code" href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a>];</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                Leafsun = LAIc * pLeafsun;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                tmp5_ET = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDir,Itot,Temp,rh,WS,LAIc,CanHeight,StomataWS,ws,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,upperT,lowerT,Catm);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                TempIdir = Temp + tmp5_ET.Deltat;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                tmpc4 = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(IDir,TempIdir,rh,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,StomataWS, Catm, ws,upperT,lowerT);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                AssIdir = tmpc4.Assim;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                GAssIdir =tmpc4.GrossAssim;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                IDiff = <a class="code" href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a>[--<a class="code" href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a>];</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                pLeafshade = <a class="code" href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a>[--<a class="code" href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a>];</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                Leafshade = LAIc * pLeafshade;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                tmp6_ET = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDiff,Itot,Temp,rh,WS,LAIc,CanHeight,StomataWS,ws,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,upperT,lowerT,Catm);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                TempIdiff = Temp + tmp6_ET.Deltat;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                tmpc42 = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(IDiff,TempIdiff,rh,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,StomataWS, Catm, ws,upperT,lowerT);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                AssIdiff = tmpc42.Assim;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                GAssIdiff = tmpc42.GrossAssim;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                CanopyA += Leafsun * AssIdir + Leafshade * AssIdiff;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                GCanopyA += Leafsun * GAssIdir + Leafshade * GAssIdiff;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">// I am evaluating CanopyT using Penman Method because it gives realistic results</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">// IN future canopyT needs to be fixed</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">//                CanopyT += Leafsun * tmp5_ET.TransR + Leafshade * tmp6_ET.TransR;</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                CanopyT += Leafsun * tmp5_ET.EPenman + Leafshade * tmp6_ET.EPenman;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        }</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="comment">/*## These are micro mols of CO2 per m2 per sec for Assimilation</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">          ## and mili mols of H2O per m2 per sec for Transpiration</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">          ## Need to convert to </span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">          ## 3600 converts seconds to hours</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">          ## 10^-6 converts micro mols to mols</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">          ## 30 converts mols of CO2 to grams</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">          ## (1/10^6) converts grams to Mg</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">          ## 10000 scales up to ha */</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">/* A similar conversion is made for water but</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">   replacing 30 by 18 and mili mols are converted to</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">   mols (instead of micro) */</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        ans.Assim = cf * CanopyA ;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        ans.Trans = cf2 * CanopyT; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        ans.GrossAssim=cf*GCanopyA;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">return</span>(ans);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;}</div>
<div class="ttc" id="_aux_bio_cro_8c_html_acb415c4c261f9fc0140240ad46007c87"><div class="ttname"><a href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a></div><div class="ttdeci">void sunML(double Idir, double Idiff, double LAI, int nlayers, double cosTheta, double kd, double chil, double heightf)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:74</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a5a00a948cd8575f53c71ee1f4b799da5"><div class="ttname"><a href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a></div><div class="ttdeci">double layFshade[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:26</div></div>
<div class="ttc" id="structnitro_parms_html_a518b100123bc67830c26f15177a8172f"><div class="ttname"><a href="structnitro_parms.html#a518b100123bc67830c26f15177a8172f">nitroParms::Vmaxb0</a></div><div class="ttdeci">double Vmaxb0</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:132</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a959c4cc4acdec59096dac039bfdb627b"><div class="ttname"><a href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a></div><div class="ttdeci">int sp3</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="c4photo_8c_html_ae71c7850944d255a9b995a06fdb305aa"><div class="ttname"><a href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a></div><div class="ttdeci">struct c4_str c4photoC(double Qp, double Tl, double RH, double vmax, double alpha, double kparm, double theta, double beta, double Rd, double bb0, double bb1, double StomaWS, double Ca, int ws, double upperT, double lowerT)</div><div class="ttdef"><b>Definition:</b> c4photo.c:195</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a048d95ccd2cc9d2f00c78c97343c9a6a"><div class="ttname"><a href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a></div><div class="ttdeci">int sp5</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_bio_cro_8h_html_ac656f07a64aeba7d6ac5a3a536e993c8"><div class="ttname"><a href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a></div><div class="ttdeci">double LAIc[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:16</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a05f213f4cb25cf49735180ff3b883107"><div class="ttname"><a href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a></div><div class="ttdeci">struct ET_Str EvapoTrans(double Rad, double Itot, double Airtemperature, double RH, double WindSpeed, double LeafAreaIndex, double CanopyHeight, double StomataWS, int ws, double vmax2, double alpha2, double kparm, double theta, double beta, double Rd2, double b02, double b12, double upperT, double lowerT, double Catm)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:208</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_acfad88ff5207b2ab57fc1dca17271065"><div class="ttname"><a href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a></div><div class="ttdeci">double tmp4[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:29</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_aab252cacb5d92c011d673d2db55cba0d"><div class="ttname"><a href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a></div><div class="ttdeci">double tmp1[3]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:21</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_ac86af9361847656ad3514e64ad9e9842"><div class="ttname"><a href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a></div><div class="ttdeci">int sp6</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a5ebe5f68c3871953059c08a083acdb9c"><div class="ttname"><a href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a></div><div class="ttdeci">double layHeight[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:27</div></div>
<div class="ttc" id="structnitro_parms_html_a965a809fcb997a1625a5ff1f2a60565b"><div class="ttname"><a href="structnitro_parms.html#a965a809fcb997a1625a5ff1f2a60565b">nitroParms::Rdb0</a></div><div class="ttdeci">double Rdb0</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:136</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_aaa2add75bf14b805a4da749043e7be33"><div class="ttname"><a href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a></div><div class="ttdeci">double tmp5[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:30</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a972c42de1800efab3685fc8a47e05da5"><div class="ttname"><a href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a></div><div class="ttdeci">int sp2</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a39f70a6dfb72439e2f4e0f03f27c0813"><div class="ttname"><a href="_aux_bio_cro_8h.html#a39f70a6dfb72439e2f4e0f03f27c0813">tp5</a></div><div class="ttdeci">int tp5</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:19</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a0b8103786ef18d899e25c932a2eb5b88"><div class="ttname"><a href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a></div><div class="ttdeci">double layIdiff[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:23</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_aa65c89edaec63830e4dd568a89d12fa2"><div class="ttname"><a href="_aux_bio_cro_8c.html#aa65c89edaec63830e4dd568a89d12fa2">LNprof</a></div><div class="ttdeci">void LNprof(double LeafN, double LAI, int nlayers, double kpLN)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:163</div></div>
<div class="ttc" id="structnitro_parms_html_abd565ba33eeb6178c0a8d41e2024403b"><div class="ttname"><a href="structnitro_parms.html#abd565ba33eeb6178c0a8d41e2024403b">nitroParms::Rdb1</a></div><div class="ttdeci">double Rdb1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:135</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a25e1abfffbd0ba6bcb9e7d2b6c847c04"><div class="ttname"><a href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a></div><div class="ttdeci">int sp4</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="structc4__str_html"><div class="ttname"><a href="structc4__str.html">c4_str</a></div><div class="ttdef"><b>Definition:</b> c4photo.h:10</div></div>
<div class="ttc" id="structnitro_parms_html_ad7e57d8efdd075a1b184551d20eb44b3"><div class="ttname"><a href="structnitro_parms.html#ad7e57d8efdd075a1b184551d20eb44b3">nitroParms::Vmaxb1</a></div><div class="ttdeci">double Vmaxb1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:131</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_af8b40a97721000892ae5e0ac624af4c6"><div class="ttname"><a href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a></div><div class="ttdeci">int tp3</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:19</div></div>
<div class="ttc" id="structnitro_parms_html_acdd68befaeeefae8f9c78aded190c9af"><div class="ttname"><a href="structnitro_parms.html#acdd68befaeeefae8f9c78aded190c9af">nitroParms::alphab0</a></div><div class="ttdeci">double alphab0</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:134</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a15219c620f8cdf6d8cf731e485e2c668"><div class="ttname"><a href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a></div><div class="ttdeci">double tmp3[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:28</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a247148ac54cf7d8c851326de6093b71e"><div class="ttname"><a href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a></div><div class="ttdeci">void RHprof(double RH, int nlayers)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:144</div></div>
<div class="ttc" id="struct_can___str_html"><div class="ttname"><a href="struct_can___str.html">Can_Str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:41</div></div>
<div class="ttc" id="structnitro_parms_html_aaf784159d7555e9af103853d7d096b77"><div class="ttname"><a href="structnitro_parms.html#aaf784159d7555e9af103853d7d096b77">nitroParms::alphab1</a></div><div class="ttdeci">double alphab1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:133</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a43b0d68a959084dc4f4dc099c8901107"><div class="ttname"><a href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a></div><div class="ttdeci">void WINDprof(double WindSpeed, double LAI, int nlayers)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:128</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a1e5f45a584d3c5541472f92c5875e4ea"><div class="ttname"><a href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a></div><div class="ttdeci">double layItotal[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:24</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a36e4d9011835445995335074adedad9a"><div class="ttname"><a href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a></div><div class="ttdeci">int tp4</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:19</div></div>
<div class="ttc" id="struct_e_t___str_html"><div class="ttname"><a href="struct_e_t___str.html">ET_Str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:32</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a029005f88756e3761a72c104fae0d57b"><div class="ttname"><a href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a></div><div class="ttdeci">double layFsun[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:25</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a287f9452c1f62b4c5c9ec0616503fb8e"><div class="ttname"><a href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a></div><div class="ttdeci">int sp1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a46827eb56108821fe82228553f535293"><div class="ttname"><a href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a></div><div class="ttdeci">void lightME(double lat, int DOY, int td)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:26</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_ab0638a2083d3e8d4c1ac43a116da1ad8"><div class="ttname"><a href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a></div><div class="ttdeci">double layIdir[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:22</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a51216bb4e018f7bc8aa10952ffdc102c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlai__str.html">lai_str</a> laiBirchcontinuousFun </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phenostage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Amax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LT</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                               {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keyword">struct </span><a class="code" href="structlai__str.html">lai_str</a> tmp;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordtype">double</span> leafnumber = 0.0, totalLAI = 0.0, SLA = 0.0, TPLAmax = 0.0;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordtype">int</span> i, i2, i3, ln, ln2;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">for</span>(i2 = 0; i2 &lt; <a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>; i2++){</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                tmp.<a class="code" href="structlai__str.html#a827ead5321eef32bae4a1b95ac12cd7b">leafarea</a>[i2] = 0.0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">if</span> (phenostage &lt;= 0) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          leafnumber = 0;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          <span class="keywordflow">if</span> (phenostage &lt; 1){</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            leafnumber = phenostage* 100;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            leafnumber = LT;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        }         </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">if</span> (Amax == -1){</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="comment">/* Eq 13 in Birch*/</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                Amax = 1000 * exp(-1.17 + 0.047 * LT);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">if</span> (a == -1){</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="comment">/* Eq 18 in Birch */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                a = -0.009 - exp(-0.2 * LT);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span> (b == -1){</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="comment">/* Eq 19 in Birch */</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                b = 0.0006 - exp(-0.43 * LT);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> (x0 == -1){</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <span class="comment">/* Eq 14 in Birch */</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                x0 = 0.67 * LT;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">if</span> (g == -1){</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                <span class="comment">/* Eq 20 in Birch */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                g = 107.9 * LT - 327;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">for</span>(i3 = 0; i3 &lt; LT; i3++){</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                ln2 = i3 + 1;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                TPLAmax += Amax * exp(a * (ln2 - x0) * (ln2 - x0) + b *</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                             (ln2 - x0) * (ln2 - x0) * (ln2 - x0));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="comment">/* Birch Eq 11*/</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        SLA = TPLAmax / (1 + exp(-f * (TT - g)));</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; leafnumber; i++){</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          ln = i + 1;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          tmp.leafarea[i] = Amax * exp(a * (ln - x0) * (ln - x0) + b *</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                             (ln - x0) * (ln - x0) * (ln - x0));</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;           totalLAI += tmp.leafarea[i];</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;         }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;         tmp.totalLeafArea = totalLAI - SLA;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;         <span class="keywordflow">return</span> (tmp);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div>
<div class="ttc" id="_aux_maize_gro_8h_html_abdf261a2f5c0982109f87ae1d42cc8bb"><div class="ttname"><a href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a></div><div class="ttdeci">#define MAXLEAFNUMBER</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:10</div></div>
<div class="ttc" id="structlai__str_html"><div class="ttname"><a href="structlai__str.html">lai_str</a></div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:12</div></div>
<div class="ttc" id="structlai__str_html_a827ead5321eef32bae4a1b95ac12cd7b"><div class="ttname"><a href="structlai__str.html#a827ead5321eef32bae4a1b95ac12cd7b">lai_str::leafarea</a></div><div class="ttdeci">double leafarea[MAXLEAFNUMBER]</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:14</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afd2fb9a28d2907211d146b3fba37e048"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlai__str.html">lai_str</a> laiBirchdiscontinuousFun </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phenostage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Lt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Amax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                                             {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keyword">struct </span><a class="code" href="structlai__str.html">lai_str</a> tmp;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordtype">double</span> leafnumber, totalLAI = 0.0;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">if</span> (phenostage &lt;= 0) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;          leafnumber = 0;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;          <span class="keywordflow">if</span> (phenostage &lt; 1){</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            leafnumber = phenostage* 100;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            leafnumber = LT;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        }         </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">if</span> (Amax == -1){</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          <span class="comment">/* Eq 13 in Birch*/</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          Amax = 1000 * exp(-1.17 + 0.047 * LT);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordtype">int</span> i, i2, ln;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">for</span>(i2=0;i2&lt;<a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>;i2++){</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          tmp.leafarea[i2] = 0.0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">for</span> (i = 0; i&lt;leafnumber; i++){</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          ln = i + 1;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          <span class="keywordflow">if</span> (ln &lt;= 3){</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="comment">/* Eq 14 in Birch */</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            tmp.leafarea[i] = c1 * ln;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="keywordflow">if</span> (ln &lt;= 11){</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;              <span class="comment">/* Eq 15 in Birch */</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;              tmp.leafarea[i] = c2* ln * ln;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;              <span class="comment">/* Eq 16 in Birch */</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;              tmp.leafarea[i] = c3 * Amax + c4 * ln * ln;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          totalLAI += tmp.leafarea[i];</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        tmp.totalLeafArea = totalLAI;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">return</span> (tmp);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;}</div>
<div class="ttc" id="_aux_maize_gro_8h_html_abdf261a2f5c0982109f87ae1d42cc8bb"><div class="ttname"><a href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a></div><div class="ttdeci">#define MAXLEAFNUMBER</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:10</div></div>
<div class="ttc" id="structlai__str_html"><div class="ttname"><a href="structlai__str.html">lai_str</a></div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:12</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8df740a747a3d6378541a4f69bbff29f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlai__str.html">lai_str</a> laiLizasoFun </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thermalt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phenostage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phyllochron1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phyllochron2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>L0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LLx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Lx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LNl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;                                                                                    {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        <span class="keyword">struct </span><a class="code" href="structlai__str.html">lai_str</a> tmp;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        <span class="keywordtype">double</span> A, kei, tei;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <span class="keywordtype">double</span> LNx = 0.67 * LT;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <span class="keywordtype">double</span> te1 = 25;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <span class="keywordtype">double</span> te2 = 50;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <span class="keywordtype">double</span> tti;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="keywordtype">double</span> tsi;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <span class="keywordtype">double</span> leafnumber ;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="keywordtype">double</span> totalLAI = 0.0;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="keywordflow">if</span> (phenostage &lt;= 0) {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;          leafnumber = 0;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;          <span class="keywordflow">if</span> (phenostage &lt; 1){</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            leafnumber = phenostage* 100;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;          }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            leafnumber = LT;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;          }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        }</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/* Longevity */</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="comment">/* Eq 11 in Lisazo 2003 */</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keywordflow">if</span> (LNl == -1){ </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            LNl = 3.59 + 0.498 * LT;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="comment">/* Eq 12 in Lisazo 2003 */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="comment">/* double Wl = 0.333333 * LT; not used ? */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordtype">double</span> LLi;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordtype">double</span> Wk = LT / 8.18;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keywordtype">int</span> i, i2, ln = 0;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">for</span>(i2=0;i2&lt;<a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>;i2++){</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                tmp.<a class="code" href="structlai__str.html#a827ead5321eef32bae4a1b95ac12cd7b">leafarea</a>[i2] = 0.0;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">for</span>(i=0;i&lt;leafnumber;i++){</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                <span class="comment">/* Eq 7 in Lizaso 2003 */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                ln = i + 1;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                tti = (ln - 2) * phyllochron1 + te2;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                <span class="comment">/* Eq 8 in Lizaso 2003 */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                kei = k0 + 0.174 * exp( - ((ln - 1)*(ln - 1))/(2 * Wk * Wk));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                <span class="comment">/* Eq 10 in Lizaso 2003 */</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                LLi = L0 + Lx * exp( - (ln - LNl)*(ln - LNl)/ (2*Wk*Wk));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                <span class="comment">/* Eq 6 in Lizaso 2003 */</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                <span class="keywordflow">if</span>(ln == 1) tei = te1;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                <span class="keywordflow">if</span>(ln == 2){</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                        tei = te2;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                        tei = tti + (2.197 /kei);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                <span class="comment">/* calculating time of 50% senescence from time of 50%</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">                 * expansion and leaf longevity */</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                tsi = LLi + tei;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                <span class="comment">/* Applying Eq 4 in Lizaso 2003 */</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                A = <a class="code" href="_aux_maize_gro_8c.html#a34e7325a80b427a108b3190a3f1888f5">Aei</a>(ln, Ax, LNx, a1, a2);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                <span class="comment">/* Applying Eq 2 in Lizaso 2003 */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                tmp.leafarea[i] = <a class="code" href="_aux_maize_gro_8c.html#afcf4b24a9ebeca18c6745f807e3ea08f">Alogistic</a>(thermalt, A, kei, tei);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <span class="comment">/* calculating senesced area for this leaf */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                tmp.leafarea[i] -= <a class="code" href="_aux_maize_gro_8c.html#afcf4b24a9ebeca18c6745f807e3ea08f">Alogistic</a>(thermalt, A, kei, tsi);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                <span class="comment">/* Rprintf(&quot;leaf area %.1f \n&quot;, tmp.leafarea[i]);  */</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                totalLAI += tmp.leafarea[i];</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        tmp.totalLeafArea = totalLAI;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">return</span>(tmp);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
<div class="ttc" id="_aux_maize_gro_8c_html_a34e7325a80b427a108b3190a3f1888f5"><div class="ttname"><a href="_aux_maize_gro_8c.html#a34e7325a80b427a108b3190a3f1888f5">Aei</a></div><div class="ttdeci">double Aei(double leafnumber, double Ax, double LNx, double a1, double a2)</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.c:205</div></div>
<div class="ttc" id="_aux_maize_gro_8c_html_afcf4b24a9ebeca18c6745f807e3ea08f"><div class="ttname"><a href="_aux_maize_gro_8c.html#afcf4b24a9ebeca18c6745f807e3ea08f">Alogistic</a></div><div class="ttdeci">double Alogistic(double time, double A, double kei, double tei)</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.c:221</div></div>
<div class="ttc" id="_aux_maize_gro_8h_html_abdf261a2f5c0982109f87ae1d42cc8bb"><div class="ttname"><a href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a></div><div class="ttdeci">#define MAXLEAFNUMBER</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:10</div></div>
<div class="ttc" id="structlai__str_html"><div class="ttname"><a href="structlai__str.html">lai_str</a></div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:12</div></div>
<div class="ttc" id="structlai__str_html_a827ead5321eef32bae4a1b95ac12cd7b"><div class="ttname"><a href="structlai__str.html#a827ead5321eef32bae4a1b95ac12cd7b">lai_str::leafarea</a></div><div class="ttdeci">double leafarea[MAXLEAFNUMBER]</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:14</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="maize_gro_8h.html">maizeGro.h</a></li>
    <li class="footer">Generated on Fri Apr 3 2015 15:41:07 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
