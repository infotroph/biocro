<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>BioCro: /home/dlebauer/dev/biocro/src/c4photo.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('c4photo_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">c4photo.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="c4photo_8h__dep__incl.png" border="0" usemap="#_2home_2dlebauer_2dev_2biocro_2src_2c4photo_8hdep" alt=""/></div>
<map name="_2home_2dlebauer_2dev_2biocro_2src_2c4photo_8hdep" id="_2home_2dlebauer_2dev_2biocro_2src_2c4photo_8hdep">
<area shape="rect" id="node2" href="_aux_bio_cro_8c.html" title="/home/dlebauer/dev\l/biocro/src/AuxBioCro.c" alt="" coords="5,97,165,138"/><area shape="rect" id="node3" href="_auxcane_gro_8c.html" title="/home/dlebauer/dev\l/biocro/src/AuxcaneGro.c" alt="" coords="191,97,361,138"/><area shape="rect" id="node4" href="c3_can_a_8c.html" title="/home/dlebauer/dev\l/biocro/src/c3CanA.c" alt="" coords="386,97,531,138"/><area shape="rect" id="node5" href="c4photo_8c.html" title="/home/dlebauer/dev\l/biocro/src/c4photo.c" alt="" coords="556,97,700,138"/><area shape="rect" id="node6" href="_can_a_8c.html" title="/home/dlebauer/dev\l/biocro/src/CanA.c" alt="" coords="724,97,859,138"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structc4__str.html">c4_str</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad7e87994bce05d2a7f52fceb0bf0274f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c4photo_8h.html#ad7e87994bce05d2a7f52fceb0bf0274f">C4PHOTO_H</a></td></tr>
<tr class="separator:ad7e87994bce05d2a7f52fceb0bf0274f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a117eb09a92cb1d21d3fd53c34cad3098"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c4photo_8h.html#a117eb09a92cb1d21d3fd53c34cad3098">fnpsvp</a> (double Tkelvin)</td></tr>
<tr class="separator:a117eb09a92cb1d21d3fd53c34cad3098"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad252ecbdbb24d814dab3373a3f101b49"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c4photo_8h.html#ad252ecbdbb24d814dab3373a3f101b49">ballBerry</a> (double Amu, double Cappm, double Temp, double RelH, double beta0, double beta1)</td></tr>
<tr class="separator:ad252ecbdbb24d814dab3373a3f101b49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae71c7850944d255a9b995a06fdb305aa"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structc4__str.html">c4_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c4photo_8h.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a> (double Qp, double Tl, double RH, double vmax, double alpha, double kparm, double theta, double beta, double Rd, double bb0, double bb1, double StomaWS, double Ca, int ws, double upperT, double lowerT)</td></tr>
<tr class="separator:ae71c7850944d255a9b995a06fdb305aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a764df7753151dc1e631cfeb85ff2b473"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c4photo_8h.html#a764df7753151dc1e631cfeb85ff2b473">RSS_C4photo</a> (double oAssim[<a class="el" href="c4photo_8h.html#a29aa87abb47cbc614f79d8b48185d41a">nObs</a>], double oQp[<a class="el" href="c4photo_8h.html#a29aa87abb47cbc614f79d8b48185d41a">nObs</a>], double oTemp[<a class="el" href="c4photo_8h.html#a29aa87abb47cbc614f79d8b48185d41a">nObs</a>], double oRH[<a class="el" href="c4photo_8h.html#a29aa87abb47cbc614f79d8b48185d41a">nObs</a>], double vmax, double alpha, double kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double StomWS, int ws, double upperT, double lowerT)</td></tr>
<tr class="separator:a764df7753151dc1e631cfeb85ff2b473"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a29aa87abb47cbc614f79d8b48185d41a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c4photo_8h.html#a29aa87abb47cbc614f79d8b48185d41a">nObs</a></td></tr>
<tr class="separator:a29aa87abb47cbc614f79d8b48185d41a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ad7e87994bce05d2a7f52fceb0bf0274f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define C4PHOTO_H</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad252ecbdbb24d814dab3373a3f101b49"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ballBerry </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Amu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Cappm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;{</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> gbw = 1.2; <span class="comment">/* According to Collatz et al. (1992) pg. 526*/</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> ptotPa = 101325; <span class="comment">/* Atmospheric pressure */</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordtype">double</span> pwaPa, leafTk, Camf, assimn;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordtype">double</span> wa, pwi, wi, gswmol, Cs, acs;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordtype">double</span> aaa, bbb, ccc, ddd;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordtype">double</span> gsmol;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordtype">double</span> hs;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        leafTk = Temp + 273.15;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        pwi = <a class="code" href="c4photo_8c.html#a117eb09a92cb1d21d3fd53c34cad3098">fnpsvp</a>(leafTk);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        pwaPa = RelH * pwi;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        Camf = Cappm * 1e-6;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        assimn = Amu * 1e-6;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="comment">/* Calculate mole fraction (mixing ratio) of water vapor in */</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="comment">/* atmosphere from partial pressure of water in the atmosphere and*/</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="comment">/* the total air pressure */</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        wa  = pwaPa / ptotPa;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">/* Get saturation vapor pressure for water in the leaf based on */</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="comment">/* current idea of the leaf temperature in Kelvin*/</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">/* Already calculated above */</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">/* Calculate mole fraction of water vapor in leaf interior */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        wi  = pwi / ptotPa;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span>(assimn &lt; 0.0){</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                <span class="comment">/* Set stomatal conductance to the minimum value, beta0*/</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                gswmol = beta0 ;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <span class="comment">/* Calculate leaf surface relative humidity, hs, (as fraction)*/</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <span class="comment">/* for when C assimilation rate is &lt;= 0*/</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <span class="comment">/* hs = (beta0 + (wa/wi)*gbw)/(beta0 + gbw); ! unused here??*/</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                <span class="comment">/* leaf surface CO2, mole fraction */</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                Cs  = Camf - (1.4/gbw)*assimn;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                <span class="keywordflow">if</span>(Cs &lt; 0.0)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                        Cs = 1;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                <span class="comment">/* Constrain the ratio assimn/cs to be &gt; 1.e-6*/</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                acs = assimn/Cs;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <span class="keywordflow">if</span>(acs &lt; 1e-6)  acs = 1e-6;             </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                <span class="comment">/* Calculate leaf surface relative humidity, hs, from quadratic */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                <span class="comment">/* equation: aaa*hs^2 + bbb*hs + ccc = 0 */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                <span class="comment">/*  aaa= beta1 * assimn / cs */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                aaa = beta1 * acs;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="comment">/*      bbb= beta0 + gbw - (beta1 * assimn / cs)*/</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                bbb = beta0 + gbw - (beta1 * acs);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                ccc = -(wa / wi) * gbw - beta0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="comment">/* Solve the quadratic equation for leaf surface relative humidity */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <span class="comment">/* (as fraction) */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                ddd = bbb * bbb - 4*aaa*ccc;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                hs  = (-bbb + sqrt(ddd)) / (2* aaa);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                <span class="comment">/* Ball-Berry equation (Collatz&#39;91, eqn 1) */</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                gswmol = beta1 * hs * acs + beta0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        gsmol = gswmol * 1000; <span class="comment">/* converting to mmol */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span>(gsmol &lt;= 0) gsmol = 1e-5;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">return</span>(gsmol);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="ttc" id="c4photo_8c_html_a117eb09a92cb1d21d3fd53c34cad3098"><div class="ttname"><a href="c4photo_8c.html#a117eb09a92cb1d21d3fd53c34cad3098">fnpsvp</a></div><div class="ttdeci">double fnpsvp(double Tkelvin)</div><div class="ttdef"><b>Definition:</b> c4photo.c:176</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae71c7850944d255a9b995a06fdb305aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structc4__str.html">c4_str</a> c4photoC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kparm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>bb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>bb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomaWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ca</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>upperT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lowerT</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;{</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmp;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="comment">/* Constants */</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> AP = 101325; <span class="comment">/*Atmospheric pressure According to wikipedia (Pa)*/</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> P = AP / 1e3; <span class="comment">/* kPa */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment">/*const double PS = 38;   Atmospheric pressure of CO2 */</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> Q10 = 2;  <span class="comment">/* Q10 increase in a reaction by 10 C temp */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">/* Defining biochemical variables */</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordtype">double</span> Csurface ;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordtype">double</span> InterCellularCO2 ;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordtype">double</span> KQ10 , kT ;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordtype">double</span> Vtn , Vtd , VT ;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordtype">double</span> Rtn , Rtd , RT ;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordtype">double</span> b0 , b1 , b2 ;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordtype">double</span> M1 , M2 , M ;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordtype">int</span> iterCounter ;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordtype">double</span> Quada , Quadb , Quadc ;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordtype">double</span> a2 , <a class="code" href="structc4__str.html#a7adeee8f55ac1ffe5e9c226823ae4251">Assim</a> ,<a class="code" href="structc4__str.html#ac2cb333c4e7bdd22c4c9672c80ed977f">GrossAssim</a>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordtype">double</span> csurfaceppm ;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structc4__str.html#ac72aab455ed835560d5b9afd64c777eb">Gs</a> , miC = 0.0 ;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordtype">double</span> diff, OldAssim = 0.0, Tol = 0.1;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordtype">double</span> kT_IC_P;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">/* When the method does not converge I do not use the iterative solution*/</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordtype">double</span> Assim0 = 0.0;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordtype">double</span> Gs0 = 0.0;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordtype">double</span> IntCO2 = 0.0;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">/* partial pressure of CO2 at the leaf surface */</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="comment">/* if(StomaWS &lt; 0.5) ws = 0; */</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        Csurface = (Ca * 1e-6) * AP ;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        InterCellularCO2 = Csurface * 0.4; <span class="comment">/* Initial guestimate */</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        KQ10 =  pow(Q10,((Tl - 25.0) / 10.0));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        kT = kparm * KQ10;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="comment">/* First chunk of code see Collatz (1992) */</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">//      Vtn = vmax * pow(2,((Tl-25.0)/10.0));</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">//      Vtd = ( 1 + exp(0.3 * (3.0-Tl)) ) * (1 + exp( 0.3*(Tl-37.5) ));</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">//      VT  = Vtn / Vtd;</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">//       This is the code implementing temperature limitations</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;         Vtn = vmax * pow(2,((Tl-25.0)/10.0));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;         Vtd = ( 1 + exp(0.3 * (lowerT-Tl)) ) * (1 + exp( 0.3*(Tl-upperT) ));</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;         VT  = Vtn / Vtd;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="comment">/* Second chunk of code see Collatz (1992) */</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        Rtn = Rd * pow(2 , (Tl-25)/10 ) ;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        Rtd =  1 + exp( 1.3 * (Tl-55) ) ;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        RT = Rtn / Rtd ; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="comment">/* Third chunk of code again see Collatz (1992) */</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        b0 = VT * alpha  * Qp ;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        b1 = VT + alpha  * Qp ;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        b2 = theta ;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="comment">/* Calculate the 2 roots */</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        M1 = (b1 + sqrt(b1*b1 - (4 * b0 * b2)))/(2*b2) ;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        M2 = (b1 - sqrt(b1*b1 - (4 * b0 * b2)))/(2*b2) ;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="comment">/* This piece of code selects the smalles root */</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">if</span>(M1 &lt; M2)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                M = M1;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                M = M2;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">/* Here the iterations will start */</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        iterCounter = 0;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">while</span>(iterCounter &lt; 50)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                kT_IC_P = kT * (InterCellularCO2 / P*1000);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                Quada = M * kT_IC_P;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                Quadb = M + kT_IC_P;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                Quadc = beta ;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                a2 = (Quadb - sqrt(Quadb*Quadb - (4 * Quada * Quadc))) / (2 * Quadc);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                Assim = a2 - RT;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="keywordflow">if</span>(ws == 0) Assim *= StomaWS; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <span class="comment">/* milimole per meter square per second*/</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                csurfaceppm = Csurface * 10 ;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                <span class="comment">/* Need to create the Ball-Berry function */</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                Gs =  <a class="code" href="c4photo_8c.html#ad252ecbdbb24d814dab3373a3f101b49">ballBerry</a>(Assim,csurfaceppm, Tl, RH, bb0, bb1) ;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                <span class="keywordflow">if</span>(ws == 1) Gs *= StomaWS; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                InterCellularCO2 = Csurface - (Assim * 1e-6 * 1.6 * AP) / (Gs * 0.001);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                <span class="keywordflow">if</span>(InterCellularCO2 &lt; 0)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                        InterCellularCO2 = 1e-5;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <span class="keywordflow">if</span>(iterCounter == 0){</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                        Assim0 = <a class="code" href="structc4__str.html#a7adeee8f55ac1ffe5e9c226823ae4251">Assim</a>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                        Gs0 = <a class="code" href="structc4__str.html#ac72aab455ed835560d5b9afd64c777eb">Gs</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                        IntCO2 = InterCellularCO2;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                diff = OldAssim - <a class="code" href="structc4__str.html#a7adeee8f55ac1ffe5e9c226823ae4251">Assim</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                <span class="keywordflow">if</span>(diff &lt; 0) diff = -diff;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                <span class="keywordflow">if</span>(diff &lt; Tol){</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                        OldAssim = <a class="code" href="structc4__str.html#a7adeee8f55ac1ffe5e9c226823ae4251">Assim</a>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                iterCounter++;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">/* This would ignore the optimization due to the iterative procedure</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"> * when it does not converge. It is turned off now*/</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="comment">/* if(diff &gt; Tol){ */</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment">/*      Assim = Assim0; */</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="comment">/*      Gs = Gs0; */</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">/*      InterCellularCO2 = IntCO2; */</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">/* } */</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">/* if(diff &gt; Tol){ */</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="comment">/*      Rprintf(&quot;iter %.i diff %.3f \n&quot;,iterCounter,diff); */</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="comment">/*      Rprintf(&quot;%.2f %.2f %.2f %.2f \n&quot;, Qp, Tl, RH, StomaWS); */</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="comment">/*      Rprintf(&quot;StomWS %.2f \n&quot;,StomaWS); */</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="comment">/*      Rprintf(&quot;InterCellular CO2 %.2f \n&quot;,InterCellularCO2); */</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment">/*      Rprintf(&quot;Assim %.2f \n&quot;,Assim); */</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="comment">/*      Rprintf(&quot;miC %.2f \n&quot;,(InterCellularCO2/AP)*1e6); */</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="comment">/*      Rprintf(&quot;vmax %.1f alpha %.3f \n&quot;, vmax, alpha); */</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="comment">/*      Rprintf(&quot;kparm %.3f theta %.3f \n&quot;, kparm, theta); */</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="comment">/*      Rprintf(&quot;beta %.3f Rd %.3f \n&quot;, beta, Rd); */</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment">/*      Rprintf(&quot;bb0 %.3f bb1 %.3f \n&quot;, bb0, bb1); */</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="comment">/*      Rprintf(&quot;Ca %.1f ws %i \n&quot;, Ca, ws); */</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="comment">/*      error(&quot;Did not converge \n&quot;); */</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="comment">/* } */</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        miC = (InterCellularCO2 / AP) * 1e6 ;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">if</span>(Gs &gt; 600)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;          Gs = 600;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  GrossAssim=Assim+RT;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        tmp.Assim = <a class="code" href="structc4__str.html#a7adeee8f55ac1ffe5e9c226823ae4251">Assim</a>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        tmp.Gs = <a class="code" href="structc4__str.html#ac72aab455ed835560d5b9afd64c777eb">Gs</a>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        tmp.Ci = miC;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  tmp.GrossAssim=<a class="code" href="structc4__str.html#ac2cb333c4e7bdd22c4c9672c80ed977f">GrossAssim</a>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">return</span>(tmp);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div>
<div class="ttc" id="structc4__str_html_ac2cb333c4e7bdd22c4c9672c80ed977f"><div class="ttname"><a href="structc4__str.html#ac2cb333c4e7bdd22c4c9672c80ed977f">c4_str::GrossAssim</a></div><div class="ttdeci">double GrossAssim</div><div class="ttdef"><b>Definition:</b> c4photo.h:15</div></div>
<div class="ttc" id="structc4__str_html_a7adeee8f55ac1ffe5e9c226823ae4251"><div class="ttname"><a href="structc4__str.html#a7adeee8f55ac1ffe5e9c226823ae4251">c4_str::Assim</a></div><div class="ttdeci">double Assim</div><div class="ttdef"><b>Definition:</b> c4photo.h:12</div></div>
<div class="ttc" id="structc4__str_html_ac72aab455ed835560d5b9afd64c777eb"><div class="ttname"><a href="structc4__str.html#ac72aab455ed835560d5b9afd64c777eb">c4_str::Gs</a></div><div class="ttdeci">double Gs</div><div class="ttdef"><b>Definition:</b> c4photo.h:13</div></div>
<div class="ttc" id="structc4__str_html"><div class="ttname"><a href="structc4__str.html">c4_str</a></div><div class="ttdef"><b>Definition:</b> c4photo.h:10</div></div>
<div class="ttc" id="c4photo_8c_html_ad252ecbdbb24d814dab3373a3f101b49"><div class="ttname"><a href="c4photo_8c.html#ad252ecbdbb24d814dab3373a3f101b49">ballBerry</a></div><div class="ttdeci">double ballBerry(double Amu, double Cappm, double Temp, double RelH, double beta0, double beta1)</div><div class="ttdef"><b>Definition:</b> c4photo.c:106</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a117eb09a92cb1d21d3fd53c34cad3098"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fnpsvp </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tkelvin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                             {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment">/* water boiling point = 373.16 oK*/</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">/* This is the Arden Buck Equation </span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">http://en.wikipedia.org/wiki/Arden_Buck_equation</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordtype">double</span> u, v;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordtype">double</span> tmp, esat;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        tmp = Tkelvin - 273.15;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        u = (18.678 - tmp/234.5)*tmp;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        v = 257.14 + tmp;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        esat = 6.1121 * exp(u/v);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        esat /= 10;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">return</span>(esat);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a764df7753151dc1e631cfeb85ff2b473"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double RSS_C4photo </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oAssim</em>[nObs], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oQp</em>[nObs], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oTemp</em>[nObs], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oRH</em>[nObs], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kparm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>upperT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lowerT</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                                                                                                   { <span class="comment">/*\ref{eqn:Rd}*/</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="c4photo_8h.html#a29aa87abb47cbc614f79d8b48185d41a">nObs</a>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmp;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordtype">double</span> RSS = 0.0, diff = 0.0;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keywordflow">for</span>(i = 0;i &lt; <a class="code" href="c4photo_8h.html#a29aa87abb47cbc614f79d8b48185d41a">nObs</a>; i++){</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                tmp = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(oQp[i],oTemp[i],oRH[i],vmax,alpha,kparm,theta, beta, Rd,b0,b1,StomWS,Catm,ws,upperT,lowerT);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                diff = oAssim[i] - tmp.Assim;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                RSS += diff * diff;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">return</span>(RSS);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;}</div>
<div class="ttc" id="c4photo_8c_html_ae71c7850944d255a9b995a06fdb305aa"><div class="ttname"><a href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a></div><div class="ttdeci">struct c4_str c4photoC(double Qp, double Tl, double RH, double vmax, double alpha, double kparm, double theta, double beta, double Rd, double bb0, double bb1, double StomaWS, double Ca, int ws, double upperT, double lowerT)</div><div class="ttdef"><b>Definition:</b> c4photo.c:195</div></div>
<div class="ttc" id="c4photo_8h_html_a29aa87abb47cbc614f79d8b48185d41a"><div class="ttname"><a href="c4photo_8h.html#a29aa87abb47cbc614f79d8b48185d41a">nObs</a></div><div class="ttdeci">int nObs</div><div class="ttdef"><b>Definition:</b> c4photo.h:8</div></div>
<div class="ttc" id="structc4__str_html"><div class="ttname"><a href="structc4__str.html">c4_str</a></div><div class="ttdef"><b>Definition:</b> c4photo.h:10</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a29aa87abb47cbc614f79d8b48185d41a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nObs</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="c4photo_8h.html">c4photo.h</a></li>
    <li class="footer">Generated on Fri Apr 3 2015 15:41:06 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
