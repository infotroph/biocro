<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>BioCro: /home/dlebauer/dev/biocro/src/BioCro.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_bio_cro_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">BioCro.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;R.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;Rmath.h&gt;</code><br/>
<code>#include &lt;Rinternals.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="">AuxBioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">Century.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">BioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">crocent.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for BioCro.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="_bio_cro_8c__incl.png" border="0" usemap="#_2home_2dlebauer_2dev_2biocro_2src_2_bio_cro_8c" alt=""/></div>
<map name="_2home_2dlebauer_2dev_2biocro_2src_2_bio_cro_8c" id="_2home_2dlebauer_2dev_2biocro_2src_2_bio_cro_8c">
<area shape="rect" id="node6" href="_aux_bio_cro_8h.html" title="AuxBioCro.h" alt="" coords="373,96,469,123"/><area shape="rect" id="node7" href="_century_8h.html" title="Century.h" alt="" coords="494,96,572,123"/><area shape="rect" id="node8" href="_bio_cro_8h.html" title="BioCro.h" alt="" coords="597,96,669,123"/><area shape="rect" id="node9" href="crocent_8h.html" title="crocent.h" alt="" coords="694,96,769,123"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acc47de00e88f05a80f60a9e599303902"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8c.html#acc47de00e88f05a80f60a9e599303902">MisGro</a> (SEXP LAT, SEXP DOY, SEXP HR, SEXP SOLAR, SEXP TEMP, SEXP RH, SEXP WINDSPEED, SEXP PRECIP, SEXP KD, SEXP CHILHF, SEXP NLAYERS, SEXP RHIZOME, SEXP IRTL, SEXP SENCOEFS, SEXP TIMESTEP, SEXP VECSIZE, SEXP SPLEAF, SEXP SPD, SEXP DBPCOEFS, SEXP THERMALP, SEXP VMAX, SEXP ALPHA, SEXP KPARM, SEXP THETA, SEXP BETA, SEXP RD, SEXP CATM, SEXP B0, SEXP B1, SEXP WS, SEXP SOILCOEFS, SEXP ILEAFN, SEXP KLN, SEXP VMAXB1, SEXP ALPHAB1, SEXP MRESP, SEXP SOILTYPE, SEXP WSFUN, SEXP CENTCOEFS, SEXP CENTTIMESTEP, SEXP CENTKS, SEXP SOILLAYERS, SEXP SOILDEPTHS, SEXP CWS, SEXP HYDRDIST, SEXP SECS, SEXP KPLN, SEXP LNB0, SEXP LNB1, SEXP LNFUN, SEXP UPPERTEMP, SEXP LOWERTEMP, SEXP NNITROP)</td></tr>
<tr class="separator:acc47de00e88f05a80f60a9e599303902"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad26763269c44e2d53306e4de98a180f6"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8c.html#ad26763269c44e2d53306e4de98a180f6">SABioGro</a> (SEXP oTHERMAL, SEXP oSTEM, SEXP oLEAF, SEXP oROOT, SEXP oRHIZOME, SEXP oGRAIN, SEXP oLAI, SEXP DOY, SEXP HR, SEXP SOLAR, SEXP TEMP, SEXP RH, SEXP WINDSPEED, SEXP PRECIP, SEXP DBPCOEF, SEXP VECSIZE, SEXP LAT, SEXP NLAYERS, SEXP RHIZOMEIRTL, SEXP SENESCTIME, SEXP TIMESTEP, SEXP VMAX, SEXP ALPHA, SEXP KPARM, SEXP THETA, SEXP BETA, SEXP RD, SEXP CATM, SEXP B0, SEXP B1, SEXP SOILCOEFS, SEXP WSFUN, SEXP WS, SEXP ILEAFN, SEXP KLN, SEXP VMAXB1, SEXP ALPHAB1, SEXP MRESP, SEXP SOILTYPE, SEXP CENTCOEFS, SEXP CENTKS, SEXP CENTTIMESTEP, SEXP KD, SEXP CHILHF, SEXP SP, SEXP SPD, SEXP THERMALP, SEXP INDEX, SEXP NDATA, SEXP N1DAT, SEXP NITER, SEXP NITER2, SEXP SATEMP, SEXP COOLSAMP, SEXP SCALE, SEXP SD, SEXP PHEN, SEXP SOILLAYERS, SEXP SOILDEPTHS, SEXP CWS, SEXP HYDRDIST, SEXP SECS, SEXP NCOEFS, SEXP LNFUN, SEXP UPPERTEMP, SEXP LOWERTEMP, SEXP NNITROP)</td></tr>
<tr class="separator:ad26763269c44e2d53306e4de98a180f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a140e2632f0a9a79a801fcbea03b7740d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8c.html#a140e2632f0a9a79a801fcbea03b7740d">RSS_BG</a> (double oStem[], double oLeaf[], double oRoot[], double oRhizome[], double oGrain[], double oLAI[], double sStem[], double sLeaf[], double sRoot[], double sRhizome[], double sGrain[], double sLAI[], int N1Dat)</td></tr>
<tr class="separator:a140e2632f0a9a79a801fcbea03b7740d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa289681c71425537eb6fccb7ae92962a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8c.html#aa289681c71425537eb6fccb7ae92962a">BioGro</a> (double lat, int doy[], int hr[], double solar[], double temp[], double rh[], double windspeed[], double precip[], double kd, double chil, double heightf, int nlayers, double iRhizome, double irtl, double sencoefs[], int timestep, int vecsize, double Sp, double SpD, double dbpcoefs[25], double thermalp[], double vmax1, double alpha1, double kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double soilcoefs[], double ileafn, double kLN, double vmaxb1, double alphab1, double mresp[], int soilType, int wsFun, int ws, double centcoefs[], double centks[], int centTimestep, int soilLayers, double soilDepths[], double cws[], int hydrDist, double secs[], double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, struct <a class="el" href="structnitro_parms.html">nitroParms</a> nitroP)</td></tr>
<tr class="separator:aa289681c71425537eb6fccb7ae92962a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a054d5ae3a62e6217a0d4e5093b79bb25"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8c.html#a054d5ae3a62e6217a0d4e5093b79bb25">sel_phen</a> (int phen)</td></tr>
<tr class="separator:a054d5ae3a62e6217a0d4e5093b79bb25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa289681c71425537eb6fccb7ae92962a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BioGro </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>doy</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solar</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rh</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>windspeed</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precip</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>iRhizome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>irtl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sencoefs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>vecsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SpD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dbpcoefs</em>[25], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thermalp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vmax1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kparm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soilcoefs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ileafn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vmaxb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alphab1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mresp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soilType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wsFun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>centcoefs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>centks</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>centTimestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soilLayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soilDepths</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cws</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hydrDist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>secs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>upperT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lowerT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnitro_parms.html">nitroParms</a>&#160;</td>
          <td class="paramname"><em>nitroP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;{</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a>[8760] ;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#abd2c9bad12951c887e8469151c778947">Leafy</a>[8760] ;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#a929d2badff7fb301509012ee6e6a12e9">Stemy</a>[8760] ;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ad6a54d6e671d04cd9b254a8cd1c3315c">Rooty</a>[8760] ;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#aa3741856cde2b5152c833b543abe77fc">Rhizomey</a>[8760] ;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#a46f339721a905fe9e6f60af35ec11974">Grainy</a>[8760] ;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>[8760] ;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        <span class="keywordtype">double</span> newLeafcol[8760];</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        <span class="keywordtype">double</span> newStemcol[8760];</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        <span class="keywordtype">double</span> newRootcol[8760];</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        <span class="keywordtype">double</span> newRhizomecol[8760];</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        <span class="keywordtype">int</span> i, i3;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        <span class="keywordtype">double</span> Leaf, Stem, Root, Rhizome, LAI, Grain = 0.0;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        <span class="keywordtype">double</span> TTc = 0.0;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structmaize__dbp__str.html#ac99cccaa39474eb44da7927824bf1590">kLeaf</a> = 0.0, <a class="code" href="structmaize__dbp__str.html#a23cfdc1222afa011bc4171cb99aefad5">kStem</a> = 0.0, <a class="code" href="structmaize__dbp__str.html#a57b9aa759f801b0c771f3a90abecb73c">kRoot</a> = 0.0, kRhizome = 0.0, <a class="code" href="structmaize__dbp__str.html#a99f7fe00ab60f353e0041e6bee822ce1">kGrain</a> = 0.0;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="keywordtype">double</span> newLeaf, newStem = 0.0, newRoot, newRhizome = 0.0, newGrain = 0.0;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        <span class="keywordtype">double</span> litter[4];</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        litter[0] = centcoefs[19];</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        litter[1] = centcoefs[20];</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        litter[2] = centcoefs[21];</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        litter[3] = centcoefs[22];</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        <span class="comment">/* Variables needed for collecting litter */</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="keywordtype">double</span> LeafLitter = litter[0], StemLitter = litter[1];</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        <span class="keywordtype">double</span> RootLitter = litter[2], RhizomeLitter = litter[3];</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        <span class="keywordtype">double</span> LeafLitter_d = 0.0, StemLitter_d = 0.0;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        <span class="keywordtype">double</span> RootLitter_d = 0.0, RhizomeLitter_d = 0.0;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        <span class="keywordtype">double</span> ALitter = 0.0, BLitter = 0.0;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        <span class="keywordtype">double</span> *sti , *sti2, *sti3, *sti4; </div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        <span class="keywordtype">double</span> Remob;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        <span class="keywordtype">int</span> k = 0, q = 0, m = 0, n = 0;</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        <span class="keywordtype">int</span> ri = 0;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        <span class="keywordtype">double</span> StomWS = 1, LeafWS = 1;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        <span class="keywordtype">double</span> CanopyA, CanopyT;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        <span class="keywordtype">double</span> vmax, alpha;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="keywordtype">double</span> LeafN_0 = ileafn;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <span class="keywordtype">double</span> LeafN = ileafn; <span class="comment">/* Need to set it because it is used by CanA before it is computed */</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="keywordtype">double</span> iSp = Sp;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        vmax = vmax1;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        alpha = alpha1;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        <span class="comment">/* Century */</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <span class="keywordtype">double</span> MinNitro = centcoefs[18];</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        <span class="keywordtype">double</span> SCCs[9];</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        <span class="keywordtype">double</span> Resp;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> mrc1 = mresp[0];</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> mrc2 = mresp[1];</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> Canopy;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        <span class="keyword">struct </span><a class="code" href="structws__str.html">ws_str</a> WaterS;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        <span class="keyword">struct </span><a class="code" href="structdbp__str.html">dbp_str</a> dbpS;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        <span class="keyword">struct </span><a class="code" href="structcen_t__str.html">cenT_str</a> centS;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        <span class="keyword">struct </span><a class="code" href="structsoil_m_l__str.html">soilML_str</a> soilMLS;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> soTexS; <span class="comment">/* , *soTexSp = &amp;soTexS; */</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        soTexS = <a class="code" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a>(soilType);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        Rhizome = iRhizome;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        Leaf = Rhizome * irtl;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        Stem = Rhizome * 0.001;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        Root = Rhizome * 0.001;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        LAI = Leaf * Sp;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> FieldC = soilcoefs[0];</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> WiltP = soilcoefs[1];</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> phi1 = soilcoefs[2];</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> phi2 = soilcoefs[3];</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> soilDepth = soilcoefs[4];</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        <span class="keywordtype">double</span> waterCont = soilcoefs[5];</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        <span class="keywordtype">double</span> soilEvap, TotEvap;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> SeneLeaf = sencoefs[0];</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> SeneStem = sencoefs[1];</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> SeneRoot = sencoefs[2];</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> SeneRhizome = sencoefs[3];</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        SCCs[0] = centcoefs[0];</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        SCCs[1] = centcoefs[1];</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        SCCs[2] = centcoefs[2];</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        SCCs[3] = centcoefs[3];</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        SCCs[4] = centcoefs[4];</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        SCCs[5] = centcoefs[5];</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        SCCs[6] = centcoefs[6];</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        SCCs[7] = centcoefs[7];</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        SCCs[8] = centcoefs[8];</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="comment">/* Creation of pointers outside the loop */</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        sti = &amp;newLeafcol[0]; <span class="comment">/* This creates sti to be a pointer to the position 0</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="comment">                                 in the newLeafcol vector */</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        sti2 = &amp;newStemcol[0];</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        sti3 = &amp;newRootcol[0];</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        sti4 = &amp;newRhizomecol[0];</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        <span class="keywordflow">for</span>(i=0;i&lt;vecsize;i++)</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        {</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                <span class="comment">/* First calculate the elapsed Thermal Time*/</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                TTc += (temp[i] / (24/timestep));</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                <span class="comment">/* Do the magic! Calculate growth*/</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                Canopy = <a class="code" href="_aux_bio_cro_8c.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a>(LAI,doy[i],hr[i],</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;                               solar[i],temp[i],rh[i],windspeed[i],</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                               lat,nlayers,vmax,alpha,kparm,theta,beta,</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                               Rd,Catm,b0,b1,StomWS,ws,kd, chil,</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;                               heightf, LeafN, kpLN, lnb0, lnb1, lnfun,upperT,lowerT,nitroP);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                CanopyA = Canopy.Assim * timestep;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                CanopyT = Canopy.Trans * timestep;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                <span class="keywordflow">if</span>(ISNAN(CanopyA)){</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                        Rprintf(<span class="stringliteral">&quot;LAI %.2f \n&quot;</span>,LAI); </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                        Rprintf(<span class="stringliteral">&quot;Leaf %.2f \n&quot;</span>,Leaf);</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                        Rprintf(<span class="stringliteral">&quot;irtl %.2f \n&quot;</span>,irtl);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                        Rprintf(<span class="stringliteral">&quot;Rhizome %.2f \n&quot;</span>,Rhizome);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                        Rprintf(<span class="stringliteral">&quot;Sp %.2f \n&quot;</span>,Sp);   </div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                        Rprintf(<span class="stringliteral">&quot;doy[i] %.i %.i \n&quot;</span>,i,doy[i]); </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                        Rprintf(<span class="stringliteral">&quot;hr[i] %.i %.i \n&quot;</span>,i,hr[i]); </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                        Rprintf(<span class="stringliteral">&quot;solar[i] %.i %.2f \n&quot;</span>,i,solar[i]); </div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                        Rprintf(<span class="stringliteral">&quot;temp[i] %.i %.2f \n&quot;</span>,i,temp[i]); </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                        Rprintf(<span class="stringliteral">&quot;rh[i] %.i %.2f \n&quot;</span>,i,rh[i]); </div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                        Rprintf(<span class="stringliteral">&quot;windspeed[i] %.i %.2f \n&quot;</span>,i,windspeed[i]);</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                        Rprintf(<span class="stringliteral">&quot;lat %.i %.2f \n&quot;</span>,i,lat);</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                        Rprintf(<span class="stringliteral">&quot;nlayers %.i %.i \n&quot;</span>,i,nlayers);   </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                }</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                <span class="keywordflow">if</span>(soilLayers &gt; 1){</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                        soilMLS = <a class="code" href="_aux_bio_cro_8c.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a>(precip[i], CanopyT, &amp;cws[0], soilDepth, soilDepths, FieldC, WiltP,</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                                         phi1, phi2, soTexS, wsFun, soilLayers, Root,</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                                         LAI, 0.68, temp[i], solar[i], windspeed[i], rh[i], hydrDist,</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                                         secs[0], secs[1], secs[2]);</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                        StomWS = soilMLS.rcoefPhoto;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                        LeafWS = soilMLS.rcoefSpleaf;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                        soilEvap = soilMLS.SoilEvapo;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                        <span class="keywordflow">for</span>(i3=0;i3&lt;soilLayers;i3++){</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                                cws[i3] = soilMLS.cws[i3];</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                        }</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                        soilEvap = <a class="code" href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a>(LAI, 0.68, temp[i], solar[i], waterCont, FieldC, WiltP, windspeed[i], rh[i], secs[1]);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                        TotEvap = soilEvap + CanopyT;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                        WaterS = <a class="code" href="_aux_bio_cro_8c.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a>(precip[i],TotEvap,waterCont,soilDepth,FieldC,WiltP,phi1,phi2,soilType, wsFun);   </div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                        waterCont = WaterS.awc;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                        StomWS = WaterS.rcoefPhoto ;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                        LeafWS = WaterS.rcoefSpleaf;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                }</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                <span class="comment">/* Picking the dry biomass partitioning coefficients */</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                dbpS = <a class="code" href="_aux_bio_cro_8c.html#a4dc70ed4086616dabcbc7565d36d247b">sel_dbp_coef</a>(dbpcoefs, thermalp, TTc);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                kLeaf = dbpS.kLeaf;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                kStem = dbpS.kStem;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                kRoot = dbpS.kRoot;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                kRhizome = dbpS.kRhiz;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                kGrain = dbpS.kGrain;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                <span class="keywordflow">if</span>(ISNAN(kRhizome) || ISNAN(kLeaf) || ISNAN(kRoot) || ISNAN(kStem) || ISNAN(kGrain)){</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                        Rprintf(<span class="stringliteral">&quot;kLeaf %.2f, kStem %.2f, kRoot %.2f, kRhizome %.2f, kGrain %.2f \n&quot;</span>,kLeaf,kStem,kRoot,kRhizome,kGrain);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                        Rprintf(<span class="stringliteral">&quot;iter %i \n&quot;</span>,i);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                }</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                <span class="keywordflow">if</span>(i % 24*centTimestep == 0){</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                        LeafLitter_d = LeafLitter * ((0.1/30)*centTimestep);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                        StemLitter_d = StemLitter * ((0.1/30)*centTimestep);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                        RootLitter_d = RootLitter * ((0.1/30)*centTimestep);</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                        RhizomeLitter_d = RhizomeLitter * ((0.1/30)*centTimestep);</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;       </div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                        LeafLitter -= LeafLitter_d;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                        StemLitter -= StemLitter_d;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                        RootLitter -= RootLitter_d;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                        RhizomeLitter -= RhizomeLitter_d;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;       </div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                        centS = <a class="code" href="_bio_cro_8h.html#ab2c40f1d5cbe9760e48568b236467a16">Century</a>(&amp;LeafLitter_d,&amp;StemLitter_d,&amp;RootLitter_d,&amp;RhizomeLitter_d,</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                                        waterCont,temp[i],centTimestep,SCCs,WaterS.runoff,</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;                                        centcoefs[17], <span class="comment">/* N fertilizer*/</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;                                        MinNitro, <span class="comment">/* initial Mineral nitrogen */</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;                                        precip[i], <span class="comment">/* precipitation */</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;                                        centcoefs[9], <span class="comment">/* Leaf litter lignin */</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                                        centcoefs[10], <span class="comment">/* Stem litter lignin */</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                                        centcoefs[11], <span class="comment">/* Root litter lignin */</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                                        centcoefs[12], <span class="comment">/* Rhizome litter lignin */</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;                                        centcoefs[13], <span class="comment">/* Leaf litter N */</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                                        centcoefs[14], <span class="comment">/* Stem litter N */</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                                        centcoefs[15],  <span class="comment">/* Root litter N */</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                                        centcoefs[16],   <span class="comment">/* Rhizome litter N */</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                                        soilType, centks);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                }</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                <span class="comment">/* Here I can insert the code for Nitrogen limitations on photosynthesis</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment">                   parameters. This is taken From Harley et al. (1992) Modelling cotton under</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment">                   elevated CO2. PCE. This is modeled as a simple linear relationship between</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="comment">                   leaf nitrogen and vmax and alpha. Leaf Nitrogen should be modulated by N</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="comment">                   availability and possibly by the Thermal time accumulated.*/</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                MinNitro = centS.MinN;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                Resp = centS.Resp;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;     </div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                SCCs[0] = centS.SCs[0];</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                SCCs[1] = centS.SCs[1];</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                SCCs[2] = centS.SCs[2];</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                SCCs[3] = centS.SCs[3];</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                SCCs[4] = centS.SCs[4];</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                SCCs[5] = centS.SCs[5];</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                SCCs[6] = centS.SCs[6];</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                SCCs[7] = centS.SCs[7];</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                SCCs[8] = centS.SCs[8];</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                LeafN = LeafN_0 * exp(-kLN * TTc); </div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                vmax = (LeafN_0 - LeafN) * vmaxb1 + vmax1;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                alpha = (LeafN_0 - LeafN) * alphab1 + alpha1;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                <span class="keywordflow">if</span>(kLeaf &gt; 0)</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                {</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                        newLeaf = CanopyA * kLeaf * LeafWS ; </div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                        <span class="comment">/*  The major effect of water stress is on leaf expansion rate. See Boyer (1970)</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="comment">                            Plant. Phys. 46, 233-235. For this the water stress coefficient is different</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment">                            for leaf and vmax. */</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                        <span class="comment">/* Tissue respiration. See Amthor (1984) PCE 7, 561-*/</span> </div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                        <span class="comment">/* The 0.02 and 0.03 are constants here but vary depending on species</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">                           as pointed out in that reference. */</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                        newLeaf = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newLeaf, mrc1, temp[i]);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                        *(sti+i) = newLeaf; <span class="comment">/* This populates the vector newLeafcol. It makes sense</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="comment">                                               to use i because when kLeaf is negative no new leaf is</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="comment">                                               being accumulated and thus would not be subjected to senescence */</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                        newLeaf = Leaf * kLeaf ;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                        Rhizome += kRhizome * -newLeaf * 0.9; <span class="comment">/* 0.9 is the efficiency of retranslocation */</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                        Stem += kStem * -newLeaf   * 0.9;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                        Root += kRoot * -newLeaf * 0.9;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                        Grain += kGrain * -newLeaf * 0.9;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                }</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; SeneLeaf){</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                        Leaf += newLeaf;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                        Leaf += newLeaf - *(sti+k); <span class="comment">/* This means that the new value of leaf is</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="comment">                                                       the previous value plus the newLeaf</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="comment">                                                       (Senescence might start when there is</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">                                                       still leaf being produced) minus the leaf</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">                                                       produced at the corresponding k.*/</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                        Remob = *(sti+k) * 0.6 ;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                        LeafLitter += *(sti+k) * 0.4; <span class="comment">/* Collecting the leaf litter */</span> </div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                        Rhizome += kRhizome * Remob;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                        Stem += kStem * Remob; </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                        Root += kRoot * Remob;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                        Grain += kGrain * Remob;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                        k++;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                }</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                <span class="comment">/* The specific leaf area declines with the growing season at least in</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment">                   Miscanthus.  See Danalatos, Nalianis and Kyritsis &quot;Growth and Biomass</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="comment">                   Productivity of Miscanthus sinensis &quot;Giganteus&quot; under optimum cultural</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="comment">                   management in north-eastern greece*/</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                <span class="keywordflow">if</span>(i%24 == 0){</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                        Sp = iSp - (doy[i] - doy[0]) * SpD;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                }</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                <span class="comment">/* Rprintf(&quot;Sp %.2f \n&quot;, Sp); */</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                LAI = Leaf * Sp ;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                <span class="comment">/* New Stem*/</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                <span class="keywordflow">if</span>(kStem &gt; 0)</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                {</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                        newStem = CanopyA * kStem ;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                        newStem = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newStem, mrc1, temp[i]);</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                        *(sti2+i) = newStem;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                }</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; SeneStem){</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                        Stem += newStem;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                        Stem += newStem - *(sti2+q);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                        StemLitter += *(sti2+q);</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                        q++;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                }</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                <span class="keywordflow">if</span>(kRoot &gt; 0)</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                {</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                        newRoot = CanopyA * kRoot ;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                        newRoot = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newRoot, mrc2, temp[i]);</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                        *(sti3+i) = newRoot;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                        newRoot = Root * kRoot ;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                        Rhizome += kRhizome * -newRoot * 0.9;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                        Stem += kStem * -newRoot       * 0.9;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                        Leaf += kLeaf * -newRoot * 0.9;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                        Grain += kGrain * -newRoot * 0.9;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; SeneRoot){</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                        Root += newRoot;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                        Root += newRoot - *(sti3+m);</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                        RootLitter += *(sti3+m);</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                        m++;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                <span class="keywordflow">if</span>(kRhizome &gt; 0)</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                {</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                        newRhizome = CanopyA * kRhizome ;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                        newRhizome = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newRhizome, mrc2, temp[i]);</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                        *(sti4+ri) = newRhizome;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                        <span class="comment">/* Here i will not work because the rhizome goes from being a source</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="comment">                           to a sink. I need its own index. Let&#39;s call it rhizome&#39;s i or ri.*/</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                        ri++;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                        <span class="keywordflow">if</span>(Rhizome &lt; 0){</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                                Rhizome = 1e-4;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                                warning(<span class="stringliteral">&quot;Rhizome became negative&quot;</span>);</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                        }</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                        newRhizome = Rhizome * kRhizome;</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                        Root += kRoot * -newRhizome ;</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                        Stem += kStem * -newRhizome ;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                        Leaf += kLeaf * -newRhizome ;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                        Grain += kGrain * -newRhizome;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                }</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; SeneRhizome){</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                        Rhizome += newRhizome;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                }<span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                        Rhizome += newRhizome - *(sti4+n);</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                        RhizomeLitter += *(sti4+n);</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                        n++;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                }</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                <span class="keywordflow">if</span>((kGrain &lt; 1e-10) || (TTc &lt; thermalp[4])){</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                        newGrain = 0.0;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                        Grain += newGrain;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                        newGrain = CanopyA * kGrain;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                        <span class="comment">/* No respiration for grain at the moment */</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                        <span class="comment">/* No senescence either */</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                        Grain += newGrain;  </div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                }</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                ALitter += LeafLitter + StemLitter;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                BLitter += RootLitter + RhizomeLitter;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                CanopyAssim[i] =  CanopyA;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                Leafy[i] = Leaf;</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                Stemy[i] = Stem;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                Rooty[i] =  Root;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                Rhizomey[i] = Rhizome;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                Grainy[i] = Grain;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                LAIc[i] = LAI;</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;        }</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;}</div>
<div class="ttc" id="_bio_cro_8h_html_ab2c40f1d5cbe9760e48568b236467a16"><div class="ttname"><a href="_bio_cro_8h.html#ab2c40f1d5cbe9760e48568b236467a16">Century</a></div><div class="ttdeci">struct cenT_str Century(double *LeafL, double *StemL, double *RootL, double *RhizL, double smoist, double stemp, int timestep, double SCs[9], double leachWater, double Nfert, double MinN, double precip, double LeafL_Ln, double StemL_Ln, double RootL_Ln, double RhizL_Ln, double LeafL_N, double StemL_N, double RootL_N, double RhizL_N, int soilType, double Ks_cf[8])</div><div class="ttdef"><b>Definition:</b> Century.c:21</div></div>
<div class="ttc" id="_bio_cro_8h_html_a5b6e16664a459420103984ac5409b858"><div class="ttname"><a href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a></div><div class="ttdeci">double CanopyAssim[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:10</div></div>
<div class="ttc" id="structdbp__str_html"><div class="ttname"><a href="structdbp__str.html">dbp_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:85</div></div>
<div class="ttc" id="structws__str_html"><div class="ttname"><a href="structws__str.html">ws_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:48</div></div>
<div class="ttc" id="_bio_cro_8h_html_aa3741856cde2b5152c833b543abe77fc"><div class="ttname"><a href="_bio_cro_8h.html#aa3741856cde2b5152c833b543abe77fc">Rhizomey</a></div><div class="ttdeci">double Rhizomey[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:14</div></div>
<div class="ttc" id="_bio_cro_8h_html_ad6a54d6e671d04cd9b254a8cd1c3315c"><div class="ttname"><a href="_bio_cro_8h.html#ad6a54d6e671d04cd9b254a8cd1c3315c">Rooty</a></div><div class="ttdeci">double Rooty[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:13</div></div>
<div class="ttc" id="structsoil_text__str_html"><div class="ttname"><a href="structsoil_text__str.html">soilText_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:95</div></div>
<div class="ttc" id="_bio_cro_8h_html_ac656f07a64aeba7d6ac5a3a536e993c8"><div class="ttname"><a href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a></div><div class="ttdeci">double LAIc[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:16</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a8dfc137af141b612fc3cde9b49b0fc5f"><div class="ttname"><a href="_aux_bio_cro_8c.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a></div><div class="ttdeci">struct ws_str watstr(double precipit, double evapo, double cws, double soildepth, double fieldc, double wiltp, double phi1, double phi2, int soiltype, int wsFun)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:673</div></div>
<div class="ttc" id="structmaize__dbp__str_html_ac99cccaa39474eb44da7927824bf1590"><div class="ttname"><a href="structmaize__dbp__str.html#ac99cccaa39474eb44da7927824bf1590">maize_dbp_str::kLeaf</a></div><div class="ttdeci">double kLeaf</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:21</div></div>
<div class="ttc" id="_bio_cro_8h_html_a46f339721a905fe9e6f60af35ec11974"><div class="ttname"><a href="_bio_cro_8h.html#a46f339721a905fe9e6f60af35ec11974">Grainy</a></div><div class="ttdeci">double Grainy[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:15</div></div>
<div class="ttc" id="structmaize__dbp__str_html_a57b9aa759f801b0c771f3a90abecb73c"><div class="ttname"><a href="structmaize__dbp__str.html#a57b9aa759f801b0c771f3a90abecb73c">maize_dbp_str::kRoot</a></div><div class="ttdeci">double kRoot</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:23</div></div>
<div class="ttc" id="structsoil_m_l__str_html"><div class="ttname"><a href="structsoil_m_l__str.html">soilML_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:59</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a72f93049960e067cda6e7291ff1ff21a"><div class="ttname"><a href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a></div><div class="ttdeci">struct soilText_str soilTchoose(int soiltype)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1166</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_ad67c5b654f4bceb23717a84244291ea0"><div class="ttname"><a href="_aux_bio_cro_8c.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a></div><div class="ttdeci">struct Can_Str CanAC(double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Alpha, double Kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double StomataWS, int ws, double kd, double chil, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, struct nitroParms nitroP)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:539</div></div>
<div class="ttc" id="structmaize__dbp__str_html_a23cfdc1222afa011bc4171cb99aefad5"><div class="ttname"><a href="structmaize__dbp__str.html#a23cfdc1222afa011bc4171cb99aefad5">maize_dbp_str::kStem</a></div><div class="ttdeci">double kStem</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:22</div></div>
<div class="ttc" id="structcen_t__str_html"><div class="ttname"><a href="structcen_t__str.html">cenT_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:6</div></div>
<div class="ttc" id="structmaize__dbp__str_html_a99f7fe00ab60f353e0041e6bee822ce1"><div class="ttname"><a href="structmaize__dbp__str.html#a99f7fe00ab60f353e0041e6bee822ce1">maize_dbp_str::kGrain</a></div><div class="ttdeci">double kGrain</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:24</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a4dc70ed4086616dabcbc7565d36d247b"><div class="ttname"><a href="_aux_bio_cro_8c.html#a4dc70ed4086616dabcbc7565d36d247b">sel_dbp_coef</a></div><div class="ttdeci">struct dbp_str sel_dbp_coef(double coefs[25], double TherPrds[6], double TherTime)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1039</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a5537e2a57efaaf41b401666bb9e22062"><div class="ttname"><a href="_aux_bio_cro_8c.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a></div><div class="ttdeci">struct soilML_str soilML(double precipit, double transp, double *cws, double soildepth, double *depths, double fieldc, double wiltp, double phi1, double phi2, struct soilText_str soTexS, int wsFun, int layers, double rootDB, double LAI, double k, double AirTemp, double IRad, double winds, double RelH, int hydrDist, double rfl, double rsec, double rsdf)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:807</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_ac96acf762dd39d5ff20d71788b0ca566"><div class="ttname"><a href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a></div><div class="ttdeci">double SoilEvapo(double LAI, double k, double AirTemp, double IRad, double awc, double fieldc, double wiltp, double winds, double RelH, double rsec)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:412</div></div>
<div class="ttc" id="struct_can___str_html"><div class="ttname"><a href="struct_can___str.html">Can_Str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:41</div></div>
<div class="ttc" id="_bio_cro_8h_html_a929d2badff7fb301509012ee6e6a12e9"><div class="ttname"><a href="_bio_cro_8h.html#a929d2badff7fb301509012ee6e6a12e9">Stemy</a></div><div class="ttdeci">double Stemy[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:12</div></div>
<div class="ttc" id="_bio_cro_8h_html_abd2c9bad12951c887e8469151c778947"><div class="ttname"><a href="_bio_cro_8h.html#abd2c9bad12951c887e8469151c778947">Leafy</a></div><div class="ttdeci">double Leafy[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:11</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_aeb35169469ef33705592a28743d105bf"><div class="ttname"><a href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a></div><div class="ttdeci">double resp(double comp, double mrc, double temp)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1024</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acc47de00e88f05a80f60a9e599303902"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP MisGro </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>HR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOLAR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WINDSPEED</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>PRECIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CHILHF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NLAYERS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RHIZOME</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>IRTL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SENCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TIMESTEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VECSIZE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SPLEAF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>DBPCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>THERMALP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ALPHA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KPARM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>THETA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>BETA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CATM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>B0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>B1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ILEAFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VMAXB1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ALPHAB1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>MRESP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILTYPE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WSFUN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CENTCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CENTTIMESTEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CENTKS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILLAYERS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILDEPTHS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>HYDRDIST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SECS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KPLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LNB0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LNB1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LNFUN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>UPPERTEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LOWERTEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NNITROP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   <span class="comment">/*********** CROCENT VARIABLES***********************/</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <span class="keyword">struct </span><a class="code" href="structcropcentlayer.html">cropcentlayer</a> CROPCENT;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   <span class="comment">//assignParms(&amp;CROPCENT);</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <a class="code" href="_assigncropcent_8c.html#ad109903050f83c92d9d656f66b4f12a1">CROPCENTTimescaling</a>(&amp;CROPCENT);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//   assignPools(&amp;CROPCENT);</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <span class="keyword">struct </span><a class="code" href="struct_input_to_cropcent.html">InputToCropcent</a> *leaflitter,*stemlitter,*rootlitter,*rhizomelitter;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <span class="comment">/****************************************************/</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordtype">double</span> newLeafcol[8760];</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordtype">double</span> newStemcol[8760];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordtype">double</span> newRootcol[8760];</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordtype">double</span> newRhizomecol[8760];</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">/* This creates vectors which will collect the senesced plant</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">           material. This is needed to calculate litter and therefore carbon</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">           in the soil and then N in the soil. */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;         <span class="keywordtype">double</span> upperT=REAL(UPPERTEMP)[0];</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;         <span class="keywordtype">double</span> lowerT=REAL(LOWERTEMP)[0];</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">/*Reading NitroP Variables */</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keyword">struct </span><a class="code" href="structnitro_parms.html">nitroParms</a> nitroparms;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordtype">double</span> TEMPdoubletoint;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        nitroparms.<a class="code" href="structnitro_parms.html#a81548389d7bb414fbf85c27cc1df21ad">ileafN</a>=REAL(NNITROP)[0];</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  nitroparms.kln=REAL(NNITROP)[1];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        nitroparms.Vmaxb1=REAL(NNITROP)[2];</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        nitroparms.Vmaxb0=REAL(NNITROP)[3];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        nitroparms.alphab1=REAL(NNITROP)[4];</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        nitroparms.alphab0=REAL(NNITROP)[5];</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  nitroparms.Rdb1=REAL(NNITROP)[6];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        nitroparms.Rdb0=REAL(NNITROP)[7];</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        nitroparms.kpLN=REAL(NNITROP)[8];</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        nitroparms.lnb0=REAL(NNITROP)[9];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        nitroparms.lnb1=REAL(NNITROP)[10];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        TEMPdoubletoint=REAL(NNITROP)[11];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        nitroparms.lnFun=(int)TEMPdoubletoint;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        nitroparms.maxln=REAL(NNITROP)[12];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        nitroparms.minln=REAL(NNITROP)[13];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        nitroparms.daymaxln=REAL(NNITROP)[14];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">double</span> iSp, Sp , propLeaf;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordtype">int</span> i, i2, i3;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordtype">int</span> vecsize ;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordtype">double</span> vmax1;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordtype">double</span> alpha1;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordtype">double</span> kparm1;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordtype">double</span> theta;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordtype">double</span> beta;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordtype">double</span> Rd1, Ca;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordtype">double</span> b01, b11;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordtype">double</span> Leaf, Stem, Root, LAI, Grain = 0.0;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordtype">double</span> TTc = 0.0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordtype">double</span> kLeaf = 0.0, kStem = 0.0, kRoot = 0.0, kRhizome = 0.0, kGrain = 0.0;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordtype">double</span> newLeaf, newStem = 0.0, newRoot, newRhizome, newGrain = 0.0;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">/* Variables needed for collecting litter */</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordtype">double</span> LeafLitter = REAL(CENTCOEFS)[20], StemLitter = REAL(CENTCOEFS)[21];</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordtype">double</span> RootLitter = REAL(CENTCOEFS)[22], RhizomeLitter = REAL(CENTCOEFS)[23];</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordtype">double</span> LeafLitter_d = 0.0, StemLitter_d = 0.0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordtype">double</span> RootLitter_d = 0.0, RhizomeLitter_d = 0.0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordtype">double</span> ALitter = 0.0, BLitter = 0.0;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">/* Maintenance respiration */</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordtype">double</span> mrc1 = REAL(MRESP)[0];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordtype">double</span> mrc2 = REAL(MRESP)[1]; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordtype">double</span> waterCont;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordtype">double</span> StomWS = 1, LeafWS = 1;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordtype">int</span> timestep;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordtype">double</span> CanopyA, CanopyT;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordtype">double</span> Rhizome;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="comment">/* Soil Parameters*/</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordtype">double</span> FieldC, WiltP, phi1, phi2, soilDepth;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordtype">int</span> soilType, wsFun;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordtype">double</span> LeafN, LeafN_0, kLN;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordtype">double</span> soilEvap, TotEvap;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordtype">int</span> soillayers = INTEGER(SOILLAYERS)[0];</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordtype">double</span> cwsVec[soillayers];</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">for</span>(i2=0;i2&lt;soillayers;i2++){</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                cwsVec[i2] = REAL(CWS)[i2];</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordtype">double</span> cwsVecSum = 0.0;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="comment">/* Some soil related empirical coefficients */</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordtype">double</span> rfl = REAL(SECS)[0];  <span class="comment">/* root factor lambda */</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordtype">double</span> rsec = REAL(SECS)[1]; <span class="comment">/* radiation soil evaporation coefficient */</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordtype">double</span> rsdf = REAL(SECS)[2]; <span class="comment">/* root soil depth factor */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordtype">double</span> scsf = REAL(SOILCOEFS)[6]; <span class="comment">/* stomatal conductance sensitivity factor */</span> <span class="comment">/* Rprintf(&quot;scsf %.2f&quot;,scsf); */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordtype">double</span> transpRes = REAL(SOILCOEFS)[7]; <span class="comment">/* Resistance to transpiration from soil to leaf */</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordtype">double</span> leafPotTh = REAL(SOILCOEFS)[8]; <span class="comment">/* Leaf water potential threshold */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">/* Parameters for calculating leaf water potential */</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordtype">double</span> LeafPsim = 0.0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="comment">/* Effect of Nitrogen */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structnitro_parms.html#a89b04bb673ac5d9fd455e0b9317bdb83">kpLN</a> = REAL(KPLN)[0];</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structnitro_parms.html#a980c24e01e429167687e2ab6191f4175">lnb0</a> = REAL(LNB0)[0]; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structnitro_parms.html#a4020d72bf2f4de6d518eec319f123e2e">lnb1</a> = REAL(LNB1)[0];</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordtype">int</span> lnfun = INTEGER(LNFUN)[0];</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">/* Century */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordtype">double</span> MinNitro = REAL(CENTCOEFS)[19];</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordtype">int</span> doyNfert = REAL(CENTCOEFS)[18];</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordtype">double</span> Nfert;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordtype">double</span> SCCs[9];</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordtype">double</span> Resp = 0.0;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordtype">int</span> centTimestep = INTEGER(CENTTIMESTEP)[0];</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordtype">double</span> SeneLeaf, SeneStem, SeneRoot = 0.0, SeneRhizome = 0.0 ;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordtype">double</span> *sti , *sti2, *sti3, *sti4; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordtype">double</span> Remob;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordtype">int</span> k = 0, q = 0, m = 0, n = 0;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordtype">int</span> ri = 0;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> Canopy;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keyword">struct </span><a class="code" href="structws__str.html">ws_str</a> WaterS;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keyword">struct </span><a class="code" href="structdbp__str.html">dbp_str</a> dbpS;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keyword">struct </span><a class="code" href="structcen_t__str.html">cenT_str</a> centS; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keyword">struct </span><a class="code" href="structsoil_m_l__str.html">soilML_str</a> soilMLS;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> soTexS; <span class="comment">/* , *soTexSp = &amp;soTexS; */</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        soTexS = <a class="code" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a>(INTEGER(SOILTYPE)[0]);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        centS.SCs[0] = 0.0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        centS.SCs[1] = 0.0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        centS.SCs[2] = 0.0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        centS.SCs[3] = 0.0;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        centS.SCs[4] = 0.0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        centS.SCs[5] = 0.0;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        centS.SCs[6] = 0.0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        centS.SCs[7] = 0.0;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        centS.SCs[8] = 0.0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        centS.Resp = 0.0;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        SEXP lists, names;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        SEXP DayofYear;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        SEXP Hour;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        SEXP <a class="code" href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        SEXP CanopyTrans;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        SEXP <a class="code" href="_bio_cro_8h.html#abd2c9bad12951c887e8469151c778947">Leafy</a>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        SEXP <a class="code" href="_bio_cro_8h.html#a929d2badff7fb301509012ee6e6a12e9">Stemy</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        SEXP <a class="code" href="_bio_cro_8h.html#ad6a54d6e671d04cd9b254a8cd1c3315c">Rooty</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        SEXP <a class="code" href="_bio_cro_8h.html#aa3741856cde2b5152c833b543abe77fc">Rhizomey</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        SEXP <a class="code" href="_bio_cro_8h.html#a46f339721a905fe9e6f60af35ec11974">Grainy</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        SEXP <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        SEXP TTTc;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        SEXP SoilWatCont;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        SEXP StomatalCondCoefs;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        SEXP LeafReductionCoefs;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        SEXP LeafNitrogen;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        SEXP AboveLitter;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        SEXP BelowLitter;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        SEXP VmaxVec;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        SEXP AlphaVec;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        SEXP SpVec;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        SEXP MinNitroVec;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        SEXP RespVec;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        SEXP SoilEvaporation;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        SEXP cwsMat;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        SEXP psimMat; <span class="comment">/* Holds the soil water potential */</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        SEXP rdMat;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        SEXP SCpools;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        SEXP SNpools;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        SEXP LeafPsimVec;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        vecsize = length(DOY);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        PROTECT(lists = allocVector(VECSXP,29));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        PROTECT(names = allocVector(STRSXP,29));</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        PROTECT(DayofYear = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        PROTECT(Hour = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        PROTECT(CanopyAssim = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        PROTECT(CanopyTrans = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        PROTECT(Leafy = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        PROTECT(Stemy = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        PROTECT(Rooty = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        PROTECT(Rhizomey = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        PROTECT(Grainy = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        PROTECT(LAIc = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        PROTECT(TTTc = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        PROTECT(SoilWatCont = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        PROTECT(StomatalCondCoefs = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        PROTECT(LeafReductionCoefs = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        PROTECT(LeafNitrogen = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        PROTECT(AboveLitter = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        PROTECT(BelowLitter = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        PROTECT(VmaxVec = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        PROTECT(AlphaVec = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        PROTECT(SpVec = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        PROTECT(MinNitroVec = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        PROTECT(RespVec = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        PROTECT(SoilEvaporation = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        PROTECT(cwsMat = allocMatrix(REALSXP,soillayers,vecsize));</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        PROTECT(psimMat = allocMatrix(REALSXP,soillayers,vecsize));</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        PROTECT(rdMat = allocMatrix(REALSXP,soillayers,vecsize));</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        PROTECT(SCpools = allocVector(REALSXP,9));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        PROTECT(SNpools = allocVector(REALSXP,9));</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        PROTECT(LeafPsimVec = allocVector(REALSXP,vecsize));</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">/* Picking vmax, alpha and kparm */</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        vmax1 = REAL(VMAX)[0];</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        alpha1 = REAL(ALPHA)[0];</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        kparm1 = REAL(KPARM)[0];</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        theta = REAL(THETA)[0];</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        beta = REAL(BETA)[0];</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        Rd1 = REAL(RD)[0];</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        Ca = REAL(CATM)[0];</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        b01 = REAL(B0)[0];</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        b11 = REAL(B1)[0];</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        LeafN_0 = REAL(ILEAFN)[0];</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        LeafN = LeafN_0; <span class="comment">/* Initial value of N in the leaf */</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        kLN = REAL(KLN)[0];</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        timestep = INTEGER(TIMESTEP)[0];</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        Rhizome = REAL(RHIZOME)[0];</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        Sp = REAL(SPLEAF)[0]; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        SeneLeaf = REAL(SENCOEFS)[0];</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        SeneStem = REAL(SENCOEFS)[1];</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        SeneRoot = REAL(SENCOEFS)[2];</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        SeneRhizome = REAL(SENCOEFS)[3];</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="comment">/* Soil Parameters */</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        FieldC = REAL(SOILCOEFS)[0];</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        WiltP = REAL(SOILCOEFS)[1];</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        phi1 = REAL(SOILCOEFS)[2];</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        phi2 = REAL(SOILCOEFS)[3];</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        soilDepth = REAL(SOILCOEFS)[4];</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        waterCont = REAL(SOILCOEFS)[5];</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        wsFun = INTEGER(WSFUN)[0];</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        soilType = INTEGER(SOILTYPE)[0];</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        SCCs[0] = REAL(CENTCOEFS)[0];</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        SCCs[1] = REAL(CENTCOEFS)[1];</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        SCCs[2] = REAL(CENTCOEFS)[2];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        SCCs[3] = REAL(CENTCOEFS)[3];</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        SCCs[4] = REAL(CENTCOEFS)[4];</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        SCCs[5] = REAL(CENTCOEFS)[5];</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        SCCs[6] = REAL(CENTCOEFS)[6];</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        SCCs[7] = REAL(CENTCOEFS)[7];</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        SCCs[8] = REAL(CENTCOEFS)[8];</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        propLeaf = REAL(IRTL)[0]; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="comment">/* It is useful to assume that there is a small amount of</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">           leaf area at the begining of the growing season. */</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        Leaf = Rhizome * propLeaf; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">/* Initial proportion of the rhizome that is turned</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">           into leaf the first hour */</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        Stem = Rhizome * 0.001;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        Root = Rhizome * 0.001;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        LAI = Leaf * Sp;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        iSp = Sp;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">/* Creating pointers to avoid calling functions REAL and INTEGER so much */</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordtype">int</span> *pt_doy = INTEGER(DOY);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordtype">int</span> *pt_hr = INTEGER(HR);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordtype">double</span> *pt_solar = REAL(SOLAR);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordtype">double</span> *pt_temp = REAL(TEMP);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordtype">double</span> *pt_rh = REAL(RH);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordtype">double</span> *pt_windspeed = REAL(WINDSPEED);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordtype">double</span> *pt_precip = REAL(PRECIP);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordtype">double</span> lat = REAL(LAT)[0];</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordtype">int</span> nlayers = INTEGER(NLAYERS)[0];</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordtype">int</span> ws = INTEGER(WS)[0];</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordtype">double</span> kd = REAL(KD)[0];</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordtype">double</span> chil = REAL(CHILHF)[0];</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordtype">double</span> hf = REAL(CHILHF)[1];</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="comment">/* Creation of pointers outside the loop */</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        sti = &amp;newLeafcol[0]; <span class="comment">/* This creates sti to be a pointer to the position 0</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">                                 in the newLeafcol vector */</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        sti2 = &amp;newStemcol[0];</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        sti3 = &amp;newRootcol[0];</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        sti4 = &amp;newRhizomecol[0];</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">for</span>(i=0;i&lt;vecsize;i++)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <span class="comment">/* First calculate the elapsed Thermal Time*/</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <span class="comment">/* The idea is that here I need to divide by the time step</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">                   to calculate the thermal time. For example, a 3 hour time interval</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">                   would mean that the division would need to by 8 */</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                TTc += *(pt_temp+i) / (24/timestep); </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                REAL(TTTc)[i] = TTc;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="comment">/*  Do the magic! Calculate growth*/</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                Canopy = <a class="code" href="_aux_bio_cro_8c.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a>(LAI, *(pt_doy+i), *(pt_hr+i),</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                               *(pt_solar+i), *(pt_temp+i),</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                               *(pt_rh+i), *(pt_windspeed+i),</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                               lat, nlayers,</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                               vmax1,alpha1,kparm1,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                               theta,beta,Rd1,Ca,b01,b11,StomWS,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                               ws, kd,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                               chil, hf,LeafN, kpLN, lnb0, lnb1, lnfun,upperT,lowerT,nitroparms);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                <span class="comment">/* Collecting the results */</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                CanopyA = Canopy.Assim * timestep;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                CanopyT = Canopy.Trans * timestep;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                <span class="comment">/* Inserting the multilayer model */</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <span class="keywordflow">if</span>(soillayers &gt; 1){</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                        soilMLS = <a class="code" href="_aux_bio_cro_8c.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a>(*(pt_precip+i), CanopyT, &amp;cwsVec[0], soilDepth, REAL(SOILDEPTHS), FieldC, WiltP,</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                         phi1, phi2, soTexS, wsFun, INTEGER(SOILLAYERS)[0], Root, </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                         LAI, 0.68, *(pt_temp+i), *(pt_solar), *(pt_windspeed+i), *(pt_rh+i), </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                         INTEGER(HYDRDIST)[0], rfl, rsec, rsdf);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                        StomWS = soilMLS.rcoefPhoto;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                        LeafWS = soilMLS.rcoefSpleaf;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                        soilEvap = soilMLS.SoilEvapo;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        <span class="keywordflow">for</span>(i3=0;i3&lt;soillayers;i3++){</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                cwsVec[i3] = soilMLS.cws[i3];</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                cwsVecSum += cwsVec[i3];</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                REAL(cwsMat)[i3 + i*soillayers] = soilMLS.cws[i3];</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                                REAL(rdMat)[i3 + i*soillayers] = soilMLS.rootDist[i3];</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                        }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                        waterCont = cwsVecSum / soillayers;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                        cwsVecSum = 0.0;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        soilEvap = <a class="code" href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a>(LAI, 0.68, *(pt_temp+i), *(pt_solar+i), waterCont, FieldC, WiltP, </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                             *(pt_windspeed+i), *(pt_rh+i), rsec);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                        TotEvap = soilEvap + CanopyT;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        WaterS = <a class="code" href="_aux_bio_cro_8c.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a>(*(pt_precip+i),TotEvap,waterCont,soilDepth,FieldC,WiltP,phi1,phi2,soilType, wsFun);   </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                        waterCont = WaterS.awc;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                        StomWS = WaterS.rcoefPhoto ; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                        LeafWS = WaterS.rcoefSpleaf;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                        REAL(cwsMat)[i] = waterCont;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                        REAL(psimMat)[i] = WaterS.psim;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">/* An alternative way of computing water stress is by doing the leaf</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"> * water potential. This is done if the wsFun is equal to 4 */</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                <span class="keywordflow">if</span>(wsFun == 4){</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                        <span class="comment">/* Calculating the leaf water potential */</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        <span class="comment">/* From Campbell E = (Psim_s - Psim_l)/R or</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">                         * evaporation is equal to the soil water potential</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">                         * minus the leaf water potential divided by the resistance.</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">                         * This can be rearranged to Psim_l = Psim_s - E x R   */</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        <span class="comment">/* It is assumed that total resistance is 5e6 m^4 s^-1</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">                         * kg^-1 </span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">                         * Transpiration is in Mg ha-2 hr-1</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">                         * Multiply by 1e3 to go from Mg to kg</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">                         * Multiply by 1e-4 to go from ha to m^2 </span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">                         * This needs to go from hours to seconds that&#39;s</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">                         * why the conversion factor is (1/3600).*/</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                        LeafPsim = WaterS.psim - (CanopyT * 1e3 * 1e-4 * 1.0/3600.0) * transpRes;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                        <span class="comment">/* From WIMOVAVC the proposed equation to simulate the effect of water</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">                         * stress on stomatal conductance */</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                        <span class="keywordflow">if</span>(LeafPsim &lt; leafPotTh){</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                <span class="comment">/* StomWS = 1 - ((LeafPsim - leafPotTh)/1000 *</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">                                 * scsf); In WIMOVAC this equation is used but</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">                                 * the absolute values are taken from the</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">                                 * potentials. Since they both should be</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">                                 * negative and leafPotTh is greater than</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">                                 * LeafPsim this can be rearranged to*/</span> </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                StomWS = 1 - ((leafPotTh - LeafPsim)/1000 * scsf);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                <span class="comment">/* StomWS = 1; */</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                <span class="keywordflow">if</span>(StomWS &lt; 0.1) StomWS = 0.1;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                StomWS = 1;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                        }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                        LeafPsim = 0;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <span class="comment">/* Picking the dry biomass partitioning coefficients */</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                dbpS = <a class="code" href="_aux_bio_cro_8c.html#a4dc70ed4086616dabcbc7565d36d247b">sel_dbp_coef</a>(REAL(DBPCOEFS), REAL(THERMALP), TTc);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                kLeaf = dbpS.kLeaf;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                kStem = dbpS.kStem;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                kRoot = dbpS.kRoot;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                kRhizome = dbpS.kRhiz;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                kGrain = dbpS.kGrain;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                <span class="comment">/* Nitrogen fertilizer */</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                <span class="comment">/* Only the day in which the fertilizer was applied this is available */</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">/* When the day of the year is equal to the day the N fert was applied</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"> * then there is addition of fertilizer */</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <span class="keywordflow">if</span>(doyNfert == *(pt_doy+i)){</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                        Nfert = REAL(CENTCOEFS)[17] / 24.0;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                        Nfert = 0;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                }                </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;     </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="comment">/* Here I can insert the code for Nitrogen limitations on photosynthesis</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">                   parameters. This is taken From Harley et al. (1992) Modelling cotton under</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">                   elevated CO2. PCE. This is modeled as a simple linear relationship between</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">                   leaf nitrogen and vmax and alpha. Leaf Nitrogen should be modulated by N</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">                   availability and possibly by the Thermal time accumulated.*/</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">/* The approach that seems to be used in general is N concentration as</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment"> * a function of biomass */</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                LeafN = LeafN_0 * pow(Stem + Leaf,-kLN); </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="keywordflow">if</span>(LeafN &gt; LeafN_0) LeafN = LeafN_0;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                vmax1 = (LeafN_0 - LeafN) * REAL(VMAXB1)[0] + REAL(VMAX)[0]; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                alpha1 = (LeafN_0 - LeafN) * REAL(ALPHAB1)[0] + REAL(ALPHA)[0]; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                 <span class="comment">/* The crop demand for nitrogen is the leaf concentration times the amount of biomass.</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">                   This modifies the amount of N available in the soil. </span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">                   MinNitro is the available amount of N (kg/m2). </span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">                   The demand is in Mg/ha. I need a conversion factor of </span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">                   multiply by 1000, divide by 10000. */</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                MinNitro = MinNitro - LeafN * (Stem + Leaf) * 1e-1;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <span class="keywordflow">if</span>(MinNitro &lt; 0) MinNitro = 1e-3;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                <span class="keywordflow">if</span>(kLeaf &gt; 0)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                        newLeaf = CanopyA * kLeaf * LeafWS ; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                        <span class="comment">/*  The major effect of water stress is on leaf expansion rate. See Boyer (1970)</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">                            Plant. Phys. 46, 233-235. For this the water stress coefficient is different</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">                            for leaf and vmax. */</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                        <span class="comment">/* Tissue respiration. See Amthor (1984) PCE 7, 561-*/</span> </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                        <span class="comment">/* The 0.02 and 0.03 are constants here but vary depending on species</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">                           as pointed out in that reference. */</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                        newLeaf = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newLeaf, mrc1, *(pt_temp+i));</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                        *(sti+i) = newLeaf; <span class="comment">/* This populates the vector newLeafcol. It makes sense</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">                                               to use i because when kLeaf is negative no new leaf is</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">                                               being accumulated and thus would not be subjected to senescence */</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                        newLeaf = Leaf * kLeaf ;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                        Rhizome += kRhizome * -newLeaf * 0.9; <span class="comment">/* 0.9 is the efficiency of retranslocation */</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                        Stem += kStem * -newLeaf   * 0.9;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                        Root += kRoot * -newLeaf * 0.9;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        Grain += kGrain * -newLeaf * 0.9;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; SeneLeaf){</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                        Leaf += newLeaf;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                        Leaf += newLeaf - *(sti+k); <span class="comment">/* This means that the new value of leaf is</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">                                                       the previous value plus the newLeaf</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">                                                       (Senescence might start when there is</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">                                                       still leaf being produced) minus the leaf</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">                                                       produced at the corresponding k.*/</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                        Remob = *(sti+k) * 0.6 ;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                        LeafLitter += *(sti+k) * 0.4; <span class="comment">/* Collecting the leaf litter */</span> </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                        Rhizome += kRhizome * Remob;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                        Stem += kStem * Remob; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                        Root += kRoot * Remob;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                        Grain += kGrain * Remob;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                        k++;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                <span class="comment">/* The specific leaf area declines with the growing season at least in</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">                   Miscanthus.  See Danalatos, Nalianis and Kyritsis &quot;Growth and Biomass</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">                   Productivity of Miscanthus sinensis &quot;Giganteus&quot; under optimum cultural</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">                   management in north-eastern greece*/</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                <span class="keywordflow">if</span>(i%24 == 0){</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                        Sp = iSp - (INTEGER(DOY)[i] - INTEGER(DOY)[0]) * REAL(SPD)[0];</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                LAI = Leaf * Sp ;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                <span class="keywordflow">if</span>(LAI &gt; 20.0) LAI = 20.0;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                <span class="comment">/* New Stem*/</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                <span class="keywordflow">if</span>(kStem &gt;= 0)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                        newStem = CanopyA * kStem ;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                        newStem = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newStem, mrc1, *(pt_temp+i));</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                        *(sti2+i) = newStem;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                        error(<span class="stringliteral">&quot;kStem should be positive&quot;</span>);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; SeneStem){</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                        Stem += newStem;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                        Stem += newStem - *(sti2+q);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                        StemLitter += *(sti2+q);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                        q++;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                <span class="keywordflow">if</span>(kRoot &gt; 0)</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                        newRoot = CanopyA * kRoot ;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                        newRoot = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newRoot, mrc2, *(pt_temp+i));</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                        *(sti3+i) = newRoot;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                        newRoot = Root * kRoot ;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                        Rhizome += kRhizome * -newRoot * 0.9;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                        Stem += kStem * -newRoot       * 0.9;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                        Leaf += kLeaf * -newRoot * 0.9;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                        Grain += kGrain * -newRoot * 0.9;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; SeneRoot){</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                        Root += newRoot;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                        Root += newRoot - *(sti3+m);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                        RootLitter += *(sti3+m);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                        m++;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                <span class="keywordflow">if</span>(kRhizome &gt; 0)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                        newRhizome = CanopyA * kRhizome ;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                        newRhizome = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newRhizome, mrc2, *(pt_temp+i));</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                        *(sti4+ri) = newRhizome;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                        <span class="comment">/* Here i will not work because the rhizome goes from being a source</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">                           to a sink. I need its own index. Let&#39;s call it rhizome&#39;s i or ri.*/</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                        ri++;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                        <span class="keywordflow">if</span>(Rhizome &lt; 0){</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                Rhizome = 1e-4;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                warning(<span class="stringliteral">&quot;Rhizome became negative&quot;</span>);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                        }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                        newRhizome = Rhizome * kRhizome;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                        Root += kRoot * -newRhizome ;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                        Stem += kStem * -newRhizome ;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                        Leaf += kLeaf * -newRhizome ;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                        Grain += kGrain * -newRhizome;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; SeneRhizome){</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                        Rhizome += newRhizome;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                }<span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                        Rhizome += newRhizome - *(sti4+n);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                        RhizomeLitter += *(sti4+n);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                        n++;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                <span class="keywordflow">if</span>((kGrain &lt; 1e-10) || (TTc &lt; REAL(THERMALP)[4])){</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        newGrain = 0.0;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                        Grain += newGrain;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                        newGrain = CanopyA * kGrain;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                        <span class="comment">/* No respiration for grain at the moment */</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                        <span class="comment">/* No senescence either */</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                        Grain += newGrain;  </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">/****************************************************************************</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">// CROPCENT SIMULATION BEGINS HHERE    </span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">BiocroToCrocent(&amp;LeafLitter,leaf.fallrate,leaf.lignin, &amp;leaf.E, isotoperatio, 1, 0,leaflitter);</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">BiocroToCrocent(&amp;StemLitter,stem.fallrate,stem.lignin, &amp;stem.E, isotoperatio, 1, 0,stemlitter);</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">BiocroToCrocent(&amp;RootLitter,root.fallrate,root.lignin, &amp;root.E, isotoperatio, 0, 0,rootlitter);</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">BiocroToCrocent(&amp;RhizomeLitter,rhiz.fallrate,rhiz.lignin, &amp;rhiz.E, isotoperatio, 0, 0,rhizomelitter);</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">***************************************************************************/</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   <span class="keywordflow">if</span>(i % 24*centTimestep == 0){</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                        LeafLitter_d = LeafLitter * ((0.1/30)*centTimestep);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                        StemLitter_d = StemLitter * ((0.1/30)*centTimestep);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                        RootLitter_d = RootLitter * ((0.1/30)*centTimestep);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                        RhizomeLitter_d = RhizomeLitter * ((0.1/30)*centTimestep);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                        LeafLitter -= LeafLitter_d;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                        StemLitter -= StemLitter_d;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                        RootLitter -= RootLitter_d;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                        RhizomeLitter -= RhizomeLitter_d;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                        centS = <a class="code" href="_bio_cro_8h.html#ab2c40f1d5cbe9760e48568b236467a16">Century</a>(&amp;LeafLitter_d,&amp;StemLitter_d,&amp;RootLitter_d,&amp;RhizomeLitter_d,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                                        waterCont,*(pt_temp+i),centTimestep,SCCs,WaterS.runoff,</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                                        Nfert, <span class="comment">/* N fertilizer*/</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                        MinNitro, <span class="comment">/* initial Mineral nitrogen */</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                                        *(pt_precip+i), <span class="comment">/* precipitation */</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                        REAL(CENTCOEFS)[9], <span class="comment">/* Leaf litter lignin */</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                                        REAL(CENTCOEFS)[10], <span class="comment">/* Stem litter lignin */</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                        REAL(CENTCOEFS)[11], <span class="comment">/* Root litter lignin */</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                        REAL(CENTCOEFS)[12], <span class="comment">/* Rhizome litter lignin */</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                        REAL(CENTCOEFS)[13], <span class="comment">/* Leaf litter N */</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                        REAL(CENTCOEFS)[14], <span class="comment">/* Stem litter N */</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                        REAL(CENTCOEFS)[15],  <span class="comment">/* Root litter N */</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                        REAL(CENTCOEFS)[16],   <span class="comment">/* Rhizome litter N */</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                                        soilType, </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                        REAL(CENTKS));</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                MinNitro = centS.MinN; <span class="comment">/* These should be kg / m^2 per week? */</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                Resp = centS.Resp;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                SCCs[0] = centS.SCs[0];</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                SCCs[1] = centS.SCs[1];</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                SCCs[2] = centS.SCs[2];</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                SCCs[3] = centS.SCs[3];</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                SCCs[4] = centS.SCs[4];</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                SCCs[5] = centS.SCs[5];</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                SCCs[6] = centS.SCs[6];</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                SCCs[7] = centS.SCs[7];</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                SCCs[8] = centS.SCs[8];</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                ALitter = LeafLitter + StemLitter;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                BLitter = RootLitter + RhizomeLitter;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <span class="comment">/* Here I could add a soil and nitrogen carbon component. I have soil</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">                   moisture, I have temperature and root and rhizome biomass */</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                REAL(DayofYear)[i] =  INTEGER(DOY)[i];</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                REAL(Hour)[i] =  INTEGER(HR)[i];</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                REAL(CanopyAssim)[i] =  CanopyA;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                REAL(CanopyTrans)[i] =  CanopyT; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                REAL(Leafy)[i] = Leaf;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                REAL(Stemy)[i] = Stem;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                REAL(Rooty)[i] =  Root;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                REAL(Rhizomey)[i] = Rhizome;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                REAL(Grainy)[i] = Grain;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                REAL(LAIc)[i] = LAI;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                REAL(SoilWatCont)[i] = waterCont;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                REAL(StomatalCondCoefs)[i] = StomWS;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                REAL(LeafReductionCoefs)[i] = LeafWS;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                REAL(LeafNitrogen)[i] = LeafN;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                REAL(AboveLitter)[i] = ALitter;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                REAL(BelowLitter)[i] = BLitter;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                REAL(VmaxVec)[i] = vmax1;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                REAL(AlphaVec)[i] = alpha1;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                REAL(SpVec)[i] = Sp;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                REAL(MinNitroVec)[i] = MinNitro/ (24*centTimestep);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                REAL(RespVec)[i] = Resp / (24*centTimestep);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                REAL(SoilEvaporation)[i] = soilEvap;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                REAL(LeafPsimVec)[i] = LeafPsim;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">/* Populating the results of the Century model */</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                REAL(SCpools)[0] = centS.SCs[0];</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                REAL(SCpools)[1] = centS.SCs[1];</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                REAL(SCpools)[2] = centS.SCs[2];</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                REAL(SCpools)[3] = centS.SCs[3];</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                REAL(SCpools)[4] = centS.SCs[4];</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                REAL(SCpools)[5] = centS.SCs[5];</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                REAL(SCpools)[6] = centS.SCs[6];</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                REAL(SCpools)[7] = centS.SCs[7];</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                REAL(SCpools)[8] = centS.SCs[8];</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                REAL(SNpools)[0] = centS.SNs[0];</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                REAL(SNpools)[1] = centS.SNs[1];</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                REAL(SNpools)[2] = centS.SNs[2];</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                REAL(SNpools)[3] = centS.SNs[3];</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                REAL(SNpools)[4] = centS.SNs[4];</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                REAL(SNpools)[5] = centS.SNs[5];</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                REAL(SNpools)[6] = centS.SNs[6];</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                REAL(SNpools)[7] = centS.SNs[7];</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                REAL(SNpools)[8] = centS.SNs[8];</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        SET_VECTOR_ELT(lists,0,DayofYear);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        SET_VECTOR_ELT(lists,1,Hour);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        SET_VECTOR_ELT(lists,2,CanopyAssim);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        SET_VECTOR_ELT(lists,3,CanopyTrans);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        SET_VECTOR_ELT(lists,4,Leafy);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        SET_VECTOR_ELT(lists,5,Stemy);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        SET_VECTOR_ELT(lists,6,Rooty);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        SET_VECTOR_ELT(lists,7,Rhizomey);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        SET_VECTOR_ELT(lists,8,Grainy);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        SET_VECTOR_ELT(lists,9,LAIc);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        SET_VECTOR_ELT(lists,10,TTTc);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        SET_VECTOR_ELT(lists,11,SoilWatCont);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        SET_VECTOR_ELT(lists,12,StomatalCondCoefs);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        SET_VECTOR_ELT(lists,13,LeafReductionCoefs);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        SET_VECTOR_ELT(lists,14,LeafNitrogen);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        SET_VECTOR_ELT(lists,15,AboveLitter);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        SET_VECTOR_ELT(lists,16,BelowLitter);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        SET_VECTOR_ELT(lists,17,VmaxVec);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        SET_VECTOR_ELT(lists,18,AlphaVec);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        SET_VECTOR_ELT(lists,19,SpVec);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        SET_VECTOR_ELT(lists,20,MinNitroVec);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        SET_VECTOR_ELT(lists,21,RespVec);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        SET_VECTOR_ELT(lists,22,SoilEvaporation);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        SET_VECTOR_ELT(lists,23,cwsMat);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        SET_VECTOR_ELT(lists,24,psimMat);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        SET_VECTOR_ELT(lists,25,rdMat);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        SET_VECTOR_ELT(lists,26,SCpools);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        SET_VECTOR_ELT(lists,27,SNpools);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        SET_VECTOR_ELT(lists,28,LeafPsimVec);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        SET_STRING_ELT(names,0,mkChar(<span class="stringliteral">&quot;DayofYear&quot;</span>));</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        SET_STRING_ELT(names,1,mkChar(<span class="stringliteral">&quot;Hour&quot;</span>));</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        SET_STRING_ELT(names,2,mkChar(<span class="stringliteral">&quot;CanopyAssim&quot;</span>));</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        SET_STRING_ELT(names,3,mkChar(<span class="stringliteral">&quot;CanopyTrans&quot;</span>));</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        SET_STRING_ELT(names,4,mkChar(<span class="stringliteral">&quot;Leaf&quot;</span>));</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        SET_STRING_ELT(names,5,mkChar(<span class="stringliteral">&quot;Stem&quot;</span>));</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        SET_STRING_ELT(names,6,mkChar(<span class="stringliteral">&quot;Root&quot;</span>));</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        SET_STRING_ELT(names,7,mkChar(<span class="stringliteral">&quot;Rhizome&quot;</span>));</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        SET_STRING_ELT(names,8,mkChar(<span class="stringliteral">&quot;Grain&quot;</span>));</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        SET_STRING_ELT(names,9,mkChar(<span class="stringliteral">&quot;LAI&quot;</span>));</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        SET_STRING_ELT(names,10,mkChar(<span class="stringliteral">&quot;ThermalT&quot;</span>));</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        SET_STRING_ELT(names,11,mkChar(<span class="stringliteral">&quot;SoilWatCont&quot;</span>));</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        SET_STRING_ELT(names,12,mkChar(<span class="stringliteral">&quot;StomatalCondCoefs&quot;</span>));</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        SET_STRING_ELT(names,13,mkChar(<span class="stringliteral">&quot;LeafReductionCoefs&quot;</span>));</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        SET_STRING_ELT(names,14,mkChar(<span class="stringliteral">&quot;LeafNitrogen&quot;</span>));</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        SET_STRING_ELT(names,15,mkChar(<span class="stringliteral">&quot;AboveLitter&quot;</span>));</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        SET_STRING_ELT(names,16,mkChar(<span class="stringliteral">&quot;BelowLitter&quot;</span>));</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        SET_STRING_ELT(names,17,mkChar(<span class="stringliteral">&quot;VmaxVec&quot;</span>));</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        SET_STRING_ELT(names,18,mkChar(<span class="stringliteral">&quot;AlphaVec&quot;</span>));</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        SET_STRING_ELT(names,19,mkChar(<span class="stringliteral">&quot;SpVec&quot;</span>));</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        SET_STRING_ELT(names,20,mkChar(<span class="stringliteral">&quot;MinNitroVec&quot;</span>));</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        SET_STRING_ELT(names,21,mkChar(<span class="stringliteral">&quot;RespVec&quot;</span>));</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        SET_STRING_ELT(names,22,mkChar(<span class="stringliteral">&quot;SoilEvaporation&quot;</span>));</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        SET_STRING_ELT(names,23,mkChar(<span class="stringliteral">&quot;cwsMat&quot;</span>));</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        SET_STRING_ELT(names,24,mkChar(<span class="stringliteral">&quot;psimMat&quot;</span>));</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        SET_STRING_ELT(names,25,mkChar(<span class="stringliteral">&quot;rdMat&quot;</span>));</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        SET_STRING_ELT(names,26,mkChar(<span class="stringliteral">&quot;SCpools&quot;</span>));</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        SET_STRING_ELT(names,27,mkChar(<span class="stringliteral">&quot;SNpools&quot;</span>));</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        SET_STRING_ELT(names,28,mkChar(<span class="stringliteral">&quot;LeafPsimVec&quot;</span>));</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        setAttrib(lists,R_NamesSymbol,names);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        UNPROTECT(31);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keywordflow">return</span>(lists);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;}</div>
<div class="ttc" id="_bio_cro_8h_html_ab2c40f1d5cbe9760e48568b236467a16"><div class="ttname"><a href="_bio_cro_8h.html#ab2c40f1d5cbe9760e48568b236467a16">Century</a></div><div class="ttdeci">struct cenT_str Century(double *LeafL, double *StemL, double *RootL, double *RhizL, double smoist, double stemp, int timestep, double SCs[9], double leachWater, double Nfert, double MinN, double precip, double LeafL_Ln, double StemL_Ln, double RootL_Ln, double RhizL_Ln, double LeafL_N, double StemL_N, double RootL_N, double RhizL_N, int soilType, double Ks_cf[8])</div><div class="ttdef"><b>Definition:</b> Century.c:21</div></div>
<div class="ttc" id="_bio_cro_8h_html_a5b6e16664a459420103984ac5409b858"><div class="ttname"><a href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a></div><div class="ttdeci">double CanopyAssim[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:10</div></div>
<div class="ttc" id="structdbp__str_html"><div class="ttname"><a href="structdbp__str.html">dbp_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:85</div></div>
<div class="ttc" id="_assigncropcent_8c_html_ad109903050f83c92d9d656f66b4f12a1"><div class="ttname"><a href="_assigncropcent_8c.html#ad109903050f83c92d9d656f66b4f12a1">CROPCENTTimescaling</a></div><div class="ttdeci">void CROPCENTTimescaling(struct cropcentlayer *CROPCENT)</div><div class="ttdef"><b>Definition:</b> Assigncropcent.c:419</div></div>
<div class="ttc" id="structcropcentlayer_html"><div class="ttname"><a href="structcropcentlayer.html">cropcentlayer</a></div><div class="ttdef"><b>Definition:</b> crocent.h:516</div></div>
<div class="ttc" id="structnitro_parms_html_a980c24e01e429167687e2ab6191f4175"><div class="ttname"><a href="structnitro_parms.html#a980c24e01e429167687e2ab6191f4175">nitroParms::lnb0</a></div><div class="ttdeci">double lnb0</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:138</div></div>
<div class="ttc" id="struct_input_to_cropcent_html"><div class="ttname"><a href="struct_input_to_cropcent.html">InputToCropcent</a></div><div class="ttdef"><b>Definition:</b> crocent.h:107</div></div>
<div class="ttc" id="structnitro_parms_html"><div class="ttname"><a href="structnitro_parms.html">nitroParms</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:128</div></div>
<div class="ttc" id="structws__str_html"><div class="ttname"><a href="structws__str.html">ws_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:48</div></div>
<div class="ttc" id="_bio_cro_8h_html_aa3741856cde2b5152c833b543abe77fc"><div class="ttname"><a href="_bio_cro_8h.html#aa3741856cde2b5152c833b543abe77fc">Rhizomey</a></div><div class="ttdeci">double Rhizomey[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:14</div></div>
<div class="ttc" id="_bio_cro_8h_html_ad6a54d6e671d04cd9b254a8cd1c3315c"><div class="ttname"><a href="_bio_cro_8h.html#ad6a54d6e671d04cd9b254a8cd1c3315c">Rooty</a></div><div class="ttdeci">double Rooty[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:13</div></div>
<div class="ttc" id="structsoil_text__str_html"><div class="ttname"><a href="structsoil_text__str.html">soilText_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:95</div></div>
<div class="ttc" id="_bio_cro_8h_html_ac656f07a64aeba7d6ac5a3a536e993c8"><div class="ttname"><a href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a></div><div class="ttdeci">double LAIc[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:16</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a8dfc137af141b612fc3cde9b49b0fc5f"><div class="ttname"><a href="_aux_bio_cro_8c.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a></div><div class="ttdeci">struct ws_str watstr(double precipit, double evapo, double cws, double soildepth, double fieldc, double wiltp, double phi1, double phi2, int soiltype, int wsFun)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:673</div></div>
<div class="ttc" id="_bio_cro_8h_html_a46f339721a905fe9e6f60af35ec11974"><div class="ttname"><a href="_bio_cro_8h.html#a46f339721a905fe9e6f60af35ec11974">Grainy</a></div><div class="ttdeci">double Grainy[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:15</div></div>
<div class="ttc" id="structsoil_m_l__str_html"><div class="ttname"><a href="structsoil_m_l__str.html">soilML_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:59</div></div>
<div class="ttc" id="structnitro_parms_html_a81548389d7bb414fbf85c27cc1df21ad"><div class="ttname"><a href="structnitro_parms.html#a81548389d7bb414fbf85c27cc1df21ad">nitroParms::ileafN</a></div><div class="ttdeci">double ileafN</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:129</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a72f93049960e067cda6e7291ff1ff21a"><div class="ttname"><a href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a></div><div class="ttdeci">struct soilText_str soilTchoose(int soiltype)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1166</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_ad67c5b654f4bceb23717a84244291ea0"><div class="ttname"><a href="_aux_bio_cro_8c.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a></div><div class="ttdeci">struct Can_Str CanAC(double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Alpha, double Kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double StomataWS, int ws, double kd, double chil, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, struct nitroParms nitroP)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:539</div></div>
<div class="ttc" id="structnitro_parms_html_a89b04bb673ac5d9fd455e0b9317bdb83"><div class="ttname"><a href="structnitro_parms.html#a89b04bb673ac5d9fd455e0b9317bdb83">nitroParms::kpLN</a></div><div class="ttdeci">double kpLN</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:137</div></div>
<div class="ttc" id="structcen_t__str_html"><div class="ttname"><a href="structcen_t__str.html">cenT_str</a></div><div class="ttdef"><b>Definition:</b> Century.h:6</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a4dc70ed4086616dabcbc7565d36d247b"><div class="ttname"><a href="_aux_bio_cro_8c.html#a4dc70ed4086616dabcbc7565d36d247b">sel_dbp_coef</a></div><div class="ttdeci">struct dbp_str sel_dbp_coef(double coefs[25], double TherPrds[6], double TherTime)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1039</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a5537e2a57efaaf41b401666bb9e22062"><div class="ttname"><a href="_aux_bio_cro_8c.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a></div><div class="ttdeci">struct soilML_str soilML(double precipit, double transp, double *cws, double soildepth, double *depths, double fieldc, double wiltp, double phi1, double phi2, struct soilText_str soTexS, int wsFun, int layers, double rootDB, double LAI, double k, double AirTemp, double IRad, double winds, double RelH, int hydrDist, double rfl, double rsec, double rsdf)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:807</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_ac96acf762dd39d5ff20d71788b0ca566"><div class="ttname"><a href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a></div><div class="ttdeci">double SoilEvapo(double LAI, double k, double AirTemp, double IRad, double awc, double fieldc, double wiltp, double winds, double RelH, double rsec)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:412</div></div>
<div class="ttc" id="struct_can___str_html"><div class="ttname"><a href="struct_can___str.html">Can_Str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:41</div></div>
<div class="ttc" id="structnitro_parms_html_a4020d72bf2f4de6d518eec319f123e2e"><div class="ttname"><a href="structnitro_parms.html#a4020d72bf2f4de6d518eec319f123e2e">nitroParms::lnb1</a></div><div class="ttdeci">double lnb1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:139</div></div>
<div class="ttc" id="_bio_cro_8h_html_a929d2badff7fb301509012ee6e6a12e9"><div class="ttname"><a href="_bio_cro_8h.html#a929d2badff7fb301509012ee6e6a12e9">Stemy</a></div><div class="ttdeci">double Stemy[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:12</div></div>
<div class="ttc" id="_bio_cro_8h_html_abd2c9bad12951c887e8469151c778947"><div class="ttname"><a href="_bio_cro_8h.html#abd2c9bad12951c887e8469151c778947">Leafy</a></div><div class="ttdeci">double Leafy[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:11</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_aeb35169469ef33705592a28743d105bf"><div class="ttname"><a href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a></div><div class="ttdeci">double resp(double comp, double mrc, double temp)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1024</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a140e2632f0a9a79a801fcbea03b7740d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double RSS_BG </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oStem</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oLeaf</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oRoot</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oRhizome</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oGrain</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oLAI</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sStem</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sLeaf</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sRoot</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sRhizome</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sGrain</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sLAI</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N1Dat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                        {</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        <span class="keywordtype">double</span> diff1=0.0, RSS1=0.0, SST1=0.0;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        <span class="keywordtype">double</span> diff2=0.0, RSS2=0.0, SST2=0.0;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        <span class="keywordtype">double</span> diff3=0.0, RSS3=0.0, SST3=0.0;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        <span class="keywordtype">double</span> diff4=0.0, RSS4=0.0, SST4=0.0; </div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        <span class="keywordtype">double</span> diff5=0.0, RSS5=0.0, SST5=0.0;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <span class="keywordtype">double</span> diff6=0.0, RSS6=0.0, SST6=0.0;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        <span class="keywordtype">double</span> RSS=0.0;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <span class="keywordflow">for</span>(i = 0 ; i &lt; N1Dat; i++){</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                <span class="comment">/* Stem */</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                <span class="keywordflow">if</span>(oStem[i] &gt;= 0){</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                        SST1 += pow(oStem[i],2);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                        diff1 = oStem[i] - sStem[i];</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                        RSS1 += pow(diff1,2);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                }</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                <span class="comment">/* Leaf */</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                <span class="keywordflow">if</span>(oLeaf[i] &gt;= 0){</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                        SST2 += pow(oLeaf[i],2);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                        diff2 = oLeaf[i] - sLeaf[i];</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                        RSS2 += pow(diff2,2);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                }</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                <span class="comment">/* Rhizome */</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                <span class="keywordflow">if</span>(oRhizome[i] &gt;= 0){</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                        SST3 += pow(oRhizome[i],2);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                        diff3 = oRhizome[i] - sRhizome[i];</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                        RSS3 += pow(diff3,2);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                <span class="comment">/* Root */</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                <span class="keywordflow">if</span>(oRoot[i] &gt;= 0){</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                        SST4 += pow(oRoot[i],2);</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                        diff4 = oRoot[i] - sRoot[i];</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                        RSS4 += pow(diff4,2);</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                <span class="comment">/* LAI */</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                <span class="keywordflow">if</span>(oLAI[i] &gt;= 0){</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                        SST5 += pow(oLAI[i],2);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                        diff5 = oLAI[i] - sLAI[i];</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                        RSS5 += pow(diff5,2);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                <span class="keywordflow">if</span>(oGrain[i] &gt;= 0){</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                        SST6 += pow(oGrain[i],2);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                        diff6 = oGrain[i] - sGrain[i];</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                        RSS6 += pow(diff6,2);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                }</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        RSS = RSS1 + RSS2 + RSS3 + RSS4 + RSS5 + RSS6;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="keywordflow">return</span>(RSS);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad26763269c44e2d53306e4de98a180f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP SABioGro </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oTHERMAL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oSTEM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oLEAF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oROOT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oRHIZOME</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oGRAIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oLAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>HR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOLAR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WINDSPEED</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>PRECIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>DBPCOEF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VECSIZE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NLAYERS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RHIZOMEIRTL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SENESCTIME</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TIMESTEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ALPHA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KPARM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>THETA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>BETA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CATM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>B0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>B1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WSFUN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ILEAFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VMAXB1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ALPHAB1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>MRESP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILTYPE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CENTCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CENTKS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CENTTIMESTEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CHILHF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>THERMALP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>INDEX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NDATA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>N1DAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NITER</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NITER2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SATEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>COOLSAMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SCALE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>PHEN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILLAYERS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILDEPTHS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>HYDRDIST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SECS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LNFUN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>UPPERTEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LOWERTEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NNITROP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;{</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;       </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="comment">// compatibility with CanAC to pass alpha parameters</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;       <span class="keyword">struct </span><a class="code" href="structnitro_parms.html">nitroParms</a> nitroparms;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordtype">double</span> TEMPdoubletoint;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        nitroparms.<a class="code" href="structnitro_parms.html#a81548389d7bb414fbf85c27cc1df21ad">ileafN</a>=REAL(NNITROP)[0];</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        nitroparms.kln=REAL(NNITROP)[1];</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        nitroparms.Vmaxb1=REAL(NNITROP)[2];</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        nitroparms.Vmaxb0=REAL(NNITROP)[3];</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        nitroparms.alphab1=REAL(NNITROP)[4];</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        nitroparms.alphab0=REAL(NNITROP)[5];</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        nitroparms.Rdb1=REAL(NNITROP)[6];</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        nitroparms.Rdb0=REAL(NNITROP)[7];</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        nitroparms.kpLN=REAL(NNITROP)[8];</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        nitroparms.lnb0=REAL(NNITROP)[9];</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        nitroparms.lnb1=REAL(NNITROP)[10];</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        TEMPdoubletoint=REAL(NNITROP)[11];</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        nitroparms.lnFun=(int)TEMPdoubletoint;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        nitroparms.maxln=REAL(NNITROP)[12];</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        nitroparms.minln=REAL(NNITROP)[13];</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        nitroparms.daymaxln=REAL(NNITROP)[14];</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="comment">/* External variables */</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a>[8760] ;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#abd2c9bad12951c887e8469151c778947">Leafy</a>[8760] ;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#a929d2badff7fb301509012ee6e6a12e9">Stemy</a>[8760] ;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ad6a54d6e671d04cd9b254a8cd1c3315c">Rooty</a>[8760] ;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#aa3741856cde2b5152c833b543abe77fc">Rhizomey</a>[8760] ;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#a46f339721a905fe9e6f60af35ec11974">Grainy</a>[8760] ;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>[8760] ;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="comment">/* Index variables */</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordtype">int</span> j,k,m;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="keywordtype">int</span> niter, niter2, iters = 0, iters2 = 0;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordtype">int</span> accept = 0;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordtype">int</span> n1 = 0, n2 = 0;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordtype">double</span> upperT=REAL(UPPERTEMP)[0];</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keywordtype">double</span> lowerT=REAL(LOWERTEMP)[0];</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="comment">/* The all important vector size */</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordtype">int</span> vecsize;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        vecsize = INTEGER(VECSIZE)[0];</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordtype">int</span> Ndat;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="keywordtype">int</span> n1dat = 0;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        Ndat = INTEGER(NDATA)[0];</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        niter = INTEGER(NITER)[0];</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        niter2 = INTEGER(NITER2)[0];</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordtype">double</span> saTemp;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <span class="keywordtype">int</span> coolSamp;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordtype">double</span> scale;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="keywordtype">int</span> phen;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        saTemp = REAL(SATEMP)[0];</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        coolSamp = INTEGER(COOLSAMP)[0];</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        scale = REAL(SCALE)[0];</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        phen = INTEGER(PHEN)[0];</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordtype">int</span> timestep;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="keywordtype">double</span> b0, b1;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordtype">double</span> vmaxb1, <a class="code" href="structnitro_parms.html#aaf784159d7555e9af103853d7d096b77">alphab1</a>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keywordtype">double</span> LeafN, kLN, Ca;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        b0 = REAL(B0)[0];</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        b1 = REAL(B1)[0];</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        timestep = INTEGER(TIMESTEP)[0];</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        alphab1 = REAL(ALPHAB1)[0];</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        vmaxb1 = REAL(VMAXB1)[0];</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        LeafN = REAL(ILEAFN)[0];</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        kLN = REAL(KLN)[0];</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="comment">/* Needed variables */</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordtype">double</span> lati, <a class="code" href="structrhizome.html">rhizome</a>, irtl;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="keywordtype">int</span> nlayers;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="comment">/* Creating vectors */</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordtype">double</span> dbpcoef[25];</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="comment">/* Picking the simulation */</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordtype">int</span> ind;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keywordtype">double</span> sCanopyAssim[Ndat], sStemy[Ndat], sLeafy[Ndat];</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordtype">double</span> sRhizomey[Ndat], sRooty[Ndat], sGrainy[Ndat],  sLAIy[Ndat];</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordtype">double</span> oStemy[Ndat], oLeafy[Ndat];</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keywordtype">double</span> oRhizomey[Ndat], oRooty[Ndat], oGrainy[Ndat], oLAIy[Ndat];</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="comment">/* more vairbles */</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordtype">double</span> rss = 0.0, oldRss;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordtype">double</span> U , mr;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="comment">/* Yet more */</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keywordtype">double</span> index = 0;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="keywordtype">double</span> sd1 = REAL(SD)[0];</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordtype">double</span> sd2 = REAL(SD)[1];</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordtype">double</span> sd3 = REAL(SD)[2];</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordtype">double</span> sd4 = REAL(SD)[3];</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="keywordtype">double</span> kLeaf_1, kStem_1, kRoot_1, kRhizome_1;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <span class="keywordtype">double</span> kLeaf_2, kStem_2, kRoot_2, kRhizome_2;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="keywordtype">double</span> kLeaf_3, kStem_3, kRoot_3, kRhizome_3;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="keywordtype">double</span> kLeaf_4, kStem_4, kRoot_4, kRhizome_4;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordtype">double</span> kLeaf_5, kStem_5, kRoot_5, kRhizome_5;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="keywordtype">double</span> kLeaf_6, kStem_6, kRoot_6, kRhizome_6, kGrain_6;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="keywordtype">double</span> k1, k2, k3, k4, k5, k6;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keywordtype">double</span> vmax, alpha, kparm, theta, beta, Rd;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keywordtype">double</span> oldkLeaf_1, oldkStem_1, oldkRhizome_1, oldkRoot_1;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordtype">double</span> oldkLeaf_2, oldkStem_2, oldkRhizome_2, oldkRoot_2;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="keywordtype">double</span> oldkLeaf_3, oldkStem_3, oldkRhizome_3, oldkRoot_3;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordtype">double</span> oldkLeaf_4, oldkStem_4, oldkRhizome_4, oldkRoot_4;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="keywordtype">double</span> oldkLeaf_5, oldkStem_5, oldkRhizome_5, oldkRoot_5;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordtype">double</span> oldkLeaf_6, oldkStem_6, oldkRhizome_6, oldkRoot_6, oldkGrain_6;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="comment">/* Handling answers to pass to R*/</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        SEXP lists;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        SEXP names;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        SEXP ans1;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        SEXP RSS;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        SEXP ACCPT;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        SEXP RssVec;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        SEXP RssVec2;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        SEXP simStem;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        SEXP obsStem;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        SEXP simLeaf;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        SEXP obsLeaf;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        SEXP simRhiz;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        SEXP obsRhiz;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        SEXP simRoot;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        SEXP obsRoot;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        SEXP simGrain;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        SEXP obsGrain;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        SEXP simLAI;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        SEXP obsLAI;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        SEXP TTime;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        SEXP inde;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        SEXP mat1;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        SEXP accept2;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        SEXP accept3;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        SEXP SAtemp;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        PROTECT(lists = allocVector(VECSXP,23)); <span class="comment">/* 1 */</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        PROTECT(names = allocVector(STRSXP,23)); <span class="comment">/* 2 */</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        PROTECT(ans1 = allocVector(REALSXP,25)); <span class="comment">/* 3 */</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        PROTECT(RSS = allocVector(REALSXP,1)); <span class="comment">/* 4 */</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        PROTECT(ACCPT = allocVector(REALSXP,1)); <span class="comment">/* 5 */</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        PROTECT(RssVec = allocVector(REALSXP,niter)); <span class="comment">/* 6 */</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        PROTECT(RssVec2 = allocVector(REALSXP,niter2)); <span class="comment">/* 7 */</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        PROTECT(simStem = allocVector(REALSXP,Ndat)); <span class="comment">/* 8 */</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        PROTECT(obsStem = allocVector(REALSXP,Ndat)); <span class="comment">/* 9 */</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        PROTECT(simLeaf = allocVector(REALSXP,Ndat)); <span class="comment">/* 10 */</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        PROTECT(obsLeaf = allocVector(REALSXP,Ndat)); <span class="comment">/* 11 */</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        PROTECT(simRhiz = allocVector(REALSXP,Ndat)); <span class="comment">/* 12 */</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        PROTECT(obsRhiz = allocVector(REALSXP,Ndat)); <span class="comment">/* 13 */</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        PROTECT(simRoot = allocVector(REALSXP,Ndat)); <span class="comment">/* 14 */</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        PROTECT(obsRoot = allocVector(REALSXP,Ndat)); <span class="comment">/* 15 */</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        PROTECT(simGrain = allocVector(REALSXP,Ndat)); <span class="comment">/* 16 */</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        PROTECT(obsGrain = allocVector(REALSXP,Ndat)); <span class="comment">/* 17 */</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        PROTECT(simLAI = allocVector(REALSXP,Ndat)); <span class="comment">/* 18 */</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        PROTECT(obsLAI = allocVector(REALSXP,Ndat)); <span class="comment">/* 19 */</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        PROTECT(TTime = allocVector(REALSXP,Ndat)); <span class="comment">/* 20 */</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        PROTECT(inde = allocVector(REALSXP,Ndat)); <span class="comment">/* 21 */</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        PROTECT(mat1 = allocMatrix(REALSXP,25,niter2)); <span class="comment">/* 22 */</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        PROTECT(accept2 = allocVector(REALSXP,1)); <span class="comment">/* 23 */</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        PROTECT(accept3 = allocVector(REALSXP,1)); <span class="comment">/* 24 */</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        PROTECT(SAtemp = allocVector(REALSXP,1)); <span class="comment">/* 25 */</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <span class="comment">/* Applying the scale to the sd */</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        sd1 *= scale;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        sd2 *= scale;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        sd3 *= scale;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        sd4 *= scale;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="comment">/* Picking them */</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        lati = REAL(LAT)[0];</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        rhizome = REAL(RHIZOMEIRTL)[0];</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        irtl = REAL(RHIZOMEIRTL)[1];</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        nlayers = INTEGER(NLAYERS)[0];</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        Rd = REAL(RD)[0];</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        Ca = REAL(CATM)[0];</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        vmax = REAL(VMAX)[0];</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        alpha = REAL(ALPHA)[0];</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        kparm = REAL(KPARM)[0];</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        theta = REAL(THETA)[0];</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        beta = REAL(BETA)[0];</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="comment">/* Pick the observed */</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <span class="keywordflow">for</span>(m=0;m&lt;Ndat;m++){</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                oStemy[m] = REAL(oSTEM)[m];</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                REAL(obsStem)[m] = REAL(oSTEM)[m];</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                oLeafy[m] = REAL(oLEAF)[m];</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                REAL(obsLeaf)[m] = REAL(oLEAF)[m];</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                oRhizomey[m] = REAL(oRHIZOME)[m];</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                REAL(obsRhiz)[m] = REAL(oRHIZOME)[m];</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                oRooty[m] = REAL(oROOT)[m];</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                REAL(obsRoot)[m] = REAL(oROOT)[m];</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                oGrainy[m] = REAL(oGRAIN)[m];</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                REAL(obsGrain)[m] = REAL(oGRAIN)[m];</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                oLAIy[m] = REAL(oLAI)[m];</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                REAL(obsLAI)[m] = REAL(oLAI)[m];</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        oldkLeaf_1 = REAL(DBPCOEF)[0];</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        oldkStem_1 = REAL(DBPCOEF)[1];</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        oldkRoot_1 = REAL(DBPCOEF)[2];</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        oldkRhizome_1 = REAL(DBPCOEF)[3];</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        oldkLeaf_2 = REAL(DBPCOEF)[4];</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        oldkStem_2 = REAL(DBPCOEF)[5];</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        oldkRoot_2 = REAL(DBPCOEF)[6];</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        oldkRhizome_2 = REAL(DBPCOEF)[7];</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        oldkLeaf_3 = REAL(DBPCOEF)[8];</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        oldkStem_3 = REAL(DBPCOEF)[9];</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        oldkRoot_3 = REAL(DBPCOEF)[10];</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        oldkRhizome_3 = REAL(DBPCOEF)[11];</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        oldkLeaf_4 = REAL(DBPCOEF)[12];</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        oldkStem_4 = REAL(DBPCOEF)[13];</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        oldkRoot_4 = REAL(DBPCOEF)[14];</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        oldkRhizome_4 = REAL(DBPCOEF)[15];</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        oldkLeaf_5 = REAL(DBPCOEF)[16];</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        oldkStem_5 = REAL(DBPCOEF)[17];</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        oldkRoot_5 = REAL(DBPCOEF)[18];</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        oldkRhizome_5 = REAL(DBPCOEF)[19];</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        oldkLeaf_6 = REAL(DBPCOEF)[20];</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        oldkStem_6 = REAL(DBPCOEF)[21];</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        oldkRoot_6 = REAL(DBPCOEF)[22];</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        oldkRhizome_6 = REAL(DBPCOEF)[23];</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        oldkGrain_6 = REAL(DBPCOEF)[24];</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        GetRNGstate();</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        oldRss = 1e6;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="comment">/* This is a good part to start the optimization */</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="comment">/* determining the n1dat */</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        n1dat = INTEGER(N1DAT)[phen-1];</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="keywordflow">for</span>(iters=0;iters&lt;niter;iters++){</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="comment">/* Selecting the index to sample */</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                index = <a class="code" href="_bio_cro_8c.html#a054d5ae3a62e6217a0d4e5093b79bb25">sel_phen</a>(phen);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <span class="comment">/* First phenological stage */</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                kLeaf_1 = fabs(oldkLeaf_1);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                kStem_1 = fabs(oldkStem_1);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                kRoot_1 = fabs(oldkRoot_1);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                <span class="keywordflow">if</span>(index &lt; 1){</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                        kLeaf_1 = fabs(rnorm(kLeaf_1,sd1));</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                }<span class="keywordflow">else</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                        </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                        <span class="keywordflow">if</span>(index &lt; 2){</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                                kStem_1 = fabs(rnorm(kStem_1,sd1));</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                        }<span class="keywordflow">else</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                                <span class="keywordflow">if</span>(index &lt; 3){</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                                        kRoot_1 = fabs(rnorm(kRoot_1,sd1));</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                                }</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                k1 = kLeaf_1 + kStem_1 + kRoot_1;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                kLeaf_1 = kLeaf_1/k1;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                kStem_1 = kStem_1/k1;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                kRoot_1 = kRoot_1/k1;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                <span class="keywordflow">if</span>(index &gt; 3 &amp;&amp; index &lt; 4){</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                        kRhizome_1 = -rnorm(fabs(oldkRhizome_1),sd2);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                        kRhizome_1 = -fabs(oldkRhizome_1);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                <span class="comment">/* Second phenological stage */</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                kLeaf_2 = fabs(oldkLeaf_2);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                kStem_2 = fabs(oldkStem_2);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                kRoot_2 = fabs(oldkRoot_2);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                <span class="keywordflow">if</span>(index &gt; 4 &amp;&amp; index &lt; 5){</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                        kLeaf_2 = fabs(rnorm(kLeaf_2,sd1));</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                <span class="keywordflow">if</span>(index &gt; 5 &amp;&amp; index &lt; 6){</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                        kStem_2 = fabs(rnorm(kStem_2,sd1));</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                <span class="keywordflow">if</span>(index &gt; 6 &amp;&amp; index &lt; 7){</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                        kRoot_2 = fabs(rnorm(kRoot_2,sd1));</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                }</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                k2 = kLeaf_2 + kStem_2 + kRoot_2 ;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                kLeaf_2 =  kLeaf_2/k2 ;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                kStem_2 = kStem_2/k2 ;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                kRoot_2 = kRoot_2/k2 ;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                <span class="keywordflow">if</span>(index &gt; 7 &amp;&amp; index &lt; 8){</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                        kRhizome_2 =-rnorm(fabs(oldkRhizome_2),sd2);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                        kRhizome_2 =-fabs(oldkRhizome_2);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                <span class="comment">/* Third phenological stage */</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                kLeaf_3 = fabs(oldkLeaf_3);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                kStem_3 = fabs(oldkStem_3);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                kRoot_3 = fabs(oldkRoot_3);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                kRhizome_3 = fabs(oldkRhizome_3);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                <span class="keywordflow">if</span>(index &gt; 8 &amp;&amp; index &lt; 9){</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                        kLeaf_3 = fabs(rnorm(kLeaf_3,sd1));</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                <span class="keywordflow">if</span>(index &gt; 9 &amp;&amp; index &lt; 10){</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                        kStem_3 = fabs(rnorm(kStem_3,sd1));</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                <span class="keywordflow">if</span>(index &gt; 10 &amp;&amp; index &lt; 11){</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                        kRoot_3 = fabs(rnorm(kRoot_3,sd1));</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                <span class="keywordflow">if</span>(index &gt; 11 &amp;&amp; index &lt; 12){</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                        kRhizome_3 = fabs(rnorm(kRhizome_3,sd1));</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                }</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                k3 = kLeaf_3 + kStem_3 + kRoot_3 + kRhizome_3;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                kLeaf_3 =  kLeaf_3/k3 ;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                kStem_3 = kStem_3/k3 ;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                kRoot_3 = kRoot_3/k3 ;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                kRhizome_3 = kRhizome_3/k3 ;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                <span class="comment">/* Fourth phenological stage */</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                kLeaf_4 = fabs(oldkLeaf_4);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                kStem_4 = fabs(oldkStem_4);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                kRoot_4 = fabs(oldkRoot_4);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                kRhizome_4 = fabs(oldkRhizome_4);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                <span class="keywordflow">if</span>(index &gt; 12 &amp;&amp; index &lt; 13){</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                        kLeaf_4 = fabs(rnorm(kLeaf_4,sd1));</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                }</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                <span class="keywordflow">if</span>(index &gt; 13 &amp;&amp; index &lt; 14){</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                        kStem_4 = fabs(rnorm(kStem_4,sd1));</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                <span class="keywordflow">if</span>(index &gt; 14 &amp;&amp; index &lt; 15){</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                        kRoot_4 = fabs(rnorm(kRoot_4,sd1));</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                <span class="keywordflow">if</span>(index &gt; 15 &amp;&amp; index &lt; 16){</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                        kRhizome_4 = fabs(rnorm(kRhizome_4,sd1));</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                }</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                k4 = kLeaf_4 + kStem_4 + kRoot_4 + kRhizome_4;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                kLeaf_4 =  kLeaf_4/k4 ;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                kStem_4 = kStem_4/k4 ;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                kRoot_4 = kRoot_4/k4 ;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                kRhizome_4 = kRhizome_4/k4 ;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                <span class="comment">/* Fifth phenological stage */</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                kLeaf_5 = fabs(oldkLeaf_5);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                kStem_5 = fabs(oldkStem_5);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                kRoot_5 = fabs(oldkRoot_5);</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                kRhizome_5 = fabs(oldkRhizome_5);</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                <span class="keywordflow">if</span>(index &gt; 16 &amp;&amp; index &lt; 17){</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                        kLeaf_5 = fabs(rnorm(kLeaf_5,sd1));</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                }</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                <span class="keywordflow">if</span>(index &gt; 17 &amp;&amp; index &lt; 18){</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                        kStem_5 = fabs(rnorm(kStem_5,sd1));</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                }</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                <span class="keywordflow">if</span>(index &gt; 18 &amp;&amp; index &lt; 19){</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                        kRoot_5 = fabs(rnorm(kRoot_5,sd1));</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                <span class="keywordflow">if</span>(index &gt; 19 &amp;&amp; index &lt; 20){</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                        kRhizome_5 = fabs(rnorm(kRhizome_5,sd1));</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                k5 = kLeaf_5 + kStem_5 + kRoot_5 + kRhizome_5;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                kLeaf_5 =  kLeaf_5/k5;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                kStem_5 = kStem_5/k5;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                kRoot_5 = kRoot_5/k5;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                kRhizome_5 = kRhizome_5/k5;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                <span class="comment">/* Sixth phenological stage */</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                kLeaf_6 = fabs(oldkLeaf_6);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                kStem_6 = fabs(oldkStem_6);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                kRoot_6 = fabs(oldkRoot_6);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                kRhizome_6 = fabs(oldkRhizome_6);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                kGrain_6 = fabs(oldkGrain_6);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                <span class="keywordflow">if</span>(index &gt; 20 &amp;&amp; index &lt; 21){</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                        kLeaf_6 = fabs(rnorm(kLeaf_6,sd1));</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                }</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                <span class="keywordflow">if</span>(index &gt; 21 &amp;&amp; index &lt; 22){</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                        kStem_6 = fabs(rnorm(kStem_6,sd1));</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                <span class="keywordflow">if</span>(index &gt; 22 &amp;&amp; index &lt; 23){</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                        kRoot_6 = fabs(rnorm(kRoot_6,sd1));</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                }</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                <span class="keywordflow">if</span>(index &gt; 23 &amp;&amp; index &lt; 24){</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                        kRhizome_6 = fabs(rnorm(kRhizome_6,sd1));</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                <span class="keywordflow">if</span>(index &gt; 24 &amp;&amp; index &lt; 25){</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                        kGrain_6 = fabs(rnorm(kGrain_6,sd1));</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                k6 = kLeaf_6 + kStem_6 + kRoot_6 + kRhizome_6 + kGrain_6;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                kLeaf_6 =  kLeaf_6 / k6;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                kStem_6 = kStem_6 / k6;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                kRoot_6 = kRoot_6 / k6;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                kRhizome_6 = kRhizome_6 / k6;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                kGrain_6 = kGrain_6 / k6;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">/* Populating the dbp coefficients */</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                dbpcoef[0] = kLeaf_1;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                dbpcoef[1] = kStem_1;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                dbpcoef[2] = kRoot_1;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                dbpcoef[3] = kRhizome_1;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                dbpcoef[4] = kLeaf_2;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                dbpcoef[5] = kStem_2;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                dbpcoef[6] = kRoot_2;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                dbpcoef[7] = kRhizome_2;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                dbpcoef[8] = kLeaf_3;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                dbpcoef[9] = kStem_3;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                dbpcoef[10] = kRoot_3;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                dbpcoef[11] = kRhizome_3;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                dbpcoef[12] = kLeaf_4;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                dbpcoef[13] = kStem_4;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                dbpcoef[14] = kRoot_4;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                dbpcoef[15] = kRhizome_4;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                dbpcoef[16] = kLeaf_5;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                dbpcoef[17] = kStem_5;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                dbpcoef[18] = kRoot_5;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                dbpcoef[19] = kRhizome_5;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                dbpcoef[20] = kLeaf_6;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                dbpcoef[21] = kStem_6;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                dbpcoef[22] = kRoot_6;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                dbpcoef[23] = kRhizome_6;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                dbpcoef[24] = kGrain_6;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                <span class="comment">/* int p; */</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                <span class="comment">/* for(p = 0;p&lt;25;p++){ */</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                <span class="comment">/*      Rprintf(&quot;dbpcoef %.i %.3f \n&quot;,p,dbpcoef[p]); */</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                <span class="comment">/* } */</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                <a class="code" href="_bio_cro_8c.html#aa289681c71425537eb6fccb7ae92962a">BioGro</a>(lati,INTEGER(DOY),INTEGER(HR),REAL(SOLAR),REAL(TEMP),REAL(RH),</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                       REAL(WINDSPEED),REAL(PRECIP), REAL(KD)[0], REAL(CHILHF)[0], </div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                       REAL(CHILHF)[1],nlayers,rhizome,</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                       irtl,REAL(SENESCTIME),INTEGER(TIMESTEP)[0],vecsize,</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                       REAL(SP)[0], REAL(SPD)[0], dbpcoef, REAL(THERMALP),</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                       vmax,alpha,kparm,theta,beta,Rd,Ca,b0,b1, REAL(SOILCOEFS), LeafN, kLN,</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                       vmaxb1, alphab1, REAL(MRESP), INTEGER(SOILTYPE)[0], INTEGER(WSFUN)[0],</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                       INTEGER(WS)[0], REAL(CENTCOEFS),REAL(CENTKS), INTEGER(CENTTIMESTEP)[0],</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                       INTEGER(SOILLAYERS)[0], REAL(SOILDEPTHS), REAL(CWS), INTEGER(HYDRDIST)[0], </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                       REAL(SECS), REAL(NCOEFS)[0], REAL(NCOEFS)[1], REAL(NCOEFS)[2], INTEGER(LNFUN)[0],upperT,lowerT,nitroparms);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                <span class="comment">/* pick the needed elements for the SSE */</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                <span class="keywordflow">for</span>(k=0;k&lt;Ndat;k++){</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                        ind = INTEGER(INDEX)[k];</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                        sCanopyAssim[k] = CanopyAssim[ind]; <span class="comment">/* Rprintf(&quot;CanopyAssim %.i %.1f \n&quot;,ind,CanopyAssim[ind]); */</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                        sLeafy[k] = Leafy[ind]; <span class="comment">/* Rprintf(&quot;Leafy %.i %.1f \n&quot;,ind,Leafy[ind]); */</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                        sStemy[k] = Stemy[ind]; <span class="comment">/* Rprintf(&quot;Stemy %.i %.1f \n&quot;,ind,Stemy[ind]); */</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                        sRooty[k] = Rooty[ind]; <span class="comment">/* Rprintf(&quot;Rooty %.i %.1f \n&quot;,ind,Rooty[ind]); */</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                        sRhizomey[k] = Rhizomey[ind]; <span class="comment">/* Rprintf(&quot;Rhizomey %.i %.1f \n&quot;,ind,Rhizomey[ind]); */</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                        sGrainy[k] = Grainy[ind]; <span class="comment">/* Rprintf(&quot;Grainy %.i %.1f \n&quot;,ind,Grainy[ind]); */</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                        sLAIy[k] = LAIc[ind]; <span class="comment">/* Rprintf(&quot;LAIc %.i %.1f \n&quot;,ind,LAIc[ind]); */</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                }</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                rss = <a class="code" href="_bio_cro_8c.html#a140e2632f0a9a79a801fcbea03b7740d">RSS_BG</a>(oStemy,oLeafy,oRooty,oRhizomey,oGrainy,oLAIy,</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                             sStemy,sLeafy,sRooty,sRhizomey,sGrainy,sLAIy,</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                             n1dat);</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                REAL(RssVec)[iters] = rss;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                U = runif(0,1);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                <span class="keywordflow">if</span>(rss &lt; (oldRss - saTemp *log(U))){</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                        accept++;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                        oldRss = rss;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                        <span class="keywordflow">if</span>((accept%coolSamp)==0){</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                                saTemp *= 0.9 ;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                        }</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                        <span class="comment">/* accept the coefficients */</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                        oldkLeaf_1 = dbpcoef[0];</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                        oldkStem_1 = dbpcoef[1];</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                        oldkRoot_1 = dbpcoef[2];</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                        oldkRhizome_1 = dbpcoef[3];</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                        oldkLeaf_2 = dbpcoef[4];</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                        oldkStem_2 = dbpcoef[5];</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                        oldkRoot_2 = dbpcoef[6];</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                        oldkRhizome_2 = dbpcoef[7];</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                        oldkLeaf_3 = dbpcoef[8];</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                        oldkStem_3 = dbpcoef[9];</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                        oldkRoot_3 = dbpcoef[10];</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                        oldkRhizome_3 = dbpcoef[11];</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                        oldkLeaf_4 = dbpcoef[12];</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                        oldkStem_4 = dbpcoef[13];</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                        oldkRoot_4 = dbpcoef[14];</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                        oldkRhizome_4 = dbpcoef[15];</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                        oldkLeaf_5 = dbpcoef[16];</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                        oldkStem_5 = dbpcoef[17];</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                        oldkRoot_5 = dbpcoef[18];</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                        oldkRhizome_5 = dbpcoef[19];</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                        oldkLeaf_6 = dbpcoef[20];</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                        oldkStem_6 = dbpcoef[21];</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                        oldkRoot_6 = dbpcoef[22];</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                        oldkRhizome_6 = dbpcoef[23];</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                        oldkGrain_6 = dbpcoef[24];</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                }</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                <span class="comment">/* It would be nice to put them in a matrix */</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        }</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <span class="keywordflow">for</span>(iters2=0;iters2&lt;niter2;iters2++){</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                index = <a class="code" href="_bio_cro_8c.html#a054d5ae3a62e6217a0d4e5093b79bb25">sel_phen</a>(phen);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                <span class="comment">/* First phenological stage */</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                kLeaf_1 = fabs(oldkLeaf_1);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                kStem_1 = fabs(oldkStem_1);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                kRoot_1 = fabs(oldkRoot_1);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        </div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                <span class="keywordflow">if</span>(index &lt; 1){</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                        kLeaf_1 = fabs(rnorm(kLeaf_1,sd1));</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                }<span class="keywordflow">else</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    </div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                        <span class="keywordflow">if</span>(index &lt; 2){</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                                kStem_1 = fabs(rnorm(kStem_1,sd1));</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                        }<span class="keywordflow">else</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                                <span class="keywordflow">if</span>(index &lt; 3){</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                                        kRoot_1 = fabs(rnorm(kRoot_1,sd1));</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                                }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                k1 = kLeaf_1 + kStem_1 + kRoot_1;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                kLeaf_1 = kLeaf_1/k1;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                kStem_1 = kStem_1/k1;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                kRoot_1 = kRoot_1/k1;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    </div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                <span class="keywordflow">if</span>(index &gt; 3 &amp;&amp; index &lt; 4){</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                        kRhizome_1 = -rnorm(fabs(oldkRhizome_1),sd2);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                        kRhizome_1 = -fabs(oldkRhizome_1);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                }</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                <span class="comment">/* Second phenological stage */</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                kLeaf_2 = fabs(oldkLeaf_2);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                kStem_2 = fabs(oldkStem_2);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                kRoot_2 = fabs(oldkRoot_2);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                <span class="keywordflow">if</span>(index &gt; 4 &amp;&amp; index &lt; 5){</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                        kLeaf_2 = fabs(rnorm(kLeaf_2,sd1));</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                <span class="keywordflow">if</span>(index &gt; 5 &amp;&amp; index &lt; 6){</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                        kStem_2 = fabs(rnorm(kStem_2,sd1));</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                }</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                <span class="keywordflow">if</span>(index &gt; 6 &amp;&amp; index &lt; 7){</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                        kRoot_2 = fabs(rnorm(kRoot_2,sd1));</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                }</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                k2 = kLeaf_2 + kStem_2 + kRoot_2 ;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                kLeaf_2 =  kLeaf_2/k2 ;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                kStem_2 = kStem_2/k2 ;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                kRoot_2 = kRoot_2/k2 ;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                <span class="keywordflow">if</span>(index &gt; 7 &amp;&amp; index &lt; 8){</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                        kRhizome_2 =-rnorm(fabs(oldkRhizome_2),sd2);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                        kRhizome_2 =-fabs(oldkRhizome_2);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                }</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                <span class="comment">/* Third phenological stage */</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                kLeaf_3 = fabs(oldkLeaf_3);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                kStem_3 = fabs(oldkStem_3);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                kRoot_3 = fabs(oldkRoot_3);</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                kRhizome_3 = fabs(oldkRhizome_3);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                <span class="keywordflow">if</span>(index &gt; 8 &amp;&amp; index &lt; 9){</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                        kLeaf_3 = fabs(rnorm(kLeaf_3,sd1));</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                }</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                <span class="keywordflow">if</span>(index &gt; 9 &amp;&amp; index &lt; 10){</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                        kStem_3 = fabs(rnorm(kStem_3,sd1));</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                <span class="keywordflow">if</span>(index &gt; 10 &amp;&amp; index &lt; 11){</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                        kRoot_3 = fabs(rnorm(kRoot_3,sd1));</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                <span class="keywordflow">if</span>(index &gt; 11 &amp;&amp; index &lt; 12){</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                        kRhizome_3 = fabs(rnorm(kRhizome_3,sd1));</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                k3 = kLeaf_3 + kStem_3 + kRoot_3 + kRhizome_3;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                kLeaf_3 =  kLeaf_3/k3 ;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                kStem_3 = kStem_3/k3 ;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                kRoot_3 = kRoot_3/k3 ;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                kRhizome_3 = kRhizome_3/k3 ;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                <span class="comment">/* Fourth phenological stage */</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                kLeaf_4 = fabs(oldkLeaf_4);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                kStem_4 = fabs(oldkStem_4);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                kRoot_4 = fabs(oldkRoot_4);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                kRhizome_4 = fabs(oldkRhizome_4);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                <span class="keywordflow">if</span>(index &gt; 12 &amp;&amp; index &lt; 13){</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                        kLeaf_4 = fabs(rnorm(kLeaf_4,sd1));</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                <span class="keywordflow">if</span>(index &gt; 13 &amp;&amp; index &lt; 14){</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                        kStem_4 = fabs(rnorm(kStem_4,sd1));</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                }</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                <span class="keywordflow">if</span>(index &gt; 14 &amp;&amp; index &lt; 15){</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                        kRoot_4 = fabs(rnorm(kRoot_4,sd1));</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                }</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                <span class="keywordflow">if</span>(index &gt; 15 &amp;&amp; index &lt; 16){</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                        kRhizome_4 = fabs(rnorm(kRhizome_4,sd1));</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                }</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                k4 = kLeaf_4 + kStem_4 + kRoot_4 + kRhizome_4;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                kLeaf_4 =  kLeaf_4/k4 ;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                kStem_4 = kStem_4/k4 ;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                kRoot_4 = kRoot_4/k4 ;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                kRhizome_4 = kRhizome_4/k4 ;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                <span class="comment">/* Fifth phenological stage */</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                kLeaf_5 = fabs(oldkLeaf_5);</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                kStem_5 = fabs(oldkStem_5);</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                kRoot_5 = fabs(oldkRoot_5);</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                kRhizome_5 = fabs(oldkRhizome_5);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                <span class="keywordflow">if</span>(index &gt; 16 &amp;&amp; index &lt; 17){</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                        kLeaf_5 = fabs(rnorm(kLeaf_5,sd1));</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                <span class="keywordflow">if</span>(index &gt; 17 &amp;&amp; index &lt; 18){</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                        kStem_5 = fabs(rnorm(kStem_5,sd1));</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                <span class="keywordflow">if</span>(index &gt; 18 &amp;&amp; index &lt; 19){</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                        kRoot_5 = fabs(rnorm(kRoot_5,sd1));</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                <span class="keywordflow">if</span>(index &gt; 19 &amp;&amp; index &lt; 20){</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                        kRhizome_5 = fabs(rnorm(kRhizome_5,sd1));</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                k5 = kLeaf_5 + kStem_5 + kRoot_5 + kRhizome_5;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                kLeaf_5 =  kLeaf_5/k5 ;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                kStem_5 = kStem_5/k5 ;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                kRoot_5 = kRoot_5/k5 ;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                kRhizome_5 = kRhizome_5/k5 ;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                <span class="comment">/* Sixth phenological stage */</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                kLeaf_6 = fabs(oldkLeaf_6);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                kStem_6 = fabs(oldkStem_6);</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                kRoot_6 = fabs(oldkRoot_6);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                kRhizome_6 = fabs(oldkRhizome_6);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                kGrain_6 = fabs(oldkGrain_6);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                <span class="keywordflow">if</span>(index &gt; 20 &amp;&amp; index &lt; 21){</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                        kLeaf_6 = fabs(rnorm(kLeaf_6,sd1));</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                <span class="keywordflow">if</span>(index &gt; 21 &amp;&amp; index &lt; 22){</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                        kStem_6 = fabs(rnorm(kStem_6,sd1));</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                }</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                <span class="keywordflow">if</span>(index &gt; 22 &amp;&amp; index &lt; 23){</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                        kRoot_6 = fabs(rnorm(kRoot_6,sd1));</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                }</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                <span class="keywordflow">if</span>(index &gt; 23 &amp;&amp; index &lt; 24){</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                        kRhizome_6 = fabs(rnorm(kRhizome_6,sd1));</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                }</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                <span class="keywordflow">if</span>(index &gt; 24 &amp;&amp; index &lt; 25){</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                        kGrain_6 = fabs(rnorm(kGrain_6,sd1));</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                }</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                k6 = kLeaf_6 + kStem_6 + kRoot_6 + kRhizome_6 + kGrain_6;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                kLeaf_6 =  kLeaf_6/k6 ;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                kStem_6 = kStem_6/k6 ;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                kRoot_6 = kRoot_6/k6 ;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                kRhizome_6 = kRhizome_6/k6 ;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                kGrain_6 = kGrain_6/k6 ;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment">/* Populating the dbp coefficients */</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                dbpcoef[0] = kLeaf_1;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                dbpcoef[1] = kStem_1;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                dbpcoef[2] = kRoot_1;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                dbpcoef[3] = kRhizome_1;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                dbpcoef[4] = kLeaf_2;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                dbpcoef[5] = kStem_2;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                dbpcoef[6] = kRoot_2;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                dbpcoef[7] = kRhizome_2;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                dbpcoef[8] = kLeaf_3;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                dbpcoef[9] = kStem_3;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                dbpcoef[10] = kRoot_3;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                dbpcoef[11] = kRhizome_3;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                dbpcoef[12] = kLeaf_4;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                dbpcoef[13] = kStem_4;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                dbpcoef[14] = kRoot_4;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                dbpcoef[15] = kRhizome_4;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                dbpcoef[16] = kLeaf_5;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                dbpcoef[17] = kStem_5;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                dbpcoef[18] = kRoot_5;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                dbpcoef[19] = kRhizome_5;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                dbpcoef[20] = kLeaf_6;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                dbpcoef[21] = kStem_6;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                dbpcoef[22] = kRoot_6;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                dbpcoef[23] = kRhizome_6;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                dbpcoef[24] = kGrain_6;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                <a class="code" href="_bio_cro_8c.html#aa289681c71425537eb6fccb7ae92962a">BioGro</a>(lati,INTEGER(DOY),INTEGER(HR),REAL(SOLAR),REAL(TEMP),REAL(RH),</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                       REAL(WINDSPEED),REAL(PRECIP), REAL(KD)[0], REAL(CHILHF)[0], </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                       REAL(CHILHF)[1],nlayers,rhizome,</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                       irtl,REAL(SENESCTIME),INTEGER(TIMESTEP)[0],vecsize,</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                       REAL(SP)[0], REAL(SPD)[0], dbpcoef, REAL(THERMALP),</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                       vmax,alpha,kparm,theta,beta,Rd,Ca,b0,b1, REAL(SOILCOEFS), LeafN, kLN,</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                       vmaxb1, alphab1, REAL(MRESP), INTEGER(SOILTYPE)[0], INTEGER(WSFUN)[0],</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                       INTEGER(WS)[0], REAL(CENTCOEFS),REAL(CENTKS), INTEGER(CENTTIMESTEP)[0],</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                       INTEGER(SOILLAYERS)[0], REAL(SOILDEPTHS), REAL(CWS), INTEGER(HYDRDIST)[0],</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                       REAL(SECS), REAL(NCOEFS)[0], REAL(NCOEFS)[1], REAL(NCOEFS)[2], INTEGER(LNFUN)[0],upperT,lowerT,nitroparms);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                <span class="comment">/* pick the needed elements for the SSE */</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                <span class="keywordflow">for</span>(k=0;k&lt;Ndat;k++){</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                        ind = INTEGER(INDEX)[k];</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                        sCanopyAssim[k] = CanopyAssim[ind];</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                        sLeafy[k] = Leafy[ind];</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                        sStemy[k] = Stemy[ind];</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                        sRooty[k] = Rooty[ind];</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                        sRhizomey[k] = Rhizomey[ind];</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                        sLAIy[k] = LAIc[ind];</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                }</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                rss = <a class="code" href="_bio_cro_8c.html#a140e2632f0a9a79a801fcbea03b7740d">RSS_BG</a>(oStemy,oLeafy,oRooty,oRhizomey,oGrainy,oLAIy,</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                             sStemy,sLeafy,sRooty,sRhizomey,sGrainy,sLAIy,</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                             n1dat);</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                REAL(RssVec2)[iters2] = rss;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                mr = exp(-rss) / exp(-oldRss);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                U = runif(0,1); </div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                <span class="keywordflow">if</span>(mr &gt; U){ </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                        n2++;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                        <span class="comment">/* accept the coefficients */</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                        oldkLeaf_1 = dbpcoef[0];</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                        oldkStem_1 = dbpcoef[1];</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                        oldkRoot_1 = dbpcoef[2];</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                        oldkRhizome_1 = dbpcoef[3];</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;            </div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                        oldkLeaf_2 = dbpcoef[4];</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                        oldkStem_2 = dbpcoef[5];</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                        oldkRoot_2 = dbpcoef[6];</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                        oldkRhizome_2 = dbpcoef[7];</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;            </div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                        oldkLeaf_3 = dbpcoef[8];</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                        oldkStem_3 = dbpcoef[9];</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                        oldkRoot_3 = dbpcoef[10];</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                        oldkRhizome_3 = dbpcoef[11];</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            </div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                        oldkLeaf_4 = dbpcoef[12];</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                        oldkStem_4 = dbpcoef[13];</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                        oldkRoot_4 = dbpcoef[14];</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                        oldkRhizome_4 = dbpcoef[15];</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                        oldkLeaf_5 = dbpcoef[16];</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                        oldkStem_5 = dbpcoef[17];</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                        oldkRoot_5 = dbpcoef[18];</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                        oldkRhizome_5 = dbpcoef[19];</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                        oldkLeaf_6 = dbpcoef[20];</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                        oldkStem_6 = dbpcoef[21];</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                        oldkRoot_6 = dbpcoef[22];</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                        oldkRhizome_6 = dbpcoef[23];</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                        oldkGrain_6 = dbpcoef[24];</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                        oldRss = rss;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                }         </div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                <span class="comment">/* put them in a matrix */</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                REAL(mat1)[n1*25] = dbpcoef[0];</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                REAL(mat1)[1 + n1*25] = dbpcoef[1];</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                REAL(mat1)[2 + n1*25] = dbpcoef[2];</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                REAL(mat1)[3 + n1*25] = dbpcoef[3];</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                REAL(mat1)[4 + n1*25] = dbpcoef[4];</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                REAL(mat1)[5 + n1*25] = dbpcoef[5];</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                REAL(mat1)[6 + n1*25] = dbpcoef[6];</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                REAL(mat1)[7 + n1*25] = dbpcoef[7];</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            </div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                REAL(mat1)[8 + n1*25] = dbpcoef[8];</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                REAL(mat1)[9 + n1*25] = dbpcoef[9];</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                REAL(mat1)[10 + n1*25] = dbpcoef[10];</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                REAL(mat1)[11 + n1*25] = dbpcoef[11];</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                REAL(mat1)[12 + n1*25] = dbpcoef[12];</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                REAL(mat1)[13 + n1*25] = dbpcoef[13];</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                REAL(mat1)[14 + n1*25] = dbpcoef[14];</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                REAL(mat1)[15 + n1*25] = dbpcoef[15];</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                REAL(mat1)[16 + n1*25] = dbpcoef[16];</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                REAL(mat1)[17 + n1*25] = dbpcoef[17];</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                REAL(mat1)[18 + n1*25] = dbpcoef[18];</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                REAL(mat1)[19 + n1*25] = dbpcoef[19];</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                REAL(mat1)[20 + n1*25] = dbpcoef[20];</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                REAL(mat1)[21 + n1*25] = dbpcoef[21];</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                REAL(mat1)[22 + n1*25] = dbpcoef[22];</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                REAL(mat1)[23 + n1*25] = dbpcoef[23];</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                REAL(mat1)[24 + n1*25] = dbpcoef[24];</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                n1++;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        PutRNGstate();</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        REAL(ans1)[0] = oldkLeaf_1;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        REAL(ans1)[1] = oldkStem_1;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        REAL(ans1)[2] = oldkRoot_1;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        REAL(ans1)[3] = oldkRhizome_1;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        REAL(ans1)[4] = oldkLeaf_2;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        REAL(ans1)[5] = oldkStem_2;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        REAL(ans1)[6] = oldkRoot_2;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        REAL(ans1)[7] = oldkRhizome_2;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        REAL(ans1)[8] = oldkLeaf_3;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        REAL(ans1)[9] = oldkStem_3;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        REAL(ans1)[10] = oldkRoot_3;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        REAL(ans1)[11] = oldkRhizome_3;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        REAL(ans1)[12] = oldkLeaf_4;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        REAL(ans1)[13] = oldkStem_4;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        REAL(ans1)[14] = oldkRoot_4;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        REAL(ans1)[15] = oldkRhizome_4;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        REAL(ans1)[16] = oldkLeaf_5;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        REAL(ans1)[17] = oldkStem_5;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        REAL(ans1)[18] = oldkRoot_5;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        REAL(ans1)[19] = oldkRhizome_5;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        REAL(ans1)[20] = oldkLeaf_6;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        REAL(ans1)[21] = oldkStem_6;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        REAL(ans1)[22] = oldkRoot_6;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        REAL(ans1)[23] = oldkRhizome_6;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        REAL(ans1)[24] = oldkGrain_6;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        REAL(RSS)[0] = oldRss;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        REAL(ACCPT)[0] = accept;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        REAL(accept2)[0] = n1;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        REAL(accept3)[0] = n2;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        REAL(SAtemp)[0] = saTemp;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="keywordflow">for</span>(j=0;j&lt;Ndat;j++){</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                ind = INTEGER(INDEX)[j];</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                REAL(simStem)[j] = Stemy[ind];</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                REAL(simLeaf)[j] = Leafy[ind];</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                REAL(simRhiz)[j] = Rhizomey[ind];</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                REAL(simRoot)[j] = Rooty[ind];</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                REAL(simGrain)[j] = Grainy[ind];</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                REAL(simLAI)[j] = LAIc[ind];</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                REAL(TTime)[j] = REAL(oTHERMAL)[j];</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                REAL(inde)[j] = INTEGER(INDEX)[j];</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        SET_VECTOR_ELT(lists,0,ans1);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        SET_VECTOR_ELT(lists,1,RSS);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        SET_VECTOR_ELT(lists,2,ACCPT);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        SET_VECTOR_ELT(lists,3,RssVec);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        SET_VECTOR_ELT(lists,4,simStem);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        SET_VECTOR_ELT(lists,5,TTime);</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        SET_VECTOR_ELT(lists,6,inde);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        SET_VECTOR_ELT(lists,7,obsStem);</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        SET_VECTOR_ELT(lists,8,simLeaf);</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        SET_VECTOR_ELT(lists,9,obsLeaf);</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        SET_VECTOR_ELT(lists,10,simRhiz);</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        SET_VECTOR_ELT(lists,11,obsRhiz);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        SET_VECTOR_ELT(lists,12,simLAI);</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        SET_VECTOR_ELT(lists,13,obsLAI);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        SET_VECTOR_ELT(lists,14,simRoot);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        SET_VECTOR_ELT(lists,15,obsRoot);</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        SET_VECTOR_ELT(lists,16,simGrain);</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        SET_VECTOR_ELT(lists,17,obsGrain);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        SET_VECTOR_ELT(lists,18,RssVec2);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        SET_VECTOR_ELT(lists,19,mat1);</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        SET_VECTOR_ELT(lists,20,accept2);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        SET_VECTOR_ELT(lists,21,accept3);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        SET_VECTOR_ELT(lists,22,SAtemp);</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        SET_STRING_ELT(names,0,mkChar(<span class="stringliteral">&quot;coefs&quot;</span>));</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        SET_STRING_ELT(names,1,mkChar(<span class="stringliteral">&quot;rss&quot;</span>));</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        SET_STRING_ELT(names,2,mkChar(<span class="stringliteral">&quot;accept&quot;</span>));</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        SET_STRING_ELT(names,3,mkChar(<span class="stringliteral">&quot;RssVec&quot;</span>));</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        SET_STRING_ELT(names,4,mkChar(<span class="stringliteral">&quot;simStem&quot;</span>));</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        SET_STRING_ELT(names,5,mkChar(<span class="stringliteral">&quot;TTime&quot;</span>));</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        SET_STRING_ELT(names,6,mkChar(<span class="stringliteral">&quot;index&quot;</span>));</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        SET_STRING_ELT(names,7,mkChar(<span class="stringliteral">&quot;obsStem&quot;</span>));</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        SET_STRING_ELT(names,8,mkChar(<span class="stringliteral">&quot;simLeaf&quot;</span>));</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        SET_STRING_ELT(names,9,mkChar(<span class="stringliteral">&quot;obsLeaf&quot;</span>));</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        SET_STRING_ELT(names,10,mkChar(<span class="stringliteral">&quot;simRhiz&quot;</span>));</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        SET_STRING_ELT(names,11,mkChar(<span class="stringliteral">&quot;obsRhiz&quot;</span>));</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        SET_STRING_ELT(names,12,mkChar(<span class="stringliteral">&quot;simLAI&quot;</span>));</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        SET_STRING_ELT(names,13,mkChar(<span class="stringliteral">&quot;obsLAI&quot;</span>));</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        SET_STRING_ELT(names,14,mkChar(<span class="stringliteral">&quot;simRoot&quot;</span>));</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        SET_STRING_ELT(names,15,mkChar(<span class="stringliteral">&quot;obsRoot&quot;</span>));</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        SET_STRING_ELT(names,16,mkChar(<span class="stringliteral">&quot;simGrain&quot;</span>));</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        SET_STRING_ELT(names,17,mkChar(<span class="stringliteral">&quot;obsGrain&quot;</span>));</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        SET_STRING_ELT(names,18,mkChar(<span class="stringliteral">&quot;RssVec2&quot;</span>));</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;        SET_STRING_ELT(names,19,mkChar(<span class="stringliteral">&quot;resMC&quot;</span>));</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;        SET_STRING_ELT(names,20,mkChar(<span class="stringliteral">&quot;accept2&quot;</span>));</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        SET_STRING_ELT(names,21,mkChar(<span class="stringliteral">&quot;accept3&quot;</span>));</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        SET_STRING_ELT(names,22,mkChar(<span class="stringliteral">&quot;saTemp&quot;</span>));</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        setAttrib(lists,R_NamesSymbol,names);</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        UNPROTECT(25);</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        <span class="keywordflow">return</span>(lists);</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;}</div>
<div class="ttc" id="_bio_cro_8h_html_a5b6e16664a459420103984ac5409b858"><div class="ttname"><a href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a></div><div class="ttdeci">double CanopyAssim[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:10</div></div>
<div class="ttc" id="structnitro_parms_html"><div class="ttname"><a href="structnitro_parms.html">nitroParms</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:128</div></div>
<div class="ttc" id="structrhizome_html"><div class="ttname"><a href="structrhizome.html">rhizome</a></div><div class="ttdef"><b>Definition:</b> crocent.h:640</div></div>
<div class="ttc" id="_bio_cro_8h_html_aa3741856cde2b5152c833b543abe77fc"><div class="ttname"><a href="_bio_cro_8h.html#aa3741856cde2b5152c833b543abe77fc">Rhizomey</a></div><div class="ttdeci">double Rhizomey[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:14</div></div>
<div class="ttc" id="_bio_cro_8h_html_ad6a54d6e671d04cd9b254a8cd1c3315c"><div class="ttname"><a href="_bio_cro_8h.html#ad6a54d6e671d04cd9b254a8cd1c3315c">Rooty</a></div><div class="ttdeci">double Rooty[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:13</div></div>
<div class="ttc" id="_bio_cro_8h_html_ac656f07a64aeba7d6ac5a3a536e993c8"><div class="ttname"><a href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a></div><div class="ttdeci">double LAIc[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:16</div></div>
<div class="ttc" id="_bio_cro_8h_html_a46f339721a905fe9e6f60af35ec11974"><div class="ttname"><a href="_bio_cro_8h.html#a46f339721a905fe9e6f60af35ec11974">Grainy</a></div><div class="ttdeci">double Grainy[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:15</div></div>
<div class="ttc" id="structnitro_parms_html_a81548389d7bb414fbf85c27cc1df21ad"><div class="ttname"><a href="structnitro_parms.html#a81548389d7bb414fbf85c27cc1df21ad">nitroParms::ileafN</a></div><div class="ttdeci">double ileafN</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:129</div></div>
<div class="ttc" id="_bio_cro_8c_html_aa289681c71425537eb6fccb7ae92962a"><div class="ttname"><a href="_bio_cro_8c.html#aa289681c71425537eb6fccb7ae92962a">BioGro</a></div><div class="ttdeci">void BioGro(double lat, int doy[], int hr[], double solar[], double temp[], double rh[], double windspeed[], double precip[], double kd, double chil, double heightf, int nlayers, double iRhizome, double irtl, double sencoefs[], int timestep, int vecsize, double Sp, double SpD, double dbpcoefs[25], double thermalp[], double vmax1, double alpha1, double kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double soilcoefs[], double ileafn, double kLN, double vmaxb1, double alphab1, double mresp[], int soilType, int wsFun, int ws, double centcoefs[], double centks[], int centTimestep, int soilLayers, double soilDepths[], double cws[], int hydrDist, double secs[], double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, struct nitroParms nitroP)</div><div class="ttdef"><b>Definition:</b> BioCro.c:1870</div></div>
<div class="ttc" id="_bio_cro_8c_html_a140e2632f0a9a79a801fcbea03b7740d"><div class="ttname"><a href="_bio_cro_8c.html#a140e2632f0a9a79a801fcbea03b7740d">RSS_BG</a></div><div class="ttdeci">double RSS_BG(double oStem[], double oLeaf[], double oRoot[], double oRhizome[], double oGrain[], double oLAI[], double sStem[], double sLeaf[], double sRoot[], double sRhizome[], double sGrain[], double sLAI[], int N1Dat)</div><div class="ttdef"><b>Definition:</b> BioCro.c:1809</div></div>
<div class="ttc" id="_bio_cro_8h_html_a929d2badff7fb301509012ee6e6a12e9"><div class="ttname"><a href="_bio_cro_8h.html#a929d2badff7fb301509012ee6e6a12e9">Stemy</a></div><div class="ttdeci">double Stemy[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:12</div></div>
<div class="ttc" id="structnitro_parms_html_aaf784159d7555e9af103853d7d096b77"><div class="ttname"><a href="structnitro_parms.html#aaf784159d7555e9af103853d7d096b77">nitroParms::alphab1</a></div><div class="ttdeci">double alphab1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:133</div></div>
<div class="ttc" id="_bio_cro_8h_html_abd2c9bad12951c887e8469151c778947"><div class="ttname"><a href="_bio_cro_8h.html#abd2c9bad12951c887e8469151c778947">Leafy</a></div><div class="ttdeci">double Leafy[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:11</div></div>
<div class="ttc" id="_bio_cro_8c_html_a054d5ae3a62e6217a0d4e5093b79bb25"><div class="ttname"><a href="_bio_cro_8c.html#a054d5ae3a62e6217a0d4e5093b79bb25">sel_phen</a></div><div class="ttdeci">double sel_phen(int phen)</div><div class="ttdef"><b>Definition:</b> BioCro.c:2262</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a054d5ae3a62e6217a0d4e5093b79bb25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sel_phen </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>phen</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                         {</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        <span class="keywordtype">double</span> index = 0;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;        <span class="keywordflow">if</span>(phen == 6){</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                index = runif(20,25);</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;        }<span class="keywordflow">else</span> </div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;         <span class="keywordflow">if</span>(phen == 5){</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                 index = runif(16,20);</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;         }<span class="keywordflow">else</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;          <span class="keywordflow">if</span>(phen == 4){</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                  index = runif(12,16);</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;          }<span class="keywordflow">else</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;           <span class="keywordflow">if</span>(phen == 3){</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                   index = runif(8,12);</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;           }<span class="keywordflow">else</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;            <span class="keywordflow">if</span>(phen == 2){</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                    index = runif(4,8);</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;            }<span class="keywordflow">else</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;             <span class="keywordflow">if</span>(phen == 1){</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                     index = runif(0,4);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;             }</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        <span class="keywordflow">return</span>(index);</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_bio_cro_8c.html">BioCro.c</a></li>
    <li class="footer">Generated on Fri Apr 3 2015 15:41:06 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
