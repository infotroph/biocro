<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>BioCro: /home/dlebauer/dev/biocro/src/eC4photo.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('e_c4photo_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">eC4photo.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;R.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;Rmath.h&gt;</code><br/>
<code>#include &lt;Rinternals.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="">AuxBioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">CanA.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for eC4photo.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="e_c4photo_8c__incl.png" border="0" usemap="#_2home_2dlebauer_2dev_2biocro_2src_2e_c4photo_8c" alt=""/></div>
<map name="_2home_2dlebauer_2dev_2biocro_2src_2e_c4photo_8c" id="_2home_2dlebauer_2dev_2biocro_2src_2e_c4photo_8c">
<area shape="rect" id="node6" href="_aux_bio_cro_8h.html" title="AuxBioCro.h" alt="" coords="373,96,469,123"/><area shape="rect" id="node7" href="_can_a_8h.html" title="CanA.h" alt="" coords="493,96,560,123"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac3eddd9862ded6e65643aea0cb9406c8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e_c4photo_8c.html#ac3eddd9862ded6e65643aea0cb9406c8">eC4photoC</a> (double QP, double TEMP, double RH, double CA, double OA, double VCMAX, double VPMAX, double VPR, double JMAX)</td></tr>
<tr class="separator:ac3eddd9862ded6e65643aea0cb9406c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae02634988012c10db6b7b93d60c679d2"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e_c4photo_8c.html#ae02634988012c10db6b7b93d60c679d2">eCanA</a> (SEXP lai, SEXP Doy, SEXP Hr, SEXP SolarR, SEXP ATemp, SEXP RelH, SEXP WindS, SEXP CA, SEXP OA, SEXP VCMAX, SEXP VPMAX, SEXP VPR, SEXP JMAX, SEXP STOMATAWS)</td></tr>
<tr class="separator:ae02634988012c10db6b7b93d60c679d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34c2375d9e857ee884d1867da957ba35"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e_c4photo_8c.html#a34c2375d9e857ee884d1867da957ba35">eC4photo</a> (SEXP QP, SEXP TEMP, SEXP RH, SEXP CA, SEXP OA, SEXP VCMAX, SEXP VPMAX, SEXP VPR, SEXP JMAX)</td></tr>
<tr class="separator:a34c2375d9e857ee884d1867da957ba35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f766a8f283c0736da0ab400ace4abba"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e_c4photo_8c.html#a4f766a8f283c0736da0ab400ace4abba">RsqeC4photo</a> (double oAssim[<a class="el" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>], double oQp[<a class="el" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>], double oTemp[<a class="el" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>], double oRH[<a class="el" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>], double Ca, double Oa, double Vcmax, double Vpmax, double Vpr, double Jmax)</td></tr>
<tr class="separator:a4f766a8f283c0736da0ab400ace4abba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8006074d888610622a3eb6cfcb111955"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e_c4photo_8c.html#a8006074d888610622a3eb6cfcb111955">McMCEc4photo</a> (SEXP oASSIM, SEXP oQP, SEXP oTEMP, SEXP oRelH, SEXP NITER, SEXP iCA, SEXP iOA, SEXP iVCMAX, SEXP iVPMAX, SEXP iJMAX, SEXP THRESH, SEXP SCALE)</td></tr>
<tr class="separator:a8006074d888610622a3eb6cfcb111955"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a44f34a427107babc7cd2db474942ee24"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a></td></tr>
<tr class="separator:a44f34a427107babc7cd2db474942ee24"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a34c2375d9e857ee884d1867da957ba35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP eC4photo </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>QP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>OA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VCMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VPMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VPR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>JMAX</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;{</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordtype">int</span> nqp, i;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  nqp = length(QP);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">/* CONSTANTS */</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordtype">double</span> P = 101.3;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordtype">double</span> G1 = 3;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordtype">double</span> G0 = 0.08;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>  gs = 3 * 1e-3 ;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">/* mol m-2 s-1 physical conductance to CO2 leakage*/</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">/* const double gammaStar = 0.000193  */</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> gammaStar =  0.000193 ;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">/* half the reciprocal of Rubisco specificity */</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">/*    const double go = 0.047 * gs     at 25 C */</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = 0.01 ; <span class="comment">/* alpha in the notes*/</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">double</span> Kp = 80 ; <span class="comment">/*  mu bar */</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">double</span> theta = 0.7;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> R = 0.008314472; <span class="comment">/* Gas constant J K-1 mol-1 */</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">/* in the units stated should be 8.314 but </span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">       XGZ determined it is * 1e-3 */</span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Kelvin0 = 273.15;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Kelvin25 = 298.15;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">/* This is 0 and 25 Celsius degrees in the Kelvin scale */</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">/* ADDING THE TEMPERATURE RESPONSE FUNCTION */</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordtype">double</span> Epr = 46.8 ; <span class="comment">/* Activation energy of PPDK kj/mol*/</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordtype">double</span> Ep  = 47.1 ; <span class="comment">/* Activation energy of PEPc kj/mol */</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordtype">double</span> Erb = 72 ; <span class="comment">/* Activation energy of Rubisco kj/mol */</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">/*    const double Q10bf = 1.7 */</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordtype">double</span> ERd = 46.39;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordtype">double</span> EKc = 79.43;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordtype">double</span> EKo = 36.38;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordtype">double</span> Q10cb = 1.7;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">/* double Ko = 450 ;  mbar at 25 C */</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">double</span> Ko2 = 450 ; <span class="comment">/* mbar at 25 C */</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">/* double Kc = 650   mu bar at 25 C */</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">double</span> Kc2 = 650 ; <span class="comment">/*  mu bar at 25 C */</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">/* VAriables */</span> </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordtype">double</span> Kc, Ko;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">double</span> StomCond;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">double</span> Idir, AirTemp, rh, Ca, Oa;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">double</span> Vcmax1, Vpmax1, Jmax1;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">double</span> Vcmax, Vpmax, Vpr, Jmax;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordtype">double</span> Q10pr, Q10p, Q10rb, Q10Rd, Q10Kc, Q10Ko;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordtype">double</span> Cm, Om;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordtype">double</span> Rd, Rm, Rs;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordtype">double</span> I2, J, Aj;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordtype">double</span> Vp, Ko1 , Om1;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordtype">double</span> a1, b1, c1 , c3, Ac0;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordtype">double</span> AcLCO2, Ac, A;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">double</span> Os, Cs;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordtype">double</span> Cs0, Cs1;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordtype">double</span> aa, bb, cc;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    SEXP names, lists;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    SEXP Assim;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    SEXP Gs;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    SEXP Ci;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    SEXP Oxy;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    PROTECT(lists = allocVector(VECSXP,4));</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    PROTECT(names = allocVector(STRSXP,4));</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    PROTECT(Assim = allocVector(REALSXP,nqp));</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    PROTECT(Gs = allocVector(REALSXP,nqp));</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    PROTECT(Ci = allocVector(REALSXP,nqp));</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    PROTECT(Oxy = allocVector(REALSXP,nqp));</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    Ca = REAL(CA)[0];</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    Oa = REAL(OA)[0];</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    Vcmax1 = REAL(VCMAX)[0];</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    Vpmax1 = REAL(VPMAX)[0];</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    Vpr = REAL(VPR)[0];</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    Jmax1 = REAL(JMAX)[0];</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">for</span>(i = 0;i &lt; nqp;i++){</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    Idir = REAL(QP)[i];</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    AirTemp = REAL(TEMP)[i];</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    rh = REAL(RH)[i];</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    Q10pr = exp(Epr *(1/(R * Kelvin25)-1/(R * (AirTemp + Kelvin0))));</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    Q10p = exp(Ep *(1/(R * Kelvin25)-1/(R * (AirTemp + Kelvin0))));</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    Q10rb = exp(Erb *(1/(R * Kelvin25)-1/(R * (AirTemp + Kelvin0))));</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    Q10Rd = exp(ERd *(1/(R * Kelvin25)-1/(R * (AirTemp + Kelvin0))));</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    Q10Kc = exp(EKc *(1/(R * Kelvin25)-1/(R * (AirTemp + Kelvin0))));</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    Q10Ko = exp(EKo *(1/(R * Kelvin25)-1/(R * (AirTemp + Kelvin0))));</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    Vcmax = Vcmax1 * Q10rb;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    Kc = Kc2 * Q10Kc;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    Ko = Ko2 * Q10Ko;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    Vpmax = Vpmax1 * Q10p;        </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    Jmax = Jmax1 * pow(Q10cb,(AirTemp-25)/10);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    Cm = 0.4 * Ca ; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    Om = Oa ;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">/*    Rd = 0.01 * Vcmax; */</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    Rd = 0.08;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    Rm = 0.5 * Rd ;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    Rs = 0.5 * Rd;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">/* Light limited */</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    I2 = (Idir * 0.85)/2;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    J = (Jmax + I2  - sqrt(pow(Jmax+I2,2) - 4 * theta * I2 * Jmax ))/2*theta;        </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">/* Long formula for light limited */</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    aa = 1 - (7 * gammaStar * alpha )/3 * 0.047;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    bb = -(((0.4 * J)/2 - Rm + gs * Cm) + ((1-0.4)*J/3-Rd) + </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;           gs*(7*gammaStar*Om/3) + </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;           (alpha*gammaStar/0.047)*((1-0.04)*J/3 + 7*Rd/3));</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    cc = ((0.4 * J)/2 - Rm + gs * Cm)*((1-0.4)*J/3-Rd) -</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      gs * gammaStar * Om *((1-0.4)*J/3 + 7*Rd/3);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    Aj = (-bb - sqrt(pow(bb,2)-4*aa*cc))/2*aa;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">/* Other part */</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    Vp = (Cm * Vpmax) / (Cm + Kp) ;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span>(Vpr &lt; Vp){</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      Vp = Vpr;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">/* Alternative formula */</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    Ko1 = Ko * 1e3;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    Om1 = Om * 1e3;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    a1 = 1 - alpha / 0.047 * Kc/Ko1 ;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    b1 = -((Vp - Rm + gs * Cm)+</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;           (Vcmax - Rd)+</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;           gs*(Kc*(1+Om1/Ko1))+</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;           ((alpha/0.047)*(gammaStar*Vcmax+Rd*Kc/Ko1)));</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    c1 = (Vcmax - Rd)*(Vp-Rm+gs*Cm)-</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          (Vcmax * gs * gammaStar * Om1 + Rd*gs*Kc*(1+Om1/Ko1));</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;         </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    c3 = pow(b1,2) - 4*a1*c1;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">if</span>(c3 &lt; 0){</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        c3 = 0;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    Ac0 = (-b1 - sqrt(c3)) / 2*a1 ;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    AcLCO2 = (Cm * Vpmax/(Cm+Kp)) - Rm + gs * Cm;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span>(Ac0 &lt; AcLCO2){</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      Ac = Ac0;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      Ac = AcLCO2;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span>(Aj &lt; Ac){</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      A = Aj;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      A = Ac;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    Os = alpha * A / 0.047 * gs + Om;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;     <span class="keywordflow">if</span>(Aj &lt;= Ac){ </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;       Cs = Cm + (Vp - Aj - Rm)/gs;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      }<span class="keywordflow">else</span>{ </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          Cs0 = gammaStar * Os + Kc*(1+Os/Ko)*((Ac+Rd)/Vcmax); </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          Cs1 = 1 - (Ac+Rd)/Vcmax; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;          Cs = Cs0/Cs1;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;           }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">/* Calculating Gs */</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;     <span class="keywordflow">if</span>(A &lt; 0){</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;       StomCond = G0;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;     }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;       StomCond = G1 * (A * rh * P) / (Cm*1e-1) + G0;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;     }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">/* Organizing the results */</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    REAL(Assim)[i] = A;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    REAL(Gs)[i] = StomCond;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    REAL(Ci)[i] = Cs;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    REAL(Oxy)[i] = Os;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    SET_VECTOR_ELT(lists,0,Assim);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    SET_VECTOR_ELT(lists,1,Gs);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    SET_VECTOR_ELT(lists,2,Ci);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    SET_VECTOR_ELT(lists,3,Oxy);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    SET_STRING_ELT(names,0,mkChar(<span class="stringliteral">&quot;Assim&quot;</span>));</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    SET_STRING_ELT(names,1,mkChar(<span class="stringliteral">&quot;Gs&quot;</span>));</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    SET_STRING_ELT(names,2,mkChar(<span class="stringliteral">&quot;Ci&quot;</span>));</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    SET_STRING_ELT(names,3,mkChar(<span class="stringliteral">&quot;Oxy&quot;</span>));</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    setAttrib(lists,R_NamesSymbol,names);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    UNPROTECT(6);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">return</span>(lists);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac3eddd9862ded6e65643aea0cb9406c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double eC4photoC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>QP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>OA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>VCMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>VPMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>VPR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>JMAX</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;{</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">/* CONSTANTS */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>  gs = 3 * 1e-3 ;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">/* mol m-2 s-1 physical conductance to CO2 leakage*/</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">/* const double gammaStar = 0.000193  */</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> gammaStar =  0.0002239473      ;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">/* half the reciprocal of Rubisco specificity */</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">/*    const double go = 0.047 * gs     at 25 C */</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> a = 0.01 ; <span class="comment">/* alpha in the notes*/</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Kp = 80 ; <span class="comment">/*  mu bar */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">/* const double Kc1 = 650 * 1e-3  mbar at 25 C */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Kc1 = 1020 * 1e-3; <span class="comment">/*  mbar at 25 C */</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> theta = 0.7;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">/* ADDING THE TEMPERATURE RESPONSE FUNCTION */</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Epr = 46.8 ; <span class="comment">/* Activation energy of PPDK kj/mol*/</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Ep  = 47.1 ; <span class="comment">/* Activation energy of PEPc kj/mol */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Erb = 72 ; <span class="comment">/* Activation energy of Rubisco kj/mol */</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">/*    const double Q10bf = 1.7 */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> ERd = 46.39;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> EKc = 79.43;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> EKo = 36.38;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Q10cb = 1.7;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">/* double Ko = 450 ;  mbar at 25 C */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">double</span> Ko = 532.9 ; <span class="comment">/* mbar at 25 C */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">/* double Kc = 650   mu bar at 25 C */</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">double</span> Kc = 1020 ; <span class="comment">/*  mu bar at 25 C */</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">/* VAriables */</span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">double</span> Idir, AirTemp, rh, Ca, Oa;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">double</span> Vcmax, Vpmax, Vpr, Jmax;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">double</span> Q10pr, Q10p, Q10rb, Q10Rd, Q10Kc, Q10Ko;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">double</span> Cm, Om;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">double</span> Rd, Rm, Rs;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">double</span> I2, J, Aj0, Aj1, Aj;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">double</span> Vp, Ko1 , Om1;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">double</span> a1, b1, c1 , c3, Ac0;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">double</span> AcLCO2, Ac, A;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">double</span> Os, Cs;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">double</span> Cs0, Cs1;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    Idir = QP;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    AirTemp = TEMP;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    rh = RH;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    Ca = CA;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    Oa = OA;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    Vcmax = VCMAX;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    Vpmax = VPMAX;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    Vpr = VPR;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    Jmax = JMAX;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    Q10pr = exp(Epr *(1/(0.008314*298.15)-1/(0.008314*(AirTemp+273.15))));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    Q10p = exp(Ep *(1/(0.008314*298.15)-1/(0.008314*(AirTemp+273.15))));</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    Q10rb = exp(Erb *(1/(0.008314*298.15)-1/(0.008314*(AirTemp+273.15))));</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    Q10Rd = exp(ERd *(1/(0.008314*298.15)-1/(0.008314*(AirTemp+273.15))));</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    Q10Kc = exp(EKc *(1/(0.008314*298.15)-1/(0.008314*(AirTemp+273.15))));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    Q10Ko = exp(EKo *(1/(0.008314*298.15)-1/(0.008314*(AirTemp+273.15))));</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    Vcmax = Vcmax * Q10rb;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    Kc = Kc * Q10Kc;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    Ko = Ko * Q10Ko;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    Vpmax = Vpmax * Q10p;        </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    Jmax = Jmax * pow(Q10cb,(AirTemp-25)/10);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    Cm = 0.4 * Ca ; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    Om = Oa ;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">/*    Rd = 0.01 * Vcmax; */</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    Rd = 0.08;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    Rm = 0.5 * Rd ;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    Rs = 0.5 * Rd;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">/* Light limited */</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    I2 = (Idir * 0.85)/2;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    J = (Jmax + I2  - sqrt(pow(Jmax+I2,2) - 4 * theta * I2 * Jmax ))/2*theta;        </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    Aj0 = 0.4 * J - Rm + gs * Cm;        </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    Aj1 = (1-0.4)*J/3-Rd;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">if</span>(Aj0 &lt; Aj1){</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      Aj = Aj0;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      Aj = Aj1;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">/* Other part */</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    Vp = (Cm * Vpmax) / (Cm + Kp) ;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">if</span>(Vpr &lt; Vp){</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      Vp = Vpr;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">/* Alternative formula */</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    Ko1 = Ko * 1e3;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    Om1 = Om * 1e3;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    a1 = 1 - a / 0.047 * Kc/Ko1 ;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    b1 = -((Vp - Rm + gs * Cm)+</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;           (Vcmax - Rd)+</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;           gs*(Kc*(1+Om1/Ko1))+</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;           ((a/0.047)*(gammaStar*Vcmax+Rd*Kc/Ko1)));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    c1 = (Vcmax - Rd)*(Vp-Rm+gs*Cm)-</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;          (Vcmax * gs * gammaStar * Om1 + Rd*gs*Kc*(1+Om1/Ko1));</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;         </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    c3 = pow(b1,2) - 4*a1*c1;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">if</span>(c3 &lt; 0){</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        c3 = 0;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    Ac0 = (-b1 - sqrt(c3)) / 2*a1 ;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    AcLCO2 = (Cm * Vpmax/(Cm+Kp)) - Rm + gs * Cm;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span>(Ac0 &lt; AcLCO2){</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      Ac = Ac0;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      Ac = AcLCO2;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">if</span>(Aj &lt; Ac){</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      A = Aj;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      A = Ac;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    Os = a * A / 0.047 * gs + Om;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span>(Aj &lt;= Ac){</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      Cs0 = (gammaStar * Os)*(7/3*(Aj + Rd) + (1-0.4)*J/3);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      Cs1 = (1-0.4)*J/3-(Aj) ; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      Cs = Cs0/Cs1;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      Cs0 = gammaStar * Os + Kc1*(1+Os/Ko)*((Ac+Rd)/Vcmax);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;          <span class="keywordflow">if</span>((Ac+Rd) &gt;= Vcmax){</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            Ac = Vcmax - Rd - 0.5 ;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          Cs1 = 1 - (Ac+Rd)/Vcmax;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          Cs = Cs0/Cs1;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">return</span>(A);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae02634988012c10db6b7b93d60c679d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP eCanA </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>lai</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Doy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SolarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ATemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WindS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>OA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VCMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VPMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VPR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>JMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>STOMATAWS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">/* const int NLAYERS = 3;  this should eventually be replaced with</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">                            an argument coming in from R */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_e_t___str.html">ET_Str</a> <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a>, tmp6;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">double</span> Idir, Idiff, cosTh;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">double</span> IDir, IDiff, Itot, rh, WS;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">double</span> pLeafsun, pLeafshade;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">double</span> Leafsun, Leafshade;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/*   double tmp5,tmp6; */</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">double</span> TempIdir,TempIdiff,AssIdir,AssIdiff;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">double</span> CanopyA;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">double</span> CanHeight;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 3600 * 1e-6 ;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordtype">int</span> DOY , hr;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">double</span> LAI, solarR, Temp, RH, WindSpeed;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">double</span> Ca, Oa, Vcmax, Vpmax, Vpr, Jmax;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">double</span> upperT=27.5, lowerT=3.0;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">double</span> lat = 40;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">int</span> nlayers = 3;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">double</span> kd = 0.1;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">double</span> chil = 1;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordtype">double</span> stomataws;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  SEXP growth;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  PROTECT(growth = allocVector(REALSXP,1));</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  LAI = REAL(lai)[0];</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  DOY = INTEGER(Doy)[0];</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  hr = INTEGER(Hr)[0];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  solarR = REAL(SolarR)[0];</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  Temp = REAL(ATemp)[0];</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  RH = REAL(RelH)[0];</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  WindSpeed = REAL(WindS)[0];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  Ca = REAL(CA)[0];</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  Oa = REAL(OA)[0];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  Vcmax = REAL(VCMAX)[0];</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  Vpmax = REAL(VPMAX)[0];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  Vpr = REAL(VPR)[0];</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  Jmax = REAL(JMAX)[0];</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  stomataws = REAL(STOMATAWS)[0];</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a>(lat,DOY,hr);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  Idir = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[0] * solarR;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  Idiff = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[1] * solarR;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  cosTh = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[2];</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a>(Idir,Idiff,LAI,nlayers,cosTh,kd,chil, 3);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">/* results from multilayer model */</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  LAIc = LAI / nlayers;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">/* Next I need the RH and wind profile */</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a>(RH,nlayers);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a>(WindSpeed,LAI,nlayers);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">/* Next use the EvapoTrans function */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  CanopyA=0.0;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      IDir = <a class="code" href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a>[--<a class="code" href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a>];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      Itot = <a class="code" href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a>[--<a class="code" href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a>];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      rh = <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>[--<a class="code" href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a>];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      WS = <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>[--<a class="code" href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a>];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      pLeafsun = <a class="code" href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a>[--<a class="code" href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a>];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      CanHeight = <a class="code" href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a>[--<a class="code" href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a>];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      Leafsun = LAIc * pLeafsun;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a> = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDir,Itot,Temp,rh,WS,Leafsun,CanHeight,stomataws,1,39,0.04,0.7,0.83,0.93,0.8,0.01,3,upperT,lowerT);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="comment">/* not the right thing to do here to add these values at the end of the ET function</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">but just a simple fix for now. The problem is that the eC4photoC function should have its own</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">EvapoTrans function. */</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      TempIdir = Temp + <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a>.Deltat;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      AssIdir = <a class="code" href="e_c4photo_8c.html#ac3eddd9862ded6e65643aea0cb9406c8">eC4photoC</a>(IDir,TempIdir,rh,Ca,Oa,Vcmax,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                         Vpmax,Vpr,Jmax);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      IDiff = <a class="code" href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a>[--<a class="code" href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a>];</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      pLeafshade = <a class="code" href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a>[--<a class="code" href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a>];</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      Leafshade = LAIc * pLeafshade;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      tmp6 = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDiff,Itot,Temp,rh,WS,Leafshade,CanHeight,stomataws,1,39,0.04,0.7,0.83,0.93,0.8,0.01,3,upperT,lowerT);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="comment">/* not the right thing to do here to add these values at the end of the ET function</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">but just a simple fix for now*/</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      TempIdiff = Temp + tmp6.Deltat;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      AssIdiff = <a class="code" href="e_c4photo_8c.html#ac3eddd9862ded6e65643aea0cb9406c8">eC4photoC</a>(IDiff,TempIdiff,rh,Ca,Oa,Vcmax,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                          Vpmax,Vpr,Jmax);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;     CanopyA += Leafsun * AssIdir + Leafshade * AssIdiff;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">/* These are micro mols of CO2 per m2 per sec</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">    Need to convert to </span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">    3600 converts seconds to hours</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">    10^-6 converts micro mols to mols</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  REAL(growth)[0] = cf * CanopyA ;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  UNPROTECT(1);  </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">return</span>(growth);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   }</div>
<div class="ttc" id="_aux_bio_cro_8c_html_acb415c4c261f9fc0140240ad46007c87"><div class="ttname"><a href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a></div><div class="ttdeci">void sunML(double Idir, double Idiff, double LAI, int nlayers, double cosTheta, double kd, double chil, double heightf)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:74</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a5a00a948cd8575f53c71ee1f4b799da5"><div class="ttname"><a href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a></div><div class="ttdeci">double layFshade[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:26</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a959c4cc4acdec59096dac039bfdb627b"><div class="ttname"><a href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a></div><div class="ttdeci">int sp3</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a048d95ccd2cc9d2f00c78c97343c9a6a"><div class="ttname"><a href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a></div><div class="ttdeci">int sp5</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_bio_cro_8h_html_ac656f07a64aeba7d6ac5a3a536e993c8"><div class="ttname"><a href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a></div><div class="ttdeci">double LAIc[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:16</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a05f213f4cb25cf49735180ff3b883107"><div class="ttname"><a href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a></div><div class="ttdeci">struct ET_Str EvapoTrans(double Rad, double Itot, double Airtemperature, double RH, double WindSpeed, double LeafAreaIndex, double CanopyHeight, double StomataWS, int ws, double vmax2, double alpha2, double kparm, double theta, double beta, double Rd2, double b02, double b12, double upperT, double lowerT, double Catm)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:208</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_acfad88ff5207b2ab57fc1dca17271065"><div class="ttname"><a href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a></div><div class="ttdeci">double tmp4[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:29</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_aab252cacb5d92c011d673d2db55cba0d"><div class="ttname"><a href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a></div><div class="ttdeci">double tmp1[3]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:21</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_ac86af9361847656ad3514e64ad9e9842"><div class="ttname"><a href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a></div><div class="ttdeci">int sp6</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a5ebe5f68c3871953059c08a083acdb9c"><div class="ttname"><a href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a></div><div class="ttdeci">double layHeight[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:27</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_aaa2add75bf14b805a4da749043e7be33"><div class="ttname"><a href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a></div><div class="ttdeci">double tmp5[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:30</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a972c42de1800efab3685fc8a47e05da5"><div class="ttname"><a href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a></div><div class="ttdeci">int sp2</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a0b8103786ef18d899e25c932a2eb5b88"><div class="ttname"><a href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a></div><div class="ttdeci">double layIdiff[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:23</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a25e1abfffbd0ba6bcb9e7d2b6c847c04"><div class="ttname"><a href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a></div><div class="ttdeci">int sp4</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_af8b40a97721000892ae5e0ac624af4c6"><div class="ttname"><a href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a></div><div class="ttdeci">int tp3</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:19</div></div>
<div class="ttc" id="e_c4photo_8c_html_ac3eddd9862ded6e65643aea0cb9406c8"><div class="ttname"><a href="e_c4photo_8c.html#ac3eddd9862ded6e65643aea0cb9406c8">eC4photoC</a></div><div class="ttdeci">double eC4photoC(double QP, double TEMP, double RH, double CA, double OA, double VCMAX, double VPMAX, double VPR, double JMAX)</div><div class="ttdef"><b>Definition:</b> eC4photo.c:140</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a15219c620f8cdf6d8cf731e485e2c668"><div class="ttname"><a href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a></div><div class="ttdeci">double tmp3[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:28</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a247148ac54cf7d8c851326de6093b71e"><div class="ttname"><a href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a></div><div class="ttdeci">void RHprof(double RH, int nlayers)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:144</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a43b0d68a959084dc4f4dc099c8901107"><div class="ttname"><a href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a></div><div class="ttdeci">void WINDprof(double WindSpeed, double LAI, int nlayers)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:128</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a1e5f45a584d3c5541472f92c5875e4ea"><div class="ttname"><a href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a></div><div class="ttdeci">double layItotal[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:24</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a36e4d9011835445995335074adedad9a"><div class="ttname"><a href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a></div><div class="ttdeci">int tp4</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:19</div></div>
<div class="ttc" id="struct_e_t___str_html"><div class="ttname"><a href="struct_e_t___str.html">ET_Str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:32</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a029005f88756e3761a72c104fae0d57b"><div class="ttname"><a href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a></div><div class="ttdeci">double layFsun[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:25</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a287f9452c1f62b4c5c9ec0616503fb8e"><div class="ttname"><a href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a></div><div class="ttdeci">int sp1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a46827eb56108821fe82228553f535293"><div class="ttname"><a href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a></div><div class="ttdeci">void lightME(double lat, int DOY, int td)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:26</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_ab0638a2083d3e8d4c1ac43a116da1ad8"><div class="ttname"><a href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a></div><div class="ttdeci">double layIdir[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:22</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8006074d888610622a3eb6cfcb111955"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP McMCEc4photo </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oASSIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oQP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oTEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oRelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NITER</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>iCA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>iOA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>iVCMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>iVPMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>iJMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>THRESH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SCALE</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                                       {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">/* First manipulate R objects */</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordtype">int</span> niter;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a> = length(oASSIM);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  niter = INTEGER(NITER)[0];</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="comment">/* Second define the needed variables */</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordtype">double</span> oldRsq = 0.5;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordtype">int</span> n1 = 0;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordtype">int</span> n2 = 0;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordtype">int</span> n3 = 0;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keywordtype">int</span> iters = 0;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordtype">int</span> i, k;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keywordtype">double</span> crit = 1 ;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordtype">double</span> thresh = REAL(THRESH)[0];</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordtype">double</span> scale = REAL(SCALE)[0];</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordtype">double</span> sd1, sd2, sd3;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keywordtype">double</span> index;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordtype">double</span> rlnum , rlden;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordtype">double</span> ratio;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordtype">double</span> U;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordtype">double</span> Rsq;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordtype">double</span> poldRsq;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordtype">double</span> Ca, Oa;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordtype">double</span>  poldVcmax, poldVpmax, poldVpr, poldJmax;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordtype">double</span> rnewVcmax, rnewVpmax, rnewVpr, rnewJmax;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordtype">double</span>  oldVcmax, oldVpmax, oldVpr, oldJmax;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keywordtype">double</span> assim[<a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>], qp[<a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>];</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordtype">double</span>  temp[<a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>], rh[<a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>];</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">for</span>(k = 0; k &lt; <a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>; k++){</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;     assim[k] = REAL(oASSIM)[k];</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;     qp[k] = REAL(oQP)[k];</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;     temp[k] = REAL(oTEMP)[k];</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;     rh[k] = REAL(oRelH)[k];</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  SEXP lists;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  SEXP names;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  SEXP mat1;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  SEXP mat2;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  SEXP accept1;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  SEXP accept2;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  SEXP accept3;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  SEXP RsqBI;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  SEXP CoefBI;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  PROTECT(lists = allocVector(VECSXP,7));</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  PROTECT(names = allocVector(STRSXP,7));</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  PROTECT(mat1 = allocMatrix(REALSXP,4,niter));</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  PROTECT(mat2 = allocMatrix(REALSXP,4,niter));</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  PROTECT(accept1 = allocVector(REALSXP,1));</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  PROTECT(accept2 = allocVector(REALSXP,1));</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  PROTECT(accept3 = allocVector(REALSXP,1));</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  PROTECT(RsqBI = allocVector(REALSXP,1));</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  PROTECT(CoefBI = allocVector(REALSXP,3));</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  GetRNGstate();</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  Ca = REAL(iCA)[0];</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  Oa = REAL(iOA)[0];</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  oldVcmax = REAL(iVCMAX)[0];</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  oldVpmax = REAL(iVPMAX)[0];</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  oldVpr   = 80;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="comment">/* Vpr is not optimized */</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  oldJmax = REAL(iJMAX)[0];</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  sd1 = 0.05 * oldVcmax * scale;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  sd2 = 0.05 * oldVpmax * scale;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  sd3 = 0.05 * oldJmax * scale;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   <span class="keywordflow">while</span>((iters &lt; niter) &amp;&amp; (crit &gt; thresh)){ </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;     iters++;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;     <span class="comment">/* Replacing the rnormCV */</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;     index = floor(runif(1,4)); </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;       rnewVcmax = oldVcmax;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;       rnewVpmax = oldVpmax;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;       rnewVpr = oldVpr;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;       rnewJmax = oldJmax;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;     <span class="keywordflow">if</span>(index == 1){ </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;       rnewVcmax = oldVcmax + rnorm(0,sd1);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;     }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;     <span class="keywordflow">if</span>(index == 2){ </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;       rnewVpmax = oldVpmax  + rnorm(0,sd2);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;     }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;     <span class="comment">/*     if(index == 3){ </span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">       rnewVpr = oldVpr + rnorm(0,0.8);</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">       } */</span> </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;     <span class="keywordflow">if</span>(index == 3){ </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;       rnewJmax = oldJmax + rnorm(0,sd3);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;     }  </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;     <span class="comment">/* Finish of the rnormCV function */</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      Rsq = <a class="code" href="e_c4photo_8c.html#a4f766a8f283c0736da0ab400ace4abba">RsqeC4photo</a>(assim,qp,temp,rh,Ca,Oa,</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                       rnewVcmax,rnewVpmax,rnewVpr,</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                       rnewJmax);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keywordflow">if</span>(Rsq &gt; oldRsq){</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        oldRsq = Rsq;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        oldVcmax = rnewVcmax;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        oldVpmax = rnewVpmax;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        oldVpr = rnewVpr;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        oldJmax = rnewJmax;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        REAL(mat1)[n1*4] = oldVcmax;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        REAL(mat1)[1 + n1*4] = oldVpmax;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="comment">/*      REAL(mat1)[2 + n1*5] = oldVpr;*/</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        REAL(mat1)[2 + n1*4] = oldJmax;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        REAL(mat1)[3 + n1*4] = oldRsq;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        crit = (1 - Rsq)/Rsq;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        n1++;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;     }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    poldRsq = oldRsq;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    poldVcmax = oldVcmax;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    poldVpmax = oldVpmax;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    poldVpr = oldVpr;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    poldJmax = oldJmax;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; niter; i++){</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="comment">/* Replacing the rnormC4 function */</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;     index = floor(runif(1,4)); </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;       rnewVcmax = oldVcmax;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;       rnewVpmax = oldVpmax;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;       rnewVpr = oldVpr;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;       rnewJmax = oldJmax;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;     <span class="keywordflow">if</span>(index == 1){ </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;       rnewVcmax = oldVcmax + rnorm(0,sd1);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;     }</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;     <span class="keywordflow">if</span>(index == 2){ </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;       rnewVpmax = oldVpmax  + rnorm(0,sd2);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;     }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;     <span class="comment">/*     if(index == 3){ </span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">       rnewVpr = oldVpr + rnorm(0,0.8);</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">     }  */</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;     <span class="keywordflow">if</span>(index == 3){ </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;       rnewJmax = oldJmax + rnorm(0,sd3);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;     }  </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="comment">/* This is the end of the random generation */</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      Rsq = <a class="code" href="e_c4photo_8c.html#a4f766a8f283c0736da0ab400ace4abba">RsqeC4photo</a>(assim,qp,temp,rh,Ca,Oa,</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                       rnewVcmax,rnewVpmax,rnewVpr,</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                       rnewJmax);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">if</span>(Rsq &gt; poldRsq){</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;          <span class="comment">/* This time I&#39;m suming to avoid overflow */</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;          <span class="comment">/* So I&#39;ve taken the log */</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;          rlnum = dnorm(rnewVcmax,oldVcmax,sd1,0) +</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                  dnorm(rnewVpmax,oldVpmax,sd2,0) +</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="comment">/*          dnorm(rnewVpr,oldVpr,1.2,0) +*/</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                  dnorm(rnewJmax,oldJmax,sd3,0);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;          rlden = dnorm(oldVcmax,oldVcmax,sd1,0) +</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                  dnorm(oldVpmax,oldVpmax,sd2,0) +</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <span class="comment">/*            dnorm(oldVpr,oldVpr,1.2,0) +*/</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                  dnorm(oldJmax,oldJmax,sd3,0);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;          </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;          <span class="comment">/* This is in the log scale */</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;          ratio = (rlnum - rlden);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;          U = runif(0,1);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;          <span class="keywordflow">if</span>(ratio &gt; log(U)){</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            oldVcmax = rnewVcmax;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            oldVpmax = rnewVpmax;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            oldVpr = rnewVpr;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            oldJmax = rnewJmax;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            n3++;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;          REAL(mat2)[n2*4] = rnewVcmax;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          REAL(mat2)[n2*4 + 1] = rnewVpmax;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;          <span class="comment">/*      REAL(mat2)[n2*4 + 2] = rnewVpr; */</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          REAL(mat2)[n2*4 + 2] = rnewJmax;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          REAL(mat2)[n2*4 + 3] = Rsq;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;          n2++;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;     </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    REAL(accept1)[0] = n1;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    REAL(accept2)[0] = n2;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    REAL(accept3)[0] = n3;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    REAL(RsqBI)[0] = poldRsq;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    REAL(CoefBI)[0] = poldVcmax;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    REAL(CoefBI)[1] = poldVpmax;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">/*    REAL(CoefBI)[2] = poldVpr;*/</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    REAL(CoefBI)[2] = poldJmax;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    SET_VECTOR_ELT(lists,0,RsqBI);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    SET_VECTOR_ELT(lists,1,CoefBI);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    SET_VECTOR_ELT(lists,2,accept1);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    SET_VECTOR_ELT(lists,3,mat1);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    SET_VECTOR_ELT(lists,4,mat2);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    SET_VECTOR_ELT(lists,5,accept2);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    SET_VECTOR_ELT(lists,6,accept3);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    SET_STRING_ELT(names,0,mkChar(<span class="stringliteral">&quot;RsqBI&quot;</span>));</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    SET_STRING_ELT(names,1,mkChar(<span class="stringliteral">&quot;CoefBI&quot;</span>));</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    SET_STRING_ELT(names,2,mkChar(<span class="stringliteral">&quot;accept1&quot;</span>));</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    SET_STRING_ELT(names,3,mkChar(<span class="stringliteral">&quot;resuBI&quot;</span>));</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    SET_STRING_ELT(names,4,mkChar(<span class="stringliteral">&quot;resuMC&quot;</span>));</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    SET_STRING_ELT(names,5,mkChar(<span class="stringliteral">&quot;accept2&quot;</span>));</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    SET_STRING_ELT(names,6,mkChar(<span class="stringliteral">&quot;accept3&quot;</span>));</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    setAttrib(lists,R_NamesSymbol,names);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    UNPROTECT(9);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    PutRNGstate();</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">return</span>(lists);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;}</div>
<div class="ttc" id="e_c4photo_8c_html_a4f766a8f283c0736da0ab400ace4abba"><div class="ttname"><a href="e_c4photo_8c.html#a4f766a8f283c0736da0ab400ace4abba">RsqeC4photo</a></div><div class="ttdeci">double RsqeC4photo(double oAssim[enObs], double oQp[enObs], double oTemp[enObs], double oRH[enObs], double Ca, double Oa, double Vcmax, double Vpmax, double Vpr, double Jmax)</div><div class="ttdef"><b>Definition:</b> eC4photo.c:728</div></div>
<div class="ttc" id="e_c4photo_8c_html_a44f34a427107babc7cd2db474942ee24"><div class="ttname"><a href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a></div><div class="ttdeci">int enObs</div><div class="ttdef"><b>Definition:</b> eC4photo.c:13</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4f766a8f283c0736da0ab400ace4abba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double RsqeC4photo </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oAssim</em>[enObs], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oQp</em>[enObs], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oTemp</em>[enObs], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oRH</em>[enObs], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ca</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Oa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vcmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vpmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vpr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                                                         {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordtype">double</span> vec1[<a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>];</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordtype">int</span> i, j;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keywordtype">double</span> SST = 0.0, SSE = 0.0, diff;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordtype">double</span> Rsquare = 0.0;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">for</span>(i = 0;i &lt; <a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>; i++){</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    vec1[i] = <a class="code" href="e_c4photo_8c.html#ac3eddd9862ded6e65643aea0cb9406c8">eC4photoC</a>(oQp[i],oTemp[i],</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                       oRH[i],COa,O2a,Vcmax,Vpmax,</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                       Vpr,Jmax);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="keywordflow">for</span>(j = 0 ; j &lt; <a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>; j++){</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    SST += pow(oAssim[j],2);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    diff = oAssim[j] - vec1[j];</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    SSE += pow(diff,2);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  Rsquare = (SST - SSE)/SST ; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordflow">return</span>(Rsquare);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;}</div>
<div class="ttc" id="e_c4photo_8c_html_a44f34a427107babc7cd2db474942ee24"><div class="ttname"><a href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a></div><div class="ttdeci">int enObs</div><div class="ttdef"><b>Definition:</b> eC4photo.c:13</div></div>
<div class="ttc" id="e_c4photo_8c_html_ac3eddd9862ded6e65643aea0cb9406c8"><div class="ttname"><a href="e_c4photo_8c.html#ac3eddd9862ded6e65643aea0cb9406c8">eC4photoC</a></div><div class="ttdeci">double eC4photoC(double QP, double TEMP, double RH, double CA, double OA, double VCMAX, double VPMAX, double VPR, double JMAX)</div><div class="ttdef"><b>Definition:</b> eC4photo.c:140</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a44f34a427107babc7cd2db474942ee24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int enObs</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="e_c4photo_8c.html">eC4photo.c</a></li>
    <li class="footer">Generated on Fri Apr 3 2015 15:41:06 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
