<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>BioCro: /home/dlebauer/dev/biocro/src/maizeGro.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('maize_gro_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">maizeGro.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;R.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;Rmath.h&gt;</code><br/>
<code>#include &lt;Rinternals.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="">AuxBioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">BioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">Century.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">maizeGro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">AuxMaizeGro.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for maizeGro.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="maize_gro_8c__incl.png" border="0" usemap="#_2home_2dlebauer_2dev_2biocro_2src_2maize_gro_8c" alt=""/></div>
<map name="_2home_2dlebauer_2dev_2biocro_2src_2maize_gro_8c" id="_2home_2dlebauer_2dev_2biocro_2src_2maize_gro_8c">
<area shape="rect" id="node6" href="_aux_bio_cro_8h.html" title="AuxBioCro.h" alt="" coords="373,96,469,123"/><area shape="rect" id="node7" href="_bio_cro_8h.html" title="BioCro.h" alt="" coords="494,96,567,123"/><area shape="rect" id="node8" href="_century_8h.html" title="Century.h" alt="" coords="591,96,669,123"/><area shape="rect" id="node9" href="maize_gro_8h.html" title="maizeGro.h" alt="" coords="694,96,783,123"/><area shape="rect" id="node10" href="_aux_maize_gro_8h.html" title="AuxMaizeGro.h" alt="" coords="808,96,919,123"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad987f933818212fb33b15deb15ca991e"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maize_gro_8c.html#ad987f933818212fb33b15deb15ca991e">maizeGro</a> (SEXP DOY, SEXP HR, SEXP SOLAR, SEXP TEMP, SEXP RH, SEXP WINDSPEED, SEXP PRECIP, SEXP DATES, SEXP PHENOP, SEXP PHOTOP, SEXP CANOPYP, SEXP NITROP, SEXP LAIP, SEXP MALLOCP, SEXP LAT, SEXP TIMESTEP, SEXP PLANTDENSITY, SEXP SOILP, SEXP SOILP2, SEXP SOILDEPTHS, SEXP CWS, SEXP SENEP, SEXP NNITROP)</td></tr>
<tr class="separator:ad987f933818212fb33b15deb15ca991e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad987f933818212fb33b15deb15ca991e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP maizeGro </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>HR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOLAR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WINDSPEED</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>PRECIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>DATES</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>PHENOP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>PHOTOP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CANOPYP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NITROP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LAIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>MALLOCP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TIMESTEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>PLANTDENSITY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILP2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILDEPTHS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SENEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NNITROP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/* Initializing variables  */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordtype">int</span> vecsize = 8760 ; <span class="comment">/* 365 days * 24 hours  */</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordtype">int</span> i, i2, i3, i4;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keyword">struct </span><a class="code" href="structnitro_parms.html">nitroParms</a> nitroparms;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordtype">double</span> TEMPdoubletoint;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        nitroparms.<a class="code" href="structnitro_parms.html#a81548389d7bb414fbf85c27cc1df21ad">ileafN</a>=REAL(NNITROP)[0];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        nitroparms.kln=REAL(NNITROP)[1];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        nitroparms.Vmaxb1=REAL(NNITROP)[2];</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        nitroparms.Vmaxb0=REAL(NNITROP)[3];</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        nitroparms.alphab1=REAL(NNITROP)[4];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        nitroparms.alphab0=REAL(NNITROP)[5];</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        nitroparms.Rdb1=REAL(NNITROP)[6];</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        nitroparms.Rdb0=REAL(NNITROP)[7];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        nitroparms.kpLN=REAL(NNITROP)[8];</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        nitroparms.lnb0=REAL(NNITROP)[9];</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        nitroparms.lnb1=REAL(NNITROP)[10];</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        TEMPdoubletoint=REAL(NNITROP)[11];</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        nitroparms.lnFun=(int)TEMPdoubletoint;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        nitroparms.maxln=REAL(NNITROP)[12];</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        nitroparms.minln=REAL(NNITROP)[13];</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        nitroparms.daymaxln=REAL(NNITROP)[14];</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">/* Some structures */</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keyword">struct </span><a class="code" href="structlai__str.html">lai_str</a> tmpLAI;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keyword">struct </span><a class="code" href="structmaize__dbp__str.html">maize_dbp_str</a> tmpDBP;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keyword">struct </span><a class="code" href="structsoil_m_l__str.html">soilML_str</a> soilMLS;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> soTexS; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keyword">struct </span><a class="code" href="structws__str.html">ws_str</a> WaterS;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordtype">int</span> plantDate, emergeDate, harvestDate;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordtype">double</span> baseTemp, maxLeaves;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordtype">double</span> plantEmerge, phyllochron1, phyllochron2;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordtype">double</span> R1, R2, R3, R4, R5, R6;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordtype">double</span> phenoStage = 0.0;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">double</span> TTc = 0.0, TTc_V10 = 0.0, TTc_Vn = 0.0;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordtype">double</span> LAI = 0.0;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordtype">double</span> lat = REAL(LAT)[0];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordtype">int</span> timestep = INTEGER(TIMESTEP)[0];</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">/* Variables for photosynthesis */</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordtype">double</span> vmax1, vmax11, vmax12, alpha1, kparm1, theta, beta, Rd11, Rd12, Rd1,upperT,lowerT;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordtype">double</span> vmax;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordtype">double</span> alpha;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordtype">double</span> Ca, b01, b11, ws_0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordtype">int</span> ws;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordtype">double</span> StomWS = 1;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordtype">double</span> CanopyA, CanopyT;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> Canopy;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">/* Variables for canopy */</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordtype">double</span> Sp, SpD, nlayers, kd, chil, heightFactor;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordtype">double</span> mrc1, mrc2;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">/* Variables for senescence */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordtype">double</span> seneLeaf, seneStem, seneRoot;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordtype">double</span> newLeafcol[8760];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordtype">double</span> newStemcol[8760];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordtype">double</span> newRootcol[8760];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordtype">double</span> *sti, *sti2, *sti3;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordtype">int</span> k = 0, j = 0, q = 0, m = 0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        sti = &amp;newLeafcol[0];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        sti2 = &amp;newStemcol[0];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        sti3 = &amp;newRootcol[0];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">/* Variables for nitrogen */</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordtype">double</span> iLeafN, kLN, vmax_b1, alpha_b1, kpLN, lnb0, lnb1, lnFun_0;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordtype">double</span> LeafN, LeafNR;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordtype">int</span> lnFun; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">/* Variables for leaf area index */</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordtype">double</span> laiMethod, TTcoef, maxLAI;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordtype">double</span> Ax, LNx, LT, a1, a2, k0, L0, LLx, Lx, LNl, Amax, c1, c2, c3, </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          c4, a, b, x0, f, g;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">/* Variables for C allocation */</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordtype">double</span> kLeaf, kStem, kRoot, kGrain;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordtype">double</span> newLeaf, newStem, newRoot, newGrain;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordtype">double</span> Leaf = 0.0, Stem = 0.0, Root = 0.0, Grain = 0.0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordtype">double</span> plantdensity = REAL(PLANTDENSITY)[0];</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">/* Variables for soil parameters */</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordtype">double</span> FieldC, WiltP, phi1, phi2, soilDepth;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordtype">int</span> soilType, wsFun, hydrDist;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordtype">double</span> soilEvap, TotEvap;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordtype">double</span> waterCont = 0.3;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordtype">double</span> LeafWS = 1;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordtype">int</span> soillayers = INTEGER(SOILP2)[1];</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordtype">double</span> cwsVec[soillayers];</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">for</span>(i3=0;i3&lt;soillayers;i3++){</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                cwsVec[i3] = REAL(CWS)[i3];</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        } </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordtype">double</span> cwsVecSum = 0.0;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordtype">double</span> rfl;  <span class="comment">/* root factor lambda */</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordtype">double</span> rsec; <span class="comment">/* radiation soil evaporation coefficient */</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordtype">double</span> rsdf; <span class="comment">/* root soil depth factor */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordtype">double</span> scsf; <span class="comment">/* stomatal conductance sensitivity factor */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordtype">double</span> transpRes; <span class="comment">/* Resistance to transpiration from soil to leaf */</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordtype">double</span> leafPotTh; <span class="comment">/* Leaf water potential threshold */</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="comment">/* Parameters for calculating leaf water potential */</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordtype">double</span> LeafPsim = 0.0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">/* Extracting dates */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        plantDate = INTEGER(DATES)[0];</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        emergeDate = INTEGER(DATES)[1];</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        harvestDate = INTEGER(DATES)[2];</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">/* Extracting phenology parameters */</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        baseTemp = REAL(PHENOP)[0];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        maxLeaves = REAL(PHENOP)[1];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        plantEmerge = REAL(PHENOP)[2];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        phyllochron1 = REAL(PHENOP)[3];</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        phyllochron2 = REAL(PHENOP)[4];</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        R1 = REAL(PHENOP)[5];</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        R2 = REAL(PHENOP)[6];</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        R3 = REAL(PHENOP)[7];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        R4 = REAL(PHENOP)[8];</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        R5 = REAL(PHENOP)[9];</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        R6 = REAL(PHENOP)[10];</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">/* Extracting photosynthesis parameters */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        vmax11 = REAL(PHOTOP)[0];</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        vmax12 = REAL(PHOTOP)[1];</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        vmax = vmax11;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        alpha1 = REAL(PHOTOP)[2];</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        alpha = alpha1;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        kparm1 = REAL(PHOTOP)[3];</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        theta = REAL(PHOTOP)[4];</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        beta = REAL(PHOTOP)[5];</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        Rd11 = REAL(PHOTOP)[6];</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        Rd12 = REAL(PHOTOP)[7];</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        Ca = REAL(PHOTOP)[8];</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        b01 = REAL(PHOTOP)[9];</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        b11 = REAL(PHOTOP)[10];</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        ws_0 = REAL(PHOTOP)[11];</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        ws = ws_0;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        upperT = REAL(PHOTOP)[12];</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        lowerT= REAL(PHOTOP)[13];</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">/* Extracting canopy parameters */</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        Sp = REAL(CANOPYP)[0];</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        SpD = REAL(CANOPYP)[1];</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        nlayers = REAL(CANOPYP)[2];</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        kd = REAL(CANOPYP)[3];</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        chil = REAL(CANOPYP)[4];</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        mrc1 = REAL(CANOPYP)[5];</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        mrc2 = REAL(CANOPYP)[6];</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        heightFactor = REAL(CANOPYP)[7];</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">/* Extracting senescence parameters */</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        seneStem = REAL(SENEP)[0];</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        seneLeaf = REAL(SENEP)[1];</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        seneRoot = REAL(SENEP)[2];</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">/* Extracting nitrogen parameters */</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        iLeafN = REAL(NITROP)[0];</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        LeafN = iLeafN;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        kLN = REAL(NITROP)[1];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        vmax_b1 = REAL(NITROP)[2];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        alpha_b1 = REAL(NITROP)[3];</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        kpLN = REAL(NITROP)[4];</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        lnb0 = REAL(NITROP)[5];</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        lnb1 = REAL(NITROP)[6];</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        lnFun_0 = REAL(NITROP)[7];</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        lnFun = lnFun_0;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">/* Extracting LAI parms */</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        laiMethod = REAL(LAIP)[0];</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        TTcoef = REAL(LAIP)[1];</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        maxLAI = REAL(LAIP)[2];</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        Ax = REAL(LAIP)[3];</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        LT = REAL(LAIP)[4];</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        a1 = REAL(LAIP)[5];</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        a2 = REAL(LAIP)[6];</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        k0 = REAL(LAIP)[7];</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        L0 = REAL(LAIP)[8];</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        LLx = REAL(LAIP)[9];</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        Lx = REAL(LAIP)[10];</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        LNl = REAL(LAIP)[11];</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        Amax = REAL(LAIP)[12];</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        c1 = REAL(LAIP)[13];</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        c2 = REAL(LAIP)[14];</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        c3 = REAL(LAIP)[15];</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        c4 = REAL(LAIP)[16];</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        a = REAL(LAIP)[17];</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        b = REAL(LAIP)[18];</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        x0 = REAL(LAIP)[19];</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        f = REAL(LAIP)[20];</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        g = REAL(LAIP)[21];</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">/* Extracting soil parameters */</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        FieldC = REAL(SOILP)[0];</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        WiltP = REAL(SOILP)[1];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        phi1 = REAL(SOILP)[2];</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        phi2 = REAL(SOILP)[3];</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        soilDepth = REAL(SOILP)[4];</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        scsf = REAL(SOILP)[5];</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        transpRes = REAL(SOILP)[6];</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        leafPotTh = REAL(SOILP)[7];</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        rfl = REAL(SOILP)[8];</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        rsec = REAL(SOILP)[9];</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        rsdf = REAL(SOILP)[10];</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">/* Extracting soil parameters 2 */</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        soilType = INTEGER(SOILP2)[0];</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        wsFun = INTEGER(SOILP2)[2];</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        hydrDist = INTEGER(SOILP2)[3];</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        soTexS = <a class="code" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a>(soilType);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">/* Create list components */</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        SEXP lists;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        SEXP names;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        SEXP DayofYear;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        SEXP Hour;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        SEXP TTTc;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        SEXP PhenoStage;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        SEXP <a class="code" href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        SEXP CanopyTrans;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        SEXP <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        SEXP LeafVec;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        SEXP StemVec;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        SEXP RootVec;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        SEXP GrainVec;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        SEXP LAImat;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        SEXP VmaxVec;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        SEXP LeafNVec;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        SEXP cwsMat;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        SEXP psimMat; <span class="comment">/* Holds the soil water potential */</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        SEXP rdMat;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        SEXP SCpools;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        SEXP SNpools;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        SEXP LeafPsimVec;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        SEXP SoilEvaporation;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        SEXP SoilWatCont;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        SEXP StomatalCondCoefs;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        PROTECT(lists = allocVector(VECSXP,23)); <span class="comment">/* 1 */</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        PROTECT(names = allocVector(STRSXP,23)); <span class="comment">/* 2 */</span>  </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        PROTECT(DayofYear = allocVector(REALSXP,vecsize)); <span class="comment">/* 3 */</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        PROTECT(Hour = allocVector(REALSXP,vecsize)); <span class="comment">/* 4 */</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        PROTECT(TTTc = allocVector(REALSXP,vecsize)); <span class="comment">/* 5 */</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        PROTECT(PhenoStage = allocVector(REALSXP,vecsize)); <span class="comment">/* 6 */</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        PROTECT(CanopyAssim = allocVector(REALSXP,vecsize)); <span class="comment">/* 7 */</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        PROTECT(CanopyTrans = allocVector(REALSXP,vecsize)); <span class="comment">/* 8 */</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        PROTECT(LAIc = allocVector(REALSXP,vecsize)); <span class="comment">/* 9 */</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        PROTECT(LeafVec = allocVector(REALSXP,vecsize)); <span class="comment">/* 10 */</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        PROTECT(StemVec = allocVector(REALSXP,vecsize)); <span class="comment">/* 11 */</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        PROTECT(RootVec = allocVector(REALSXP,vecsize)); <span class="comment">/* 12 */</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        PROTECT(GrainVec = allocVector(REALSXP,vecsize)); <span class="comment">/* 13 */</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        PROTECT(LAImat = allocMatrix(REALSXP,<a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>,vecsize)); <span class="comment">/* 14 */</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        PROTECT(VmaxVec = allocVector(REALSXP,vecsize)); <span class="comment">/* 15 */</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        PROTECT(LeafNVec = allocVector(REALSXP,vecsize)); <span class="comment">/* 16 */</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        PROTECT(cwsMat = allocMatrix(REALSXP,soillayers,vecsize)); <span class="comment">/* 17 */</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        PROTECT(psimMat = allocMatrix(REALSXP,soillayers,vecsize)); <span class="comment">/* 18 */</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        PROTECT(rdMat = allocMatrix(REALSXP,soillayers,vecsize)); <span class="comment">/* 19 */</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        PROTECT(SCpools = allocVector(REALSXP,9)); <span class="comment">/* 20 */</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        PROTECT(SNpools = allocVector(REALSXP,9)); <span class="comment">/* 21 */</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        PROTECT(LeafPsimVec = allocVector(REALSXP,vecsize)); <span class="comment">/* 22 */</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        PROTECT(SoilEvaporation = allocVector(REALSXP,vecsize)); <span class="comment">/* 23 */</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        PROTECT(SoilWatCont = allocVector(REALSXP,vecsize)); <span class="comment">/* 24 */</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        PROTECT(StomatalCondCoefs = allocVector(REALSXP,vecsize)); <span class="comment">/* 25 */</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordtype">int</span> *pt_doy = INTEGER(DOY);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordtype">int</span> *pt_hr = INTEGER(HR);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordtype">double</span> *pt_temp = REAL(TEMP);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordtype">double</span> *pt_solar = REAL(SOLAR);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keywordtype">double</span> *pt_rh = REAL(RH);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordtype">double</span> *pt_windspeed = REAL(WINDSPEED);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordtype">double</span> *pt_precip = REAL(PRECIP);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">for</span>(i=0;i&lt;vecsize;i++)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <span class="comment">/* First calculate the elapsed Thermal Time*/</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="comment">/* The idea is that here I need to divide by the time step</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">                   to calculate the thermal time. For example, a 3 hour time interval</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">                   would mean that the division would need to by 8 */</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="comment">/* If before planting date phenology is not calculated */</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <span class="keywordflow">if</span>(*(pt_doy+i) &lt; plantDate){</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                        REAL(PhenoStage)[i] = -1;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                        REAL(TTTc)[i] = 0;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                        <span class="keywordflow">if</span>(*(pt_doy+i) &gt;= harvestDate){</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                REAL(TTTc)[i] = TTc;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                REAL(PhenoStage)[i] = -1;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                <span class="keywordflow">if</span>(*(pt_temp+i) &gt; baseTemp){</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                        TTc += (*(pt_temp+i) - baseTemp)  / (24/timestep); </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                REAL(TTTc)[i] = TTc; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                <span class="keywordflow">if</span>(TTc &lt; plantEmerge || *(pt_doy+i) &lt; emergeDate){</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                        REAL(PhenoStage)[i] = 0.0;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                        <span class="keywordflow">if</span>(REAL(PhenoStage)[i-1] &lt; 0.10){</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                                REAL(PhenoStage)[i] = floor(TTc / phyllochron1) / 100;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                                TTc_V10 = TTc;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                        }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                                <span class="keywordflow">if</span>(REAL(PhenoStage)[i-1] &lt; 1){</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                                        REAL(PhenoStage)[i] = 0.10 + </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                                                floor((TTc - TTc_V10) / phyllochron2) / 100;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                                        TTc_Vn = TTc;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                                }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                        </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                        <span class="keywordflow">if</span>(TTc &gt; R1) REAL(PhenoStage)[i] = 1;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                        </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                        <span class="keywordflow">if</span>(TTc &gt; R2) REAL(PhenoStage)[i] = 2;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                        </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                        <span class="keywordflow">if</span>(TTc &gt; R3) REAL(PhenoStage)[i] = 3;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                        </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                        <span class="keywordflow">if</span>(TTc &gt; R4) REAL(PhenoStage)[i] = 4;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                        </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                        <span class="keywordflow">if</span>(TTc &gt; R5) REAL(PhenoStage)[i] = 5;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                        </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                        <span class="keywordflow">if</span>(TTc &gt; R6) REAL(PhenoStage)[i] = 6;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                        <span class="comment">/* if(*(pt_doy+i) &gt;= harvestDate) REAL(PhenoStage)[i] = -1; */</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                        }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">/* There are several possible approaches to modleing LAI. One is solely based on thermal time */</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">/* another one is based on specific leaf area and the third one in based on modeling individual leaves */</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">/* citations below */</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;               <span class="comment">/* LAI following Lizaso J, Batchelor WD, Westgate ME. A</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">                * leaf area model to simulate cultivar-specific</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">                * expansion and senescence of maize leaves. Field</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">                * Crops Research. 2003;80(1):1-17. Available at:</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">                * http://linkinghub.elsevier.com/retrieve/pii/S037842900200151X. */</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                phenoStage = REAL(PhenoStage)[i];</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <span class="keywordflow">if</span>(*(pt_doy+i) &lt; emergeDate){</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                        LAI = 0.0;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                        CanopyA = 0.0;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        CanopyT = 0.0;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                        <span class="keywordflow">for</span>(i2=0;i2&lt;<a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>;i2++){</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                REAL(LAImat)[i2 + i*<a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>] = 0.0;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                        }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                        <span class="keywordflow">if</span>(laiMethod == 0.0){</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="comment">/* Implementing the simplest method based on thermal time */</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                LAI = fabs(TTc * TTcoef - plantEmerge * TTcoef);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                        }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                        </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                        <span class="keywordflow">if</span>(laiMethod == 1.0){</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                LAI = Leaf * Sp + 1e-3;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                        }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        <span class="keywordflow">if</span>(laiMethod == 2.0){</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                tmpLAI = <a class="code" href="_aux_maize_gro_8c.html#a8df740a747a3d6378541a4f69bbff29f">laiLizasoFun</a>(TTc, phenoStage, phyllochron1,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                                      phyllochron2, Ax, LT, k0,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                                                      a1, a2, L0, LLx, Lx, LNl);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                <span class="keywordflow">for</span>(i2=0;i2&lt;<a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>;i2++){</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                        REAL(LAImat)[i2 + i*<a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>] = tmpLAI.leafarea[i2];</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                LAI = tmpLAI.totalLeafArea * 1e-4 * plantdensity; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                        }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                        <span class="keywordflow">if</span>(laiMethod == 3.0){</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                tmpLAI = <a class="code" href="_aux_maize_gro_8c.html#a52d47bd7f4906cfb7034a8f7e22c29e0">laiBirchdiscontinuousFun</a>(phenoStage, LT, Amax, </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                                                  c1, c2, c3, c4); </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                <span class="comment">/* Amax = area of largest leaf (-1 if unspecified in which</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">                                 * case it will be calculated by Birch eq 13), c1 is coefficient</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">                                 * for Birch eq 15, c2 is coefficient for Birch eq 16, c3 and c4</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">                                 * are the first and second coefficients in Birch eq 17</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">                                 */</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                                <span class="keywordflow">for</span> (i2 = 0; i2 &lt; <a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>; i2++){</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                        REAL(LAImat)[i2 + i * <a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>] = tmpLAI.leafarea[i2];</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                LAI = tmpLAI.totalLeafArea * 1e-4 * plantdensity;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                        }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                        <span class="keywordflow">if</span>(laiMethod == 4.0){</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                tmpLAI = <a class="code" href="_aux_maize_gro_8c.html#a51216bb4e018f7bc8aa10952ffdc102c">laiBirchcontinuousFun</a>(phenoStage, a, b, Amax, x0, </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                                                           f, g, TTc, LT);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                <span class="comment">/* a and b are coefficients to Birch Eq 5, x0 is leaf number</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">                                 * of largest leaf, and f and g are coefficients to Birch</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">                                 * Eq 11.</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">                                 */</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                <span class="keywordflow">for</span> (i2 = 0; i2 &lt; <a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>; i2++){</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                        REAL(LAImat)[i2 + i * <a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>] = tmpLAI.leafarea[i2];</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                LAI = tmpLAI.totalLeafArea / 1e4 * plantdensity;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                        }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                 <span class="comment">/* Total leaf area will be in cm2, for a meter squared I need to divide by 1e4*/</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                        <span class="keywordflow">if</span>(LAI &gt; maxLAI) LAI = maxLAI;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                        <span class="keywordflow">if</span>(LAI &lt; 1e-3) LAI = 1e-3;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                      </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">/* There is a different value of Rd for vegetative vs. reproductive */</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <span class="keywordflow">if</span>(phenoStage &lt; 1){</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                        Rd1 = Rd11;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                        vmax1 = vmax11;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                        Rd1 = Rd12;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                        vmax1 = vmax12;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;               <span class="comment">/* Calculate Canopy Assimilation  */</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">/* Canopy Assimilation should only happen between emergence and R6 */</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <span class="comment">/* if(*(pt_doy+i) &gt; emergeDate &amp;&amp; *(pt_doy+i) &lt; harvestDate){ */</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <span class="keywordflow">if</span>(*(pt_doy+i) &gt; emergeDate &amp;&amp; TTc &lt; R6){</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                        Canopy = <a class="code" href="_aux_bio_cro_8c.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a>(LAI, *(pt_doy+i), *(pt_hr+i),</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                       *(pt_solar+i), *(pt_temp+i),</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                                       *(pt_rh+i), *(pt_windspeed+i),</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                       lat, nlayers,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                                       vmax,alpha,kparm1,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                       theta,beta,Rd1,Ca,b01,b11,StomWS,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                       ws, kd,</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                       chil, heightFactor,</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                       LeafN, kpLN, lnb0, lnb1, lnFun,upperT,lowerT,nitroparms);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                        <span class="comment">/* Rprintf(&quot;LAI: %.4f, vmax: %.1f&quot;,LAI,vmax);  */</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                        CanopyA = Canopy.Assim * timestep;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                        CanopyT = Canopy.Trans * timestep;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                        q++;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                        CanopyA = 0.0;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                        CanopyT = 0.0;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;               <span class="comment">/* Section about N deficiency on Vmax */</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;               <span class="comment">/* The equation below works well for the vegetative part */</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                <span class="keywordflow">if</span>(phenoStage &lt; 1){</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                        LeafN = iLeafN * pow(Stem + Leaf,-kLN); </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                        <span class="keywordflow">if</span>(LeafN &gt; iLeafN) LeafN = iLeafN;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                        LeafNR = LeafN;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                        LeafN = LeafNR - (TTc - R1) * (kLN * 0.0045);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                        <span class="keywordflow">if</span>(LeafN &lt; 1e-3) LeafN = 1e-3;  </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <span class="keywordflow">if</span>(phenoStage == -1) LeafN = 0;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                <span class="comment">/* vmax = (iLeafN - LeafN) * vmax_b1 + vmax1; */</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                vmax = vmax1 * (2/(1 + exp(-vmax_b1*(LeafN - 0.02))) - 1); </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                <span class="comment">/* if(vmax &lt; 0){ */</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <span class="comment">/*      Rprintf(&quot;vmax1: %.1f, vmax_b1: %.3f, LeafN: %.1f&quot;,vmax1,vmax_b1,LeafN); */</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                <span class="comment">/*         error(&quot;stop here&quot;); */</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                <span class="comment">/* } */</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                alpha = (iLeafN - LeafN) * alpha_b1 + alpha1; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                <span class="comment">/* Inserting the multilayer model */</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                <span class="keywordflow">if</span>(soillayers &gt; 1){</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                        soilMLS = <a class="code" href="_aux_bio_cro_8c.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a>(*(pt_precip+i), CanopyT, &amp;cwsVec[0], soilDepth, </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                         REAL(SOILDEPTHS), FieldC, WiltP,</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                                         phi1, phi2, soTexS, wsFun, soillayers, Root, </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                         LAI, 0.68, *(pt_temp+i), *(pt_solar), *(pt_windspeed+i), *(pt_rh+i), </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                         hydrDist, rfl, rsec, rsdf);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                        StomWS = soilMLS.rcoefPhoto;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                        LeafWS = soilMLS.rcoefSpleaf;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                        soilEvap = soilMLS.SoilEvapo;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                        <span class="keywordflow">for</span>(i4=0;i4&lt;soillayers;i4++){</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                cwsVec[i4] = soilMLS.cws[i4];</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                cwsVecSum += cwsVec[i4];</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                REAL(cwsMat)[i4 + i*soillayers] = soilMLS.cws[i4];</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                REAL(rdMat)[i4 + i*soillayers] = soilMLS.rootDist[i4];</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                        }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                        waterCont = cwsVecSum / soillayers;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        cwsVecSum = 0.0;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                        soilEvap = <a class="code" href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a>(LAI, 0.68, *(pt_temp+i), *(pt_solar+i), waterCont, FieldC, WiltP, </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                             *(pt_windspeed+i), *(pt_rh+i), rsec);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                        TotEvap = soilEvap + CanopyT;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                        WaterS = <a class="code" href="_aux_bio_cro_8c.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a>(*(pt_precip+i),TotEvap,waterCont,soilDepth,FieldC,WiltP,phi1,phi2,soilType, wsFun);   </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                        waterCont = WaterS.awc;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                        StomWS = WaterS.rcoefPhoto ; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                        LeafWS = WaterS.rcoefSpleaf;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                        REAL(cwsMat)[i] = waterCont;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                        REAL(psimMat)[i] = WaterS.psim;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">/* An alternative way of computing water stress is by doing the leaf</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment"> * water potential. This is done if the wsFun is equal to 4 */</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <span class="keywordflow">if</span>(wsFun == 4){</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                        <span class="comment">/* Calculating the leaf water potential */</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                        <span class="comment">/* From Campbell E = (Psim_s - Psim_l)/R or</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">                         * evaporation is equal to the soil water potential</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">                         * minus the leaf water potential divided by the resistance.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">                         * This can be rearranged to Psim_l = Psim_s - E x R   */</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                        <span class="comment">/* It is assumed that total resistance is 5e6 m^4 s^-1</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">                         * kg^-1 </span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">                         * Transpiration is in Mg ha-2 hr-1</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">                         * Multiply by 1e3 to go from Mg to kg</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">                         * Multiply by 1e-4 to go from ha to m^2 </span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">                         * This needs to go from hours to seconds that&#39;s</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">                         * why the conversion factor is (1/3600).*/</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                        LeafPsim = WaterS.psim - (CanopyT * 1e3 * 1e-4 * 1.0/3600.0) * transpRes;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                        <span class="comment">/* From WIMOVAVC the proposed equation to simulate the effect of water</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">                         * stress on stomatal conductance */</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                        <span class="keywordflow">if</span>(LeafPsim &lt; leafPotTh){</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                                <span class="comment">/* StomWS = 1 - ((LeafPsim - leafPotTh)/1000 *</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">                                 * scsf); In WIMOVAC this equation is used but</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">                                 * the absolute values are taken from the</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">                                 * potentials. Since they both should be</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">                                 * negative and leafPotTh is greater than</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">                                 * LeafPsim this can be rearranged to*/</span> </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                StomWS = 1 - ((leafPotTh - LeafPsim)/1000 * scsf);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                <span class="comment">/* StomWS = 1; */</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                <span class="keywordflow">if</span>(StomWS &lt; 0.1) StomWS = 0.1;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                StomWS = 1;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                        }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                        LeafPsim = 0;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;               <span class="comment">/* Soil Carbon Pools place holder*/</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                REAL(SCpools)[0] = 1;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                REAL(SCpools)[1] = 1;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                REAL(SCpools)[2] = 1;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                REAL(SCpools)[3] = 1;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                REAL(SCpools)[4] = 1;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                REAL(SCpools)[5] = 1;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                REAL(SCpools)[6] = 1;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                REAL(SCpools)[7] = 1;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                REAL(SCpools)[8] = 1;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                REAL(SNpools)[0] = 1;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                REAL(SNpools)[1] = 1;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                REAL(SNpools)[2] = 1;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                REAL(SNpools)[3] = 1;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                REAL(SNpools)[4] = 1;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                REAL(SNpools)[5] = 1;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                REAL(SNpools)[6] = 1;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                REAL(SNpools)[7] = 1;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                REAL(SNpools)[8] = 1;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;               <span class="comment">/* Need to incoporate the partitioning of carbon to plant components  */</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                tmpDBP = <a class="code" href="_aux_maize_gro_8c.html#af47c959514d981fa021fb61880a15663">maize_sel_dbp_coef</a>(REAL(MALLOCP), phenoStage);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                kLeaf = tmpDBP.kLeaf;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                kStem = tmpDBP.kStem;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                kRoot = tmpDBP.kRoot;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                kGrain = tmpDBP.kGrain;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                <span class="comment">/* if(i == 300){ */</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                <span class="comment">/*      Rprintf(&quot;kLeaf %.2f&quot;,kLeaf,&quot;\n&quot;); */</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                <span class="comment">/*      Rprintf(&quot;kStem %.2f&quot;,kStem,&quot;\n&quot;); */</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                <span class="comment">/*      Rprintf(&quot;kRoot %.2f&quot;,kRoot,&quot;\n&quot;); */</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                <span class="comment">/*      Rprintf(&quot;kGrain %.2f&quot;,kGrain,&quot;\n&quot;); */</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                <span class="comment">/* } */</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;               <span class="comment">/* Creating the increase in biomass for each component */</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                <span class="keywordflow">if</span>(kLeaf &gt; 0 || TTc &gt; R6){</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                        newLeaf = CanopyA * kLeaf * LeafWS;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                        newLeaf = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newLeaf, mrc1, *(pt_temp+i));</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                        newLeaf = Leaf * kLeaf;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                        Stem += kStem * -newLeaf   * 0.9;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                        Root += kRoot * -newLeaf * 0.9;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        Grain += kGrain * -newLeaf * 0.9;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                <span class="keywordflow">if</span>(kStem &gt; 0 || TTc &gt; R6){</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                        newStem = CanopyA * kStem;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                        newStem = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newStem, mrc1, *(pt_temp+i));</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                        newStem = Stem * kStem;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                        Leaf += kLeaf * -newStem   * 0.9;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                        Root += kRoot * -newStem * 0.9;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                        Grain += kGrain * -newStem * 0.9;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                newRoot = CanopyA * kRoot;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">/* I need a better implementation of reproductive specific stress */</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                <span class="keywordflow">if</span>(LeafWS &lt; StomWS){</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                        newGrain = CanopyA * kGrain * LeafWS;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                        newGrain = CanopyA * kGrain * StomWS;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                <span class="keywordflow">if</span>(*(pt_doy+i) &lt; emergeDate + 7){</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                        <span class="keywordflow">if</span>(newLeaf &lt; 0) newLeaf = 0.0;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                        <span class="keywordflow">if</span>(newStem &lt; 0) newStem = 0.0;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                        <span class="keywordflow">if</span>(newRoot &lt; 0) newRoot = 0.0;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                        <span class="keywordflow">if</span>(newGrain &lt; 0) newGrain = 0.0;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                Grain += newGrain;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">/* Implementing senescence */</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                *(sti+q) = newLeaf;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                *(sti2+q) = newStem;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                *(sti3+q) = newRoot;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">/* Senescence for leaf */</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; seneLeaf || TTc &gt; R6){</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                        Leaf += newLeaf;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                        Leaf += newLeaf - *(sti+k);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                        k++;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">/* Senescence for stem */</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; seneStem || TTc &gt; R6){</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                        Stem += newStem;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                        Stem += newStem - *(sti2+j);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                        j++;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">/* Senescence for root */</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                <span class="keywordflow">if</span>(TTc &lt; seneRoot || TTc &gt; R6){</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                        Root += newRoot;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                        Root += newRoot - *(sti3+m);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        m++;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                <span class="comment">/* Collecting results */</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                REAL(DayofYear)[i] =  *(pt_doy+i);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                REAL(Hour)[i] =  *(pt_hr+i);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                REAL(CanopyAssim)[i] =  CanopyA;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                REAL(CanopyTrans)[i] =  CanopyT; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                REAL(LAIc)[i] = LAI;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                REAL(LeafVec)[i] = Leaf;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                REAL(StemVec)[i] = Stem;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                REAL(RootVec)[i] = Root;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                REAL(GrainVec)[i] = Grain;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                REAL(VmaxVec)[i] = vmax;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                REAL(LeafNVec)[i] = LeafN;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                REAL(SoilEvaporation)[i] = soilEvap;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                REAL(LeafPsimVec)[i] = LeafPsim;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                REAL(SoilWatCont)[i] = waterCont;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                REAL(StomatalCondCoefs)[i] = StomWS;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        SET_VECTOR_ELT(lists, 0, DayofYear);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        SET_VECTOR_ELT(lists, 1, Hour);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        SET_VECTOR_ELT(lists, 2, TTTc);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        SET_VECTOR_ELT(lists, 3, PhenoStage);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        SET_VECTOR_ELT(lists, 4, CanopyAssim);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        SET_VECTOR_ELT(lists, 5, CanopyTrans);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        SET_VECTOR_ELT(lists, 6, LAIc);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        SET_VECTOR_ELT(lists, 7, LeafVec);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        SET_VECTOR_ELT(lists, 8, StemVec);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        SET_VECTOR_ELT(lists, 9, RootVec);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        SET_VECTOR_ELT(lists, 10, GrainVec);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        SET_VECTOR_ELT(lists, 11, LAImat);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        SET_VECTOR_ELT(lists, 12, VmaxVec);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        SET_VECTOR_ELT(lists, 13, LeafNVec);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        SET_VECTOR_ELT(lists, 14, cwsMat);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        SET_VECTOR_ELT(lists, 15, psimMat);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        SET_VECTOR_ELT(lists, 16, rdMat);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        SET_VECTOR_ELT(lists, 17, SCpools);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        SET_VECTOR_ELT(lists, 18, SNpools);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        SET_VECTOR_ELT(lists, 19, LeafPsimVec);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        SET_VECTOR_ELT(lists, 20, SoilEvaporation);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        SET_VECTOR_ELT(lists, 21, SoilWatCont);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        SET_VECTOR_ELT(lists, 22, StomatalCondCoefs);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        SET_STRING_ELT(names,0,mkChar(<span class="stringliteral">&quot;DayofYear&quot;</span>));</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        SET_STRING_ELT(names,1,mkChar(<span class="stringliteral">&quot;Hour&quot;</span>));</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        SET_STRING_ELT(names,2,mkChar(<span class="stringliteral">&quot;TTTc&quot;</span>));</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        SET_STRING_ELT(names,3,mkChar(<span class="stringliteral">&quot;PhenoStage&quot;</span>));</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        SET_STRING_ELT(names,4,mkChar(<span class="stringliteral">&quot;CanopyAssim&quot;</span>));</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        SET_STRING_ELT(names,5,mkChar(<span class="stringliteral">&quot;CanopyTrans&quot;</span>));</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        SET_STRING_ELT(names,6,mkChar(<span class="stringliteral">&quot;LAI&quot;</span>));</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        SET_STRING_ELT(names,7,mkChar(<span class="stringliteral">&quot;Leaf&quot;</span>));</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        SET_STRING_ELT(names,8,mkChar(<span class="stringliteral">&quot;Stem&quot;</span>));</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        SET_STRING_ELT(names,9,mkChar(<span class="stringliteral">&quot;Root&quot;</span>));</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        SET_STRING_ELT(names,10,mkChar(<span class="stringliteral">&quot;Grain&quot;</span>));</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        SET_STRING_ELT(names,11,mkChar(<span class="stringliteral">&quot;LAImat&quot;</span>));</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        SET_STRING_ELT(names,12,mkChar(<span class="stringliteral">&quot;VmaxVec&quot;</span>));</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        SET_STRING_ELT(names,13,mkChar(<span class="stringliteral">&quot;LeafNVec&quot;</span>));</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        SET_STRING_ELT(names,14,mkChar(<span class="stringliteral">&quot;cwsMat&quot;</span>));</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        SET_STRING_ELT(names,15,mkChar(<span class="stringliteral">&quot;psimMat&quot;</span>));</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        SET_STRING_ELT(names,16,mkChar(<span class="stringliteral">&quot;rdMat&quot;</span>));</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        SET_STRING_ELT(names,17,mkChar(<span class="stringliteral">&quot;SCpools&quot;</span>));</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        SET_STRING_ELT(names,18,mkChar(<span class="stringliteral">&quot;SNpools&quot;</span>));</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        SET_STRING_ELT(names,19,mkChar(<span class="stringliteral">&quot;LeafPsimVec&quot;</span>));</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        SET_STRING_ELT(names,20,mkChar(<span class="stringliteral">&quot;SoilEvaporation&quot;</span>));</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        SET_STRING_ELT(names,21,mkChar(<span class="stringliteral">&quot;SoilWatCont&quot;</span>));</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        SET_STRING_ELT(names,22,mkChar(<span class="stringliteral">&quot;StomatalCondCoefs&quot;</span>));</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        setAttrib(lists,R_NamesSymbol,names);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        UNPROTECT(25);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keywordflow">return</span>(lists);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;}</div>
<div class="ttc" id="_bio_cro_8h_html_a5b6e16664a459420103984ac5409b858"><div class="ttname"><a href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a></div><div class="ttdeci">double CanopyAssim[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:10</div></div>
<div class="ttc" id="structnitro_parms_html"><div class="ttname"><a href="structnitro_parms.html">nitroParms</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:128</div></div>
<div class="ttc" id="structws__str_html"><div class="ttname"><a href="structws__str.html">ws_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:48</div></div>
<div class="ttc" id="structsoil_text__str_html"><div class="ttname"><a href="structsoil_text__str.html">soilText_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:95</div></div>
<div class="ttc" id="_bio_cro_8h_html_ac656f07a64aeba7d6ac5a3a536e993c8"><div class="ttname"><a href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a></div><div class="ttdeci">double LAIc[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:16</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a8dfc137af141b612fc3cde9b49b0fc5f"><div class="ttname"><a href="_aux_bio_cro_8c.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a></div><div class="ttdeci">struct ws_str watstr(double precipit, double evapo, double cws, double soildepth, double fieldc, double wiltp, double phi1, double phi2, int soiltype, int wsFun)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:673</div></div>
<div class="ttc" id="_aux_maize_gro_8c_html_a52d47bd7f4906cfb7034a8f7e22c29e0"><div class="ttname"><a href="_aux_maize_gro_8c.html#a52d47bd7f4906cfb7034a8f7e22c29e0">laiBirchdiscontinuousFun</a></div><div class="ttdeci">struct lai_str laiBirchdiscontinuousFun(double phenostage, double LT, double Amax, double c1, double c2, double c3, double c4)</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.c:97</div></div>
<div class="ttc" id="structsoil_m_l__str_html"><div class="ttname"><a href="structsoil_m_l__str.html">soilML_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:59</div></div>
<div class="ttc" id="structnitro_parms_html_a81548389d7bb414fbf85c27cc1df21ad"><div class="ttname"><a href="structnitro_parms.html#a81548389d7bb414fbf85c27cc1df21ad">nitroParms::ileafN</a></div><div class="ttdeci">double ileafN</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:129</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a72f93049960e067cda6e7291ff1ff21a"><div class="ttname"><a href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a></div><div class="ttdeci">struct soilText_str soilTchoose(int soiltype)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1166</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_ad67c5b654f4bceb23717a84244291ea0"><div class="ttname"><a href="_aux_bio_cro_8c.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a></div><div class="ttdeci">struct Can_Str CanAC(double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Alpha, double Kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double StomataWS, int ws, double kd, double chil, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, struct nitroParms nitroP)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:539</div></div>
<div class="ttc" id="_aux_maize_gro_8c_html_a51216bb4e018f7bc8aa10952ffdc102c"><div class="ttname"><a href="_aux_maize_gro_8c.html#a51216bb4e018f7bc8aa10952ffdc102c">laiBirchcontinuousFun</a></div><div class="ttdeci">struct lai_str laiBirchcontinuousFun(double phenostage, double a, double b, double Amax, double x0, double f, double g, double TT, double LT)</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.c:140</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a5537e2a57efaaf41b401666bb9e22062"><div class="ttname"><a href="_aux_bio_cro_8c.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a></div><div class="ttdeci">struct soilML_str soilML(double precipit, double transp, double *cws, double soildepth, double *depths, double fieldc, double wiltp, double phi1, double phi2, struct soilText_str soTexS, int wsFun, int layers, double rootDB, double LAI, double k, double AirTemp, double IRad, double winds, double RelH, int hydrDist, double rfl, double rsec, double rsdf)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:807</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_ac96acf762dd39d5ff20d71788b0ca566"><div class="ttname"><a href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a></div><div class="ttdeci">double SoilEvapo(double LAI, double k, double AirTemp, double IRad, double awc, double fieldc, double wiltp, double winds, double RelH, double rsec)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:412</div></div>
<div class="ttc" id="_aux_maize_gro_8h_html_abdf261a2f5c0982109f87ae1d42cc8bb"><div class="ttname"><a href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a></div><div class="ttdeci">#define MAXLEAFNUMBER</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:10</div></div>
<div class="ttc" id="struct_can___str_html"><div class="ttname"><a href="struct_can___str.html">Can_Str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:41</div></div>
<div class="ttc" id="structmaize__dbp__str_html"><div class="ttname"><a href="structmaize__dbp__str.html">maize_dbp_str</a></div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:19</div></div>
<div class="ttc" id="_aux_maize_gro_8c_html_a8df740a747a3d6378541a4f69bbff29f"><div class="ttname"><a href="_aux_maize_gro_8c.html#a8df740a747a3d6378541a4f69bbff29f">laiLizasoFun</a></div><div class="ttdeci">struct lai_str laiLizasoFun(double thermalt, double phenostage, double phyllochron1, double phyllochron2, double Ax, double LT, double k0, double a1, double a2, double L0, double LLx, double Lx, double LNl)</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.c:10</div></div>
<div class="ttc" id="_aux_maize_gro_8c_html_af47c959514d981fa021fb61880a15663"><div class="ttname"><a href="_aux_maize_gro_8c.html#af47c959514d981fa021fb61880a15663">maize_sel_dbp_coef</a></div><div class="ttdeci">struct maize_dbp_str maize_sel_dbp_coef(double dbpCoefs[13], double phenoStage)</div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.c:231</div></div>
<div class="ttc" id="structlai__str_html"><div class="ttname"><a href="structlai__str.html">lai_str</a></div><div class="ttdef"><b>Definition:</b> AuxMaizeGro.h:12</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_aeb35169469ef33705592a28743d105bf"><div class="ttname"><a href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a></div><div class="ttdeci">double resp(double comp, double mrc, double temp)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1024</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="maize_gro_8c.html">maizeGro.c</a></li>
    <li class="footer">Generated on Fri Apr 3 2015 15:41:07 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
