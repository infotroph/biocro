<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>BioCro: /home/dlebauer/dev/biocro/src/AuxcaneGro.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_auxcane_gro_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">AuxcaneGro.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;R.h&gt;</code><br/>
<code>#include &lt;Rmath.h&gt;</code><br/>
<code>#include &lt;Rinternals.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="">AuxBioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">AuxcaneGro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">c4photo.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for AuxcaneGro.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="_auxcane_gro_8c__incl.png" border="0" usemap="#_2home_2dlebauer_2dev_2biocro_2src_2_auxcane_gro_8c" alt=""/></div>
<map name="_2home_2dlebauer_2dev_2biocro_2src_2_auxcane_gro_8c" id="_2home_2dlebauer_2dev_2biocro_2src_2_auxcane_gro_8c">
<area shape="rect" id="node5" href="_aux_bio_cro_8h.html" title="AuxBioCro.h" alt="" coords="285,96,381,123"/><area shape="rect" id="node6" href="_auxcane_gro_8h.html" title="AuxcaneGro.h" alt="" coords="406,96,511,123"/><area shape="rect" id="node7" href="c4photo_8h.html" title="c4photo.h" alt="" coords="535,96,613,123"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a342605e37f67a349f272daa3f2be0739"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsoil_m_l__str.html">soilML_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxcane_gro_8c.html#a342605e37f67a349f272daa3f2be0739">soilML_rootfront</a> (double precipit, double transp, double *cws, double soildepth, double *depths, double fieldc, double wiltp, double phi1, double phi2, struct <a class="el" href="structsoil_text__str.html">soilText_str</a> soTexS, int wsFun, int layers, double rootDB, double LAI, double k, double AirTemp, double IRad, double winds, double RelH, int hydrDist, double rfl, double rsec, double rsdf, int optiontocalculaterootdepth, double rootfrontvelocity, double dap)</td></tr>
<tr class="separator:a342605e37f67a349f272daa3f2be0739"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0cee1190847413e2ecb82e96f6b71c6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdbp__sugarcane__str.html">dbp_sugarcane_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxcane_gro_8c.html#ad0cee1190847413e2ecb82e96f6b71c6">SUGARCANE_DBP_CUADRA</a> (double TT, double TT0, double TTseed, double Tmaturity, double Rd, double Alm, double Arm, double Clstem, double Ilstem, double Cestem, double Iestem, double Clsuc, double Ilsuc, double Cesuc, double Iesuc, double Temperature)</td></tr>
<tr class="separator:ad0cee1190847413e2ecb82e96f6b71c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad761e63b259cb267cff0d44f686ef513"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxcane_gro_8c.html#ad761e63b259cb267cff0d44f686ef513">GrowthRespiration</a> (double CanopyA, double fraction)</td></tr>
<tr class="separator:ad761e63b259cb267cff0d44f686ef513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fd25059bc26f2c7be4d785b6978bccd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxcane_gro_8c.html#a5fd25059bc26f2c7be4d785b6978bccd">MRespiration</a> (double W, double Q, double m, double T, double deltime)</td></tr>
<tr class="separator:a5fd25059bc26f2c7be4d785b6978bccd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29197dc7c796929a4c9c6d1e758a630c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxcane_gro_8c.html#a29197dc7c796929a4c9c6d1e758a630c">seasonal</a> (double maxLN, double minLN, double day, double daymaxLN, double dayinyear, double lat)</td></tr>
<tr class="separator:a29197dc7c796929a4c9c6d1e758a630c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad761e63b259cb267cff0d44f686ef513"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double GrowthRespiration </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CanopyA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fraction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;{</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        CanopyA=CanopyA*(1.0-fraction);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">return</span>(CanopyA);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5fd25059bc26f2c7be4d785b6978bccd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double MRespiration </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;{</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordtype">double</span> result,ttemp;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">/* change m from per day basis to per hr basis for deltime=1 hr */</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        m=m*deltime/24;  </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        ttemp=(T-25.0)/10.0;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        result=W*m*pow(Q,ttemp);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">return</span>(result);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a29197dc7c796929a4c9c6d1e758a630c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double seasonal </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>daymaxLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dayinyear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;{</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordtype">double</span> temp,leafN;  <span class="comment">// temporary variable to calculate cyclic variation</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;              </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;         temp = sin (2*3.1415*((day-(daymaxLN))/(dayinyear)+0.25));</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;         leafN=(maxLN+minLN)*0.5+(maxLN-minLN)*temp*0.5;  </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">return</span> (leafN);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                 </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; } </div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a342605e37f67a349f272daa3f2be0739"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsoil_m_l__str.html">soilML_str</a> soilML_rootfront </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precipit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soildepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>depths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fieldc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiltp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsoil_text__str.html">soilText_str</a>&#160;</td>
          <td class="paramname"><em>soTexS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wsFun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rootDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>AirTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>IRad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>winds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hydrDist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>optiontocalculaterootdepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rootfrontvelocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                                                                                                                                                                                                                                                                                                                                                                                                                                                 {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="keyword">struct </span><a class="code" href="structrd__str.html">rd_str</a> <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keyword">struct </span><a class="code" href="structseq_r_d__str.html">seqRD_str</a> <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keyword">struct </span><a class="code" href="structsoil_m_l__str.html">soilML_str</a> tmp;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="comment">/* Constant */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="comment">/* const double G = 6.67428e-11;  m3 / (kg * s-2)  ##  http://en.wikipedia.org/wiki/Gravitational_constant */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> g = 9.8; <span class="comment">/* m / s-2  ##  http://en.wikipedia.org/wiki/Standard_gravity */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="comment">/* Variables */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keywordtype">double</span> waterIn, oldWaterIn = 0.0;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/* Here is a convention aw is available water in volume and awc</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">   is available water content as a fraction of the soil section being investigated.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">   paw is plant available water aw - wiltp */</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordtype">double</span> aw, paw, awc, awc2, Newpawha;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">drainage</a> = 0.0;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordtype">double</span> wsPhoto = 0.0, wsSpleaf = 0.0, phi10;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keywordtype">double</span> wsPhotoCol = 0.0, wsSpleafCol = 0.0;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordtype">double</span> slp = 0.0, intcpt = 0.0, theta = 0.0; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">Nleach</a> = 0.0;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordtype">double</span> layerDepth;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordtype">double</span> diffw;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordtype">double</span> rootATdepth, rootDepth;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordtype">double</span> EvapoTra = 0.0, oldEvapoTra = 0.0, Sevap = 0.0, Ctransp = 0.0;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keywordtype">double</span> psim1 = 0.0, psim2 = 0.0, K_psim = 0.0, J_w = 0.0, dPsim = 0.0;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordtype">double</span> theta_s; <span class="comment">/* This is the saturated soil water content. Larger than FieldC.*/</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordtype">int</span> j = layers - 1; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="comment">/* Specify the soil type */</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> &lt; 0){</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                <a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> = soTexS.<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">if</span>(wiltp &lt; 0){</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                wiltp = soTexS.<a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        theta_s = soTexS.<a class="code" href="structsoil_text__str.html#ac769b10536dd94d3652ad1cbf8d58482">satur</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment">/* rooting depth */</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment">/* Crude empirical relationship between root biomass and rooting depth*/</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                   <span class="keywordflow">if</span> (optiontocalculaterootdepth==1) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                            rootDepth = rootDB * rsdf;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                           }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                              rootDepth = rootfrontvelocity*dap*0.01;<span class="comment">// to convert root depth from cm to meter</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                           }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">if</span>(rootDepth &gt; soildepth) rootDepth = soildepth;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a> = <a class="code" href="_aux_bio_cro_8c.html#a668682ce55f6888ab3ec44a7d7a48d07">seqRootDepth</a>(rootDepth,layers);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a> = <a class="code" href="_aux_bio_cro_8c.html#a76d97071934ef506589d0ca8114d3647">rootDist</a>(layers,rootDepth,&amp;depths[0],rfl);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">/* unit conversion for precip */</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        waterIn = precipit * 1e-3; <span class="comment">/* convert precip in mm to m*/</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">for</span>(j=0,i=layers-1;j&lt;layers;j++,i--){</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">/* for(i=0;i&lt;layers;i++){ */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                <span class="comment">/* It decreases because I increase the water content due to precipitation in the last layer first*/</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <span class="comment">/* This supports unequal depths. */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                <span class="keywordflow">if</span>(i == 0){</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                        layerDepth = depths[1];</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                        layerDepth = depths[i] - depths[i-1];</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <span class="keywordflow">if</span>(hydrDist &gt; 0){</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                        <span class="comment">/* For this section see Campbell and Norman &quot;Environmental BioPhysics&quot; Chapter 9*/</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                        <span class="comment">/* First compute the matric potential */</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                        psim1 = soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a> * pow((<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i]/theta_s),-soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>) ; <span class="comment">/* This is matric potential of current layer */</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                        <span class="keywordflow">if</span>(i &gt; 0){</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                psim2 = soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a> * pow((<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i-1]/theta_s),-soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>) ; <span class="comment">/* This is matric potential of next layer */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                dPsim = psim1 - psim2;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                <span class="comment">/* The substraction is from the layer i - (i-1). If this last term is positive then it will move upwards. If it is negative it will move downwards. Presumably this term is almost always positive. */</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                dPsim = 0;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                        }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                        K_psim = soTexS.<a class="code" href="structsoil_text__str.html#aa9437b51e97937d66bd2c90f9a411652">Ks</a> * pow((soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a>/psim1),2+3/soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>); <span class="comment">/* This is hydraulic conductivity */</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                        J_w = K_psim * (dPsim/layerDepth) - g * K_psim ; <span class="comment">/*  Campbell, pg 129 do not ignore the graviational effect*/</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                        <span class="comment">/* Notice that K_psim is positive because my</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">                            reference system is reversed */</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                        <span class="comment">/* This last result should be in kg/(m2 * s)*/</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                         J_w *= 3600 * 0.9882 * 1e-3 ; <span class="comment">/* This is flow in m3 / (m^2 * hr). */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                        <span class="comment">/* Rprintf(&quot;J_w %.10f \n&quot;,J_w);  */</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                        <span class="keywordflow">if</span>(i == (layers-1) &amp;&amp; J_w &lt; 0){</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                        <span class="comment">/* cws[i] = cws[i] + J_w /</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">                                         * layerDepth; Although this</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">                                         * should be done it drains</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">                                         * the last layer too much.*/</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                        drainage += J_w;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                <span class="keywordflow">if</span>(i &gt; 0){</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] -  J_w / layerDepth;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i - 1] =  <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i-1] +  J_w / layerDepth;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] -  J_w / layerDepth;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                        }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                 <span class="keywordflow">if</span>(<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] &gt; <a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a>) <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = <a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a>; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                <span class="comment">/* if(cws[i+1] &gt; fieldc) cws[i+1] = fieldc; */</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                 <span class="keywordflow">if</span>(<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] &lt; wiltp) <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = wiltp; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <span class="comment">/* if(cws[i+1] &lt; wiltp) cws[i+1] = wiltp;  */</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                aw = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] * layerDepth;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">/* Available water (for this layer) is the current water status times the layer depth */</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <span class="keywordflow">if</span>(waterIn &gt; 0){</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                        <span class="comment">/* There is some rain. Need to add it.*/</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                        aw += waterIn / layers + oldWaterIn; <span class="comment">/* They are both in meters so it works */</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        <span class="comment">/* Adding the same amount to water to each layer */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                        <span class="comment">/* In case there is overflow */</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                        diffw = <a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> * layerDepth - aw;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                        <span class="keywordflow">if</span>(diffw &lt; 0){</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                <span class="comment">/* This means that precipitation exceeded the capacity of the first layer */</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                <span class="comment">/* Save this amount of water for the next layer */</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                oldWaterIn = -diffw;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                aw = <a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> * layerDepth;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                oldWaterIn = 0.0;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                        }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                <span class="comment">/* Root Biomass */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                rootATdepth = rootDB * <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[i];</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                tmp.rootDist[i] = rootATdepth;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">/* Plant available water is only between current water status and permanent wilting point */</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="comment">/* Plant available water */</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                paw = aw - wiltp * layerDepth;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="keywordflow">if</span>(paw &lt; 0) paw = 0; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keywordflow">if</span>(i == 0){</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                        <span class="comment">/* Only the first layer is affected by soil evaporation */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                        awc2 = aw / layerDepth;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                        <span class="comment">/* SoilEvapo function needs soil water content  */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                        Sevap = <a class="code" href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a>(LAI,k,AirTemp,IRad,awc2,<a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a>,wiltp,winds,RelH,rsec);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                        <span class="comment">/* I assume that crop transpiration is distributed simlarly to</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">                           root density.  In other words the crop takes up water proportionally</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">                           to the amount of root in each respective layer.*/</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                        Ctransp = transp*<a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[0];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                        EvapoTra = Ctransp + Sevap;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                        Newpawha = (paw * 1e4) - EvapoTra / 0.9982; <span class="comment">/* See the watstr function for this last number 0.9882 */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                        <span class="comment">/* The first term in the rhs (paw * 1e4) is the m3 of water available in this layer.</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">                           EvapoTra is the Mg H2O ha-1 of transpired and evaporated water. 1/0.9882 converts from Mg to m3 */</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                        Ctransp = transp*<a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[i];</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                        EvapoTra = Ctransp;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                        Newpawha = (paw * 1e4) - (EvapoTra + oldEvapoTra);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="keywordflow">if</span>(Newpawha &lt; 0){</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">/* If the Demand is not satisfied by this layer. This will be stored and added to subsequent layers*/</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                        oldEvapoTra = -Newpawha;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                         aw = wiltp * layerDepth; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                paw = Newpawha / 1e4 ;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                awc = paw / layerDepth + wiltp;   </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">/* This might look like a weird place to populate the structure, but is more convenient*/</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                tmp.cws[i] = awc;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="keywordflow">if</span>(wsFun == 0){</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                        slp = 1/(<a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> - wiltp);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                        intcpt = 1 - <a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> * slp;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                        wsPhoto = slp * awc + intcpt ;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="keywordflow">if</span>(wsFun == 1){</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                        phi10 = (<a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> + wiltp)/2;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        wsPhoto = 1/(1 + exp((phi10 - awc)/ phi1));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                <span class="keywordflow">if</span>(wsFun == 2){</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                        slp = (1 - wiltp)/(<a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> - wiltp);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                        intcpt = 1 - <a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a> * slp;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                        theta = slp * awc + intcpt ;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                        wsPhoto = (1 - exp(-2.5 * (theta - wiltp)/(1 - wiltp))) / (1 - exp(-2.5));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="keywordflow">if</span>(wsFun == 3){</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                        wsPhoto = 1;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                <span class="keywordflow">if</span>(wsPhoto &lt;= 0 )</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                        wsPhoto = 1e-20; <span class="comment">/* This can be mathematically lower than zero in some cases but I should prevent that. */</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                wsPhotoCol += wsPhoto;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                wsSpleaf = pow(awc,phi2)/pow(<a class="code" href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">fieldc</a>,phi2); </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="keywordflow">if</span>(wsFun == 3){ </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                        wsSpleaf = 1;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                wsSpleafCol += wsSpleaf;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">if</span>(waterIn &gt; 0){ </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                drainage = waterIn;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <span class="comment">/* Need to convert to units used in the Parton et al 1988 paper. */</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <span class="comment">/* The data comes in mm/hr and it needs to be in cm/month */</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                Nleach = drainage * 0.1 * (1/24*30) / (18 * (0.2 + 0.7 * soTexS.<a class="code" href="structsoil_text__str.html#a4fcef85764276271df64bd49ff7667fb">sand</a>));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">/* returning the structure */</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        tmp.rcoefPhoto = (wsPhotoCol/layers);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        tmp.drainage = <a class="code" href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">drainage</a>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        tmp.Nleach = <a class="code" href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">Nleach</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        tmp.rcoefSpleaf = (wsSpleafCol/layers);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        tmp.SoilEvapo = Sevap;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">return</span>(tmp);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div>
<div class="ttc" id="structsoil_text__str_html_aa9437b51e97937d66bd2c90f9a411652"><div class="ttname"><a href="structsoil_text__str.html#aa9437b51e97937d66bd2c90f9a411652">soilText_str::Ks</a></div><div class="ttdeci">double Ks</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:102</div></div>
<div class="ttc" id="structsoil_m_l__str_html_a6b156f63a9c5f2185dcb004e85518998"><div class="ttname"><a href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">soilML_str::drainage</a></div><div class="ttdeci">double drainage</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:64</div></div>
<div class="ttc" id="structsoil_m_l__str_html_a9da7a4e25e646b0be31ac3bbec73f60d"><div class="ttname"><a href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">soilML_str::cws</a></div><div class="ttdeci">double cws[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:63</div></div>
<div class="ttc" id="structsoil_text__str_html_a6ee087ca614bcf981839ca4e28953fb2"><div class="ttname"><a href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">soilText_str::wiltp</a></div><div class="ttdeci">double wiltp</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:105</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_acfad88ff5207b2ab57fc1dca17271065"><div class="ttname"><a href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a></div><div class="ttdeci">double tmp4[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:29</div></div>
<div class="ttc" id="structseq_r_d__str_html"><div class="ttname"><a href="structseq_r_d__str.html">seqRD_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:112</div></div>
<div class="ttc" id="structsoil_m_l__str_html_a822b315fe3e59dff737cb334f7f58c15"><div class="ttname"><a href="structsoil_m_l__str.html#a822b315fe3e59dff737cb334f7f58c15">soilML_str::fieldc</a></div><div class="ttdeci">double fieldc[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:74</div></div>
<div class="ttc" id="structsoil_m_l__str_html"><div class="ttname"><a href="structsoil_m_l__str.html">soilML_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:59</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a76d97071934ef506589d0ca8114d3647"><div class="ttname"><a href="_aux_bio_cro_8c.html#a76d97071934ef506589d0ca8114d3647">rootDist</a></div><div class="ttdeci">struct rd_str rootDist(int layer, double rootDepth, double *depthsp, double rfl)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1123</div></div>
<div class="ttc" id="structrd__str_html"><div class="ttname"><a href="structrd__str.html">rd_str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:120</div></div>
<div class="ttc" id="structsoil_text__str_html_aa1f62c6a0dfe9f9d7abfd52a756209bf"><div class="ttname"><a href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">soilText_str::fieldc</a></div><div class="ttdeci">double fieldc</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:104</div></div>
<div class="ttc" id="structsoil_text__str_html_a4fcef85764276271df64bd49ff7667fb"><div class="ttname"><a href="structsoil_text__str.html#a4fcef85764276271df64bd49ff7667fb">soilText_str::sand</a></div><div class="ttdeci">double sand</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:99</div></div>
<div class="ttc" id="structsoil_m_l__str_html_a26953bee326ec08f079e24838fc8feb6"><div class="ttname"><a href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">soilML_str::Nleach</a></div><div class="ttdeci">double Nleach</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:65</div></div>
<div class="ttc" id="structsoil_text__str_html_accd3edb0af25e0499d5ffbfacc2af59c"><div class="ttname"><a href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">soilText_str::air_entry</a></div><div class="ttdeci">double air_entry</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:100</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_ac96acf762dd39d5ff20d71788b0ca566"><div class="ttname"><a href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a></div><div class="ttdeci">double SoilEvapo(double LAI, double k, double AirTemp, double IRad, double awc, double fieldc, double wiltp, double winds, double RelH, double rsec)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:412</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a15219c620f8cdf6d8cf731e485e2c668"><div class="ttname"><a href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a></div><div class="ttdeci">double tmp3[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:28</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a668682ce55f6888ab3ec44a7d7a48d07"><div class="ttname"><a href="_aux_bio_cro_8c.html#a668682ce55f6888ab3ec44a7d7a48d07">seqRootDepth</a></div><div class="ttdeci">struct seqRD_str seqRootDepth(double to, int lengthOut)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:1103</div></div>
<div class="ttc" id="structsoil_text__str_html_ac769b10536dd94d3652ad1cbf8d58482"><div class="ttname"><a href="structsoil_text__str.html#ac769b10536dd94d3652ad1cbf8d58482">soilText_str::satur</a></div><div class="ttdeci">double satur</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:103</div></div>
<div class="ttc" id="structsoil_text__str_html_a1510a66dacf9cf3586de5fc89ae2a073"><div class="ttname"><a href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">soilText_str::b</a></div><div class="ttdeci">double b</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:101</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad0cee1190847413e2ecb82e96f6b71c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdbp__sugarcane__str.html">dbp_sugarcane_str</a> SUGARCANE_DBP_CUADRA </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TT0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TTseed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tmaturity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Alm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Arm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Clstem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ilstem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Cestem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Iestem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Clsuc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ilsuc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Cesuc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Iesuc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temperature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;{</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keyword">struct </span><a class="code" href="structdbp__sugarcane__str.html">dbp_sugarcane_str</a> dbp;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordtype">double</span> F1, F2, F3, F4;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordtype">double</span> Aa,Astem,Al,Ar,Asuc,Astuc,Afib;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordtype">double</span> RM;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordtype">double</span> cutemp1,cutemp2,RM0;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">/* Germination Phase */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">if</span>(TT &lt; TT0)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                dbp.<a class="code" href="structdbp__sugarcane__str.html#ac99cccaa39474eb44da7927824bf1590">kLeaf</a>=0.001;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                dbp.kStem=0.7;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                dbp.kRoot=0.299;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                dbp.kSeedcane=(-1)*0.693*(0.0053*Temperature-0.0893);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                dbp.kSugar=0.0;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                dbp.kFiber=0.0;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <span class="keywordflow">return</span>(dbp);            </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        dbp.kSeedcane=0;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">/* Calculate Relative Maturity and correct it for germination phase* */</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="comment">/* Now reference thermal time has changed from 0 to TT0 */</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        RM=(TT-TT0)*100.0/Tmaturity;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">/*      RM0=TT0*100.0/Tmaturity;</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">        RM=RM-RM0;   */</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">/* Criteria for linear increase in stem biomass*/</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        F1=RM*Clstem-Ilstem*Clstem;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="comment">/*Criteria for log increase in stem biomass */</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        F2=1-exp((RM*Cestem)-(Iestem*Cestem));</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">/* Fraction of aerial biomass */</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        cutemp1=(1-exp((-1)*Rd*RM));</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        Aa=(1.0-Arm)*((cutemp1&lt;1.0) ? cutemp1 :1.0);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">/*Fraction of stem biomass */</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        cutemp1=(1.0-Alm-Arm);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">if</span> ((F1&lt;=0)&amp;&amp;(F2&lt;=0))</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                cutemp2=0.0;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                cutemp2=Aa*((F1&gt;F2)?F1:F2);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        Astem = (cutemp2&lt;cutemp1)?cutemp2:cutemp1;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment">/* Fraction of leaf biomass */</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        Al=Aa-Astem;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="comment">/* Fraction of root biomass */</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        Ar=1-Aa;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="comment">/* Partiitoning of stem between structural and sugar component */</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">/* Criteria for linear increase */</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        F3=RM*Clsuc-Ilsuc*Clsuc;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">/*Criteria for log increase */</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        F4=1-exp((RM*Cesuc)-(Iesuc*Cesuc));</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;       <span class="comment">/*fraction of sucrose with respective to total stem allocation */</span> </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        cutemp2=0;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">if</span> ((F3&lt;=0)&amp;&amp;(F4&lt;=0))</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                cutemp2=0;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                cutemp2=Astem*((F3&gt;F4)?F3:F4);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        Asuc=cutemp2;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        Afib=Astem-Asuc;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">/*fraction of structural component of stem */</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        Astuc=Astem-Asuc;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                dbp.kLeaf=Al;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                dbp.kStem=Astem;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                dbp.kRoot=Ar;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                dbp.kSugar=Asuc;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                dbp.kFiber=Astuc;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">//              dbp.kSeedcane=-0.00005; </span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">return</span>(dbp);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div>
<div class="ttc" id="structdbp__sugarcane__str_html_ac99cccaa39474eb44da7927824bf1590"><div class="ttname"><a href="structdbp__sugarcane__str.html#ac99cccaa39474eb44da7927824bf1590">dbp_sugarcane_str::kLeaf</a></div><div class="ttdeci">double kLeaf</div><div class="ttdef"><b>Definition:</b> AuxcaneGro.h:7</div></div>
<div class="ttc" id="structdbp__sugarcane__str_html"><div class="ttname"><a href="structdbp__sugarcane__str.html">dbp_sugarcane_str</a></div><div class="ttdef"><b>Definition:</b> AuxcaneGro.h:5</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_auxcane_gro_8c.html">AuxcaneGro.c</a></li>
    <li class="footer">Generated on Fri Apr 3 2015 15:41:06 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
