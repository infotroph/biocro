<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>BioCro: /home/dlebauer/dev/biocro/src/CanA.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_can_a_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CanA.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;R.h&gt;</code><br/>
<code>#include &lt;Rinternals.h&gt;</code><br/>
<code>#include &lt;Rmath.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="">c4photo.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">AuxBioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">CanA.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for CanA.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="_can_a_8c__incl.png" border="0" usemap="#_2home_2dlebauer_2dev_2biocro_2src_2_can_a_8c" alt=""/></div>
<map name="_2home_2dlebauer_2dev_2biocro_2src_2_can_a_8c" id="_2home_2dlebauer_2dev_2biocro_2src_2_can_a_8c">
<area shape="rect" id="node6" href="c4photo_8h.html" title="c4photo.h" alt="" coords="373,96,451,123"/><area shape="rect" id="node7" href="_aux_bio_cro_8h.html" title="AuxBioCro.h" alt="" coords="476,96,572,123"/><area shape="rect" id="node8" href="_can_a_8h.html" title="CanA.h" alt="" coords="596,96,663,123"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2f1e86c592cffcb577cfa8ff4ecce824"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_can_a_8c.html#a2f1e86c592cffcb577cfa8ff4ecce824">CanA</a> (SEXP Lai, SEXP Doy, SEXP HR, SEXP SOLAR, SEXP TEMP, SEXP ReH, SEXP windspeed, SEXP LAT, SEXP NLAYERS, SEXP STOMATAWS, SEXP VMAX, SEXP ALPH, SEXP KPARM, SEXP THETA, SEXP BETA, SEXP RD, SEXP B0, SEXP B1, SEXP CATM, SEXP KD, SEXP HEIGHTF, SEXP WS, SEXP LEAFN, SEXP KPLN, SEXP LNB0, SEXP LNB1, SEXP LNFUN, SEXP CHIL, SEXP UPPERTEMP, SEXP LOWERTEMP, SEXP NNITROP)</td></tr>
<tr class="separator:a2f1e86c592cffcb577cfa8ff4ecce824"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a2f1e86c592cffcb577cfa8ff4ecce824"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP CanA </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Lai</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Doy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>HR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOLAR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ReH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>windspeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NLAYERS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>STOMATAWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ALPH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KPARM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>THETA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>BETA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>B0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>B1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CATM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>HEIGHTF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LEAFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KPLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LNB0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LNB1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LNFUN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CHIL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>UPPERTEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LOWERTEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NNITROP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">double</span> upperT=REAL(UPPERTEMP)[0];</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">double</span> lowerT=REAL(LOWERTEMP)[0];</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/* Declaring the struct for the Evaop Transpiration */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="keyword">struct </span><a class="code" href="struct_e_t___str.html">ET_Str</a> tmp5_ET , tmp6_ET; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmpc4, tmpc42; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <span class="comment">//NITROPARMS STRUCTURE IS PASSED and READ</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keyword">struct </span><a class="code" href="structnitro_parms.html">nitroParms</a> nitroparms;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="keywordtype">double</span> TEMPdoubletoint;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        nitroparms.<a class="code" href="structnitro_parms.html#a81548389d7bb414fbf85c27cc1df21ad">ileafN</a>=REAL(NNITROP)[0];</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        nitroparms.kln=REAL(NNITROP)[1];</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        nitroparms.Vmaxb1=REAL(NNITROP)[2];</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        nitroparms.Vmaxb0=REAL(NNITROP)[3];</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        nitroparms.alphab1=REAL(NNITROP)[4];</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        nitroparms.alphab0=REAL(NNITROP)[5];</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        nitroparms.Rdb1=REAL(NNITROP)[6];</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        nitroparms.Rdb0=REAL(NNITROP)[7];</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        nitroparms.kpLN=REAL(NNITROP)[8];</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        nitroparms.lnb0=REAL(NNITROP)[9];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        nitroparms.lnb1=REAL(NNITROP)[10];</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        TEMPdoubletoint=REAL(NNITROP)[11];</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        nitroparms.lnFun=(int)TEMPdoubletoint;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        nitroparms.maxln=REAL(NNITROP)[12];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        nitroparms.minln=REAL(NNITROP)[13];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        nitroparms.daymaxln=REAL(NNITROP)[14];</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 3600 * 1e-6 * 30 * 1e-6 * 10000;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">/* Need a different conversion factor for transpiration */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">/* 3600 - number of seconds in an hour */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">/* 1e-3 - mili mols to mols */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">/* 18 - grams in one mol of H20 */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">/* 1e-6 - grams to mega grams */</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="comment">/* 10000 - meters in one hectare */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">double</span> Idir, Idiff, cosTh;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordtype">double</span> IDir, IDiff, Itot,rh, WindS;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">double</span> TempIdir,TempIdiff,AssIdir,AssIdiff,GAssIdir,GAssIdiff;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordtype">double</span> pLeafsun, pLeafshade;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordtype">double</span> Leafsun, Leafshade;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordtype">double</span> CanopyA,GCanopyA ;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordtype">double</span> CanopyT , CanopyPe = 0.0, CanopyPr = 0.0;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">double</span> CanopyC = 0.0;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">double</span> CanHeight;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">/* Need to label them something different from the arguments of the c4photoC</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">     function because these need to be modified by the water stress effect on</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">     the stomata and assimilation. The Ball-Berry parameters are not implemented</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">     yet (I need to think about this a bit harder). */</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">double</span> vmax1;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">double</span> leafN_lay;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">/* INTEGERS */</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">int</span> DOY = INTEGER(Doy)[0];</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">int</span> hr = INTEGER(HR)[0];</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">int</span> nlayers = INTEGER(NLAYERS)[0];</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">/* REALS */</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">double</span> LAI = REAL(Lai)[0];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">double</span> solarR = REAL(SOLAR)[0];</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">double</span> Temp = REAL(TEMP)[0];</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">double</span> RlH = REAL(ReH)[0];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">double</span> WindSpeed = REAL(windspeed)[0];</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">double</span> lat = REAL(LAT)[0];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">double</span> kd = REAL(KD)[0];</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">double</span> heightf = REAL(HEIGHTF)[0];</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">double</span> chil = REAL(CHIL)[0];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordtype">double</span> Catm = REAL(CATM)[0];</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">/* Photosynthesis parameters */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">double</span> alpha1 = REAL(ALPH)[0];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">double</span> kparm1 = REAL(KPARM)[0];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">double</span> theta = REAL(THETA)[0];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">double</span> beta = REAL(BETA)[0];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">double</span> Rd1 = REAL(RD)[0];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">double</span> b01 = REAL(B0)[0];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">double</span> b11 = REAL(B1)[0];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">double</span> stomataws = REAL(STOMATAWS)[0];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordtype">double</span>  LeafN = REAL(LEAFN)[0];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">double</span>  <a class="code" href="structnitro_parms.html#a89b04bb673ac5d9fd455e0b9317bdb83">kpLN</a> = REAL(KPLN)[0];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structnitro_parms.html#a980c24e01e429167687e2ab6191f4175">lnb0</a> = REAL(LNB0)[0];</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structnitro_parms.html#a4020d72bf2f4de6d518eec319f123e2e">lnb1</a> = REAL(LNB1)[0];</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">int</span> lnfun = INTEGER(LNFUN)[0];</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  SEXP lists;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  SEXP names;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  SEXP growth;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  SEXP Ggrowth;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  SEXP trans;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  SEXP epen;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  SEXP epries;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  SEXP cond;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  SEXP mat1;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  PROTECT(lists = allocVector(VECSXP,7));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  PROTECT(names = allocVector(STRSXP,7));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  PROTECT(growth = allocVector(REALSXP,1));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  PROTECT(trans = allocVector(REALSXP,1));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  PROTECT(epen = allocVector(REALSXP,1));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  PROTECT(epries = allocVector(REALSXP,1));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  PROTECT(cond = allocVector(REALSXP,1));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  PROTECT(Ggrowth = allocVector(REALSXP,1));</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  PROTECT(mat1 = allocMatrix(REALSXP,19,nlayers));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">/* Light Macro Environment. As a side effect it populates tmp1. This</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">   * should eventually be replaced by a structure. */</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;     <a class="code" href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a>(lat,DOY,hr);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    Idir = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[0] * solarR;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    Idiff = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[1] * solarR;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    cosTh = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[2];</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">/* sun multilayer model. As a side effect it populates the layIdir, layItotal, layFsun, layHeight,</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">layIdiff, layShade vectors. */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a>(Idir,Idiff,LAI,nlayers,cosTh,kd,chil,heightf);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">/* results from multilayer model */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    LAIc = LAI / nlayers;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">/* Next I need the RH and wind profile */</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a>(RlH,nlayers);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">/* It populates tmp4. */</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;     <a class="code" href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a>(WindSpeed,LAI,nlayers);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">/* It populates tmp3. */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;     <a class="code" href="_aux_bio_cro_8c.html#aa65c89edaec63830e4dd568a89d12fa2">LNprof</a>(LeafN, LAI, nlayers, kpLN);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">/* It populates tmp5 */</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">/* Next use the EvapoTrans function */</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    CanopyA=0.0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    CanopyT=0.0;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">/* vmax depends on leaf nitrogen and this in turn depends on the layer */</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            leafN_lay = <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a>[--<a class="code" href="_aux_bio_cro_8h.html#a39f70a6dfb72439e2f4e0f03f27c0813">tp5</a>];</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span>(lnfun == 0){</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                        vmax1 = REAL(VMAX)[0];</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                        vmax1=nitroparms.Vmaxb1*leafN_lay+nitroparms.Vmaxb0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                        <span class="keywordflow">if</span>(vmax1&lt;0) vmax1=0.0;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">if</span>(vmax1&gt;REAL(VMAX)[0]) vmax1=REAL(VMAX)[0];</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                        alpha1=nitroparms.alphab1*leafN_lay+nitroparms.alphab0;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                        Rd1=nitroparms.Rdb1*leafN_lay+nitroparms.Rdb0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            IDir = <a class="code" href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a>[--<a class="code" href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a>];</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            Itot = <a class="code" href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a>[--<a class="code" href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a>];</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            rh = <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>[--<a class="code" href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a>];</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            WindS = <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>[--<a class="code" href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a>];</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            pLeafsun = <a class="code" href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a>[--<a class="code" href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a>];</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            CanHeight = <a class="code" href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a>[--<a class="code" href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a>];</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            Leafsun = LAIc * pLeafsun;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            tmp5_ET = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDir,Itot,Temp,rh,WindS,LAIc,CanHeight,stomataws,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                 INTEGER(WS)[0],vmax1,alpha1,kparm1,theta,beta,Rd1,b01,b11,upperT,lowerT);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            TempIdir = Temp + tmp5_ET.Deltat;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            tmpc4 = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(IDir,TempIdir,rh,vmax1,alpha1,kparm1,theta,beta,Rd1,b01,b11,stomataws, Catm,INTEGER(WS)[0],upperT,lowerT);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            AssIdir = tmpc4.Assim;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      GAssIdir=tmpc4.GrossAssim;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            IDiff = <a class="code" href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a>[--<a class="code" href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a>];</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            pLeafshade = <a class="code" href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a>[--<a class="code" href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a>];</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            Leafshade = LAIc * pLeafshade;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            tmp6_ET = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDiff,Itot,Temp,rh,WindS,LAIc,CanHeight,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                 stomataws,INTEGER(WS)[0],vmax1,alpha1,kparm1,theta,beta,Rd1,b01,b11,upperT,lowerT);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            TempIdiff = Temp + tmp6_ET.Deltat;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            tmpc42 = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(IDiff,TempIdiff,rh,vmax1,alpha1,kparm1,theta,beta,Rd1,b01,b11,stomataws, Catm,INTEGER(WS)[0],upperT,lowerT);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            AssIdiff = tmpc42.Assim;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      GAssIdiff = tmpc42.GrossAssim;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">/* Collect direct radiation assim and trans in a matrix */</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            REAL(mat1)[i*19] = IDir;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            REAL(mat1)[1 + i*19] = IDiff;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            REAL(mat1)[2 + i*19] = Leafsun;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            REAL(mat1)[3 + i*19] = Leafshade;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            REAL(mat1)[4 + i*19] = tmp5_ET.TransR;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            REAL(mat1)[5 + i*19] = tmp6_ET.TransR;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            REAL(mat1)[6 + i*19] = AssIdir;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="comment">/*REAL(mat1)[7 + i*19] = AssIdiff;*/</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      REAL(mat1)[7 + i*19] = AssIdiff;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            REAL(mat1)[8 + i*19] = tmp5_ET.Deltat;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            REAL(mat1)[9 + i*19] = tmp6_ET.Deltat;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            REAL(mat1)[10 + i*19] = tmp5_ET.LayerCond; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            REAL(mat1)[11 + i*19] = tmp6_ET.LayerCond; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            REAL(mat1)[12 + i*19] = leafN_lay; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            REAL(mat1)[13 + i*19] = vmax1;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            REAL(mat1)[14 + i*19] = rh; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      REAL(mat1)[15 + i*19] = GAssIdir;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      REAL(mat1)[16 + i*19] = GAssIdiff;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      REAL(mat1)[17 + i*19] = alpha1;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      REAL(mat1)[18 + i*19] = leafN_lay;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">/*      REAL(mat1)[11 + i*12] = rh;  */</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">/*Layer conductance needs to be transformed back to the correct units here*/</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            CanopyA += Leafsun * AssIdir + Leafshade * AssIdiff;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            CanopyT += Leafsun * tmp5_ET.TransR + Leafshade * tmp6_ET.TransR; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            CanopyPe += Leafsun * tmp5_ET.EPenman + Leafshade * tmp6_ET.EPenman;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            CanopyPr += Leafsun * tmp5_ET.EPriestly + Leafshade * tmp6_ET.EPriestly;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            CanopyC += Leafsun * tmp5_ET.LayerCond + Leafshade * tmp6_ET.LayerCond;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      GCanopyA += Leafsun * GAssIdir + Leafshade * GAssIdiff;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; <span class="comment">/*## These are micro mols of CO2 per m2 per sec</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">   ## Need to convert to </span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">   ## 3600 converts seconds to hours</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">   ## 10^-6 converts micro mols to mols</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">   ## 30 converts mols of CO2 to grams</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">   ## (1/10^6) converts grams to Mg</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">   ## 10000 scales up to ha */</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    REAL(growth)[0] = cf * CanopyA ;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    REAL(trans)[0] = cf2 * CanopyT ;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    REAL(epen)[0] = cf2 * CanopyPe ;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    REAL(epries)[0] = cf2 * CanopyPr ;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    REAL(cond)[0] = CanopyC;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    REAL(Ggrowth)[0] = cf * GCanopyA ;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    SET_VECTOR_ELT(lists,0,growth);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    SET_VECTOR_ELT(lists,1,trans);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    SET_VECTOR_ELT(lists,2,cond);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    SET_VECTOR_ELT(lists,3,epen);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    SET_VECTOR_ELT(lists,4,epries);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    SET_VECTOR_ELT(lists,5,Ggrowth);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    SET_VECTOR_ELT(lists,6,mat1);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    SET_STRING_ELT(names,0,mkChar(<span class="stringliteral">&quot;CanopyAssim&quot;</span>));</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    SET_STRING_ELT(names,1,mkChar(<span class="stringliteral">&quot;CanopyTrans&quot;</span>));</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    SET_STRING_ELT(names,2,mkChar(<span class="stringliteral">&quot;CanopyCond&quot;</span>));</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    SET_STRING_ELT(names,3,mkChar(<span class="stringliteral">&quot;TranEpen&quot;</span>));</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    SET_STRING_ELT(names,4,mkChar(<span class="stringliteral">&quot;TranEpries&quot;</span>));</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    SET_STRING_ELT(names,5,mkChar(<span class="stringliteral">&quot;GrossCanopyAssim&quot;</span>));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    SET_STRING_ELT(names,6,mkChar(<span class="stringliteral">&quot;LayMat&quot;</span>));</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    setAttrib(lists,R_NamesSymbol,names);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    UNPROTECT(9);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">return</span>(lists);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   }</div>
<div class="ttc" id="_aux_bio_cro_8c_html_acb415c4c261f9fc0140240ad46007c87"><div class="ttname"><a href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a></div><div class="ttdeci">void sunML(double Idir, double Idiff, double LAI, int nlayers, double cosTheta, double kd, double chil, double heightf)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:74</div></div>
<div class="ttc" id="structnitro_parms_html_a980c24e01e429167687e2ab6191f4175"><div class="ttname"><a href="structnitro_parms.html#a980c24e01e429167687e2ab6191f4175">nitroParms::lnb0</a></div><div class="ttdeci">double lnb0</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:138</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a5a00a948cd8575f53c71ee1f4b799da5"><div class="ttname"><a href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a></div><div class="ttdeci">double layFshade[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:26</div></div>
<div class="ttc" id="structnitro_parms_html"><div class="ttname"><a href="structnitro_parms.html">nitroParms</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:128</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a959c4cc4acdec59096dac039bfdb627b"><div class="ttname"><a href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a></div><div class="ttdeci">int sp3</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="c4photo_8c_html_ae71c7850944d255a9b995a06fdb305aa"><div class="ttname"><a href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a></div><div class="ttdeci">struct c4_str c4photoC(double Qp, double Tl, double RH, double vmax, double alpha, double kparm, double theta, double beta, double Rd, double bb0, double bb1, double StomaWS, double Ca, int ws, double upperT, double lowerT)</div><div class="ttdef"><b>Definition:</b> c4photo.c:195</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a048d95ccd2cc9d2f00c78c97343c9a6a"><div class="ttname"><a href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a></div><div class="ttdeci">int sp5</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_bio_cro_8h_html_ac656f07a64aeba7d6ac5a3a536e993c8"><div class="ttname"><a href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a></div><div class="ttdeci">double LAIc[8760]</div><div class="ttdef"><b>Definition:</b> BioCro.h:16</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a05f213f4cb25cf49735180ff3b883107"><div class="ttname"><a href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a></div><div class="ttdeci">struct ET_Str EvapoTrans(double Rad, double Itot, double Airtemperature, double RH, double WindSpeed, double LeafAreaIndex, double CanopyHeight, double StomataWS, int ws, double vmax2, double alpha2, double kparm, double theta, double beta, double Rd2, double b02, double b12, double upperT, double lowerT, double Catm)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:208</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_acfad88ff5207b2ab57fc1dca17271065"><div class="ttname"><a href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a></div><div class="ttdeci">double tmp4[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:29</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_aab252cacb5d92c011d673d2db55cba0d"><div class="ttname"><a href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a></div><div class="ttdeci">double tmp1[3]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:21</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_ac86af9361847656ad3514e64ad9e9842"><div class="ttname"><a href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a></div><div class="ttdeci">int sp6</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a5ebe5f68c3871953059c08a083acdb9c"><div class="ttname"><a href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a></div><div class="ttdeci">double layHeight[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:27</div></div>
<div class="ttc" id="structnitro_parms_html_a81548389d7bb414fbf85c27cc1df21ad"><div class="ttname"><a href="structnitro_parms.html#a81548389d7bb414fbf85c27cc1df21ad">nitroParms::ileafN</a></div><div class="ttdeci">double ileafN</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:129</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_aaa2add75bf14b805a4da749043e7be33"><div class="ttname"><a href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a></div><div class="ttdeci">double tmp5[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:30</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a972c42de1800efab3685fc8a47e05da5"><div class="ttname"><a href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a></div><div class="ttdeci">int sp2</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a39f70a6dfb72439e2f4e0f03f27c0813"><div class="ttname"><a href="_aux_bio_cro_8h.html#a39f70a6dfb72439e2f4e0f03f27c0813">tp5</a></div><div class="ttdeci">int tp5</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:19</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a0b8103786ef18d899e25c932a2eb5b88"><div class="ttname"><a href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a></div><div class="ttdeci">double layIdiff[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:23</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_aa65c89edaec63830e4dd568a89d12fa2"><div class="ttname"><a href="_aux_bio_cro_8c.html#aa65c89edaec63830e4dd568a89d12fa2">LNprof</a></div><div class="ttdeci">void LNprof(double LeafN, double LAI, int nlayers, double kpLN)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:163</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a25e1abfffbd0ba6bcb9e7d2b6c847c04"><div class="ttname"><a href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a></div><div class="ttdeci">int sp4</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="structnitro_parms_html_a89b04bb673ac5d9fd455e0b9317bdb83"><div class="ttname"><a href="structnitro_parms.html#a89b04bb673ac5d9fd455e0b9317bdb83">nitroParms::kpLN</a></div><div class="ttdeci">double kpLN</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:137</div></div>
<div class="ttc" id="structc4__str_html"><div class="ttname"><a href="structc4__str.html">c4_str</a></div><div class="ttdef"><b>Definition:</b> c4photo.h:10</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_af8b40a97721000892ae5e0ac624af4c6"><div class="ttname"><a href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a></div><div class="ttdeci">int tp3</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:19</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a15219c620f8cdf6d8cf731e485e2c668"><div class="ttname"><a href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a></div><div class="ttdeci">double tmp3[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:28</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a247148ac54cf7d8c851326de6093b71e"><div class="ttname"><a href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a></div><div class="ttdeci">void RHprof(double RH, int nlayers)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:144</div></div>
<div class="ttc" id="structnitro_parms_html_a4020d72bf2f4de6d518eec319f123e2e"><div class="ttname"><a href="structnitro_parms.html#a4020d72bf2f4de6d518eec319f123e2e">nitroParms::lnb1</a></div><div class="ttdeci">double lnb1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:139</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a43b0d68a959084dc4f4dc099c8901107"><div class="ttname"><a href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a></div><div class="ttdeci">void WINDprof(double WindSpeed, double LAI, int nlayers)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:128</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a1e5f45a584d3c5541472f92c5875e4ea"><div class="ttname"><a href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a></div><div class="ttdeci">double layItotal[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:24</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a36e4d9011835445995335074adedad9a"><div class="ttname"><a href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a></div><div class="ttdeci">int tp4</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:19</div></div>
<div class="ttc" id="struct_e_t___str_html"><div class="ttname"><a href="struct_e_t___str.html">ET_Str</a></div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:32</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a029005f88756e3761a72c104fae0d57b"><div class="ttname"><a href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a></div><div class="ttdeci">double layFsun[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:25</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_a287f9452c1f62b4c5c9ec0616503fb8e"><div class="ttname"><a href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a></div><div class="ttdeci">int sp1</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:18</div></div>
<div class="ttc" id="_aux_bio_cro_8c_html_a46827eb56108821fe82228553f535293"><div class="ttname"><a href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a></div><div class="ttdeci">void lightME(double lat, int DOY, int td)</div><div class="ttdef"><b>Definition:</b> AuxBioCro.c:26</div></div>
<div class="ttc" id="_aux_bio_cro_8h_html_ab0638a2083d3e8d4c1ac43a116da1ad8"><div class="ttname"><a href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a></div><div class="ttdeci">double layIdir[MAXLAY]</div><div class="ttdef"><b>Definition:</b> AuxBioCro.h:22</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_can_a_8c.html">CanA.c</a></li>
    <li class="footer">Generated on Fri Apr 3 2015 15:41:06 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
